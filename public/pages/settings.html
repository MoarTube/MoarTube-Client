<!DOCTYPE html>
<html>
	<head>
		<title>MoarTube - Settings</title>
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		<meta charset="utf-8">
		<script src="/javascript/jquery-3.6.4.min.js"></script>
		<link href="/css/Open+Sans300,400,600,700.css" rel="stylesheet">
		<link href="/css/nucleo-icons.css" rel="stylesheet">
		<link href="/css/nucleo-svg.css" rel="stylesheet">
		<link href="/css/free-5.15.4.min.css" rel="stylesheet">
		<link href="/css/free-v4-font-face-5.15.4.min.css" rel="stylesheet">
		<link href="/css/free-v4-shims-5.15.4.min.css" rel="stylesheet">
		<link href="/css/nucleo-svg.css" rel="stylesheet">
		<link id="pagestyle" href="/css/soft-ui-dashboard-1.1.0.min.css" rel="stylesheet">
		<style>
			.node-avatar {
				border-radius: 50%;
				max-width: 128px;
			}
			
			#node-banner {
				max-width: 1024px;
			}
			
			#secure-connection-modal label {
				margin: 0;
			}

			/*********** Baseline, reset styles ***********/
input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
  width: 25rem;
}

/* Removes default focus */
input[type="range"]:focus {
  outline: none;
}

/******** Chrome, Safari, Opera and Edge Chromium styles ********/
/* slider track */
input[type="range"]::-webkit-slider-runnable-track {
  background-color: #ffadec;
  border-radius: 0.5rem;
  height: 0.5rem;
}

/* slider thumb */
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none; /* Override default look */
  appearance: none;
  margin-top: -4px; /* Centers thumb on the track */
  background-color: #cb0c9f;
  border-radius: 0.5rem;
  height: 1rem;
  width: 1rem;
}

input[type="range"]:focus::-webkit-slider-thumb {
  outline: 3px solid #cb0c9f;
  outline-offset: 0.125rem;
}

/*********** Firefox styles ***********/
/* slider track */
input[type="range"]::-moz-range-track {
  background-color: #ffadec;
  border-radius: 0.5rem;
  height: 0.5rem;
}

/* slider thumb */
input[type="range"]::-moz-range-thumb {
  background-color: #cb0c9f;
  border: none; /*Removes extra border that FF applies*/
  border-radius: 0.5rem;
  height: 1rem;
  width: 1rem;
}

input[type="range"]:focus::-moz-range-thumb{
  outline: 3px solid #cb0c9f;
  outline-offset: 0.125rem;
}
		</style>
	</head>
	<body class="g-sidenav-show bg-gray-100">
		<aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3" id="sidenav-main">
			<div class="sidenav-header">
				<i class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
				<a id="node-link" class="navbar-brand m-0" target="_blank">
					<img src="/settings/node/avatar" class="node-avatar navbar-brand-img h-100" alt="main_logo">
					<span class="ms-1 font-weight-bold">MoarTube Client</span>
				</a>
			</div>
			<hr class="horizontal dark mt-0">
			<div class="collapse navbar-collapse w-auto h-auto" id="sidenav-collapse-main">
				<ul class="navbar-nav">
					<li class="nav-item">
						<div class="collapse  show " id="pagesExamples">
							<ul class="nav ms-4 ps-3">
								<li class="nav-item ">
									<a class="nav-link " href="/videos">
										<span class="sidenav-mini-icon"> V </span>
										<span class="sidenav-normal"> Videos </span>
									</a>
								</li>
								<li class="nav-item ">
									<a class="nav-link " href="/comments">
										<span class="sidenav-mini-icon"> C </span>
										<span class="sidenav-normal"> Comments </span>
										<span id="new-comments-count" class="badge badge-primary ms-1"></span>
									</a>
								</li>
								<li class="nav-item ">
									<a class="nav-link collapsed" data-bs-toggle="collapse" aria-expanded="false" href="#reports">
										<span class="sidenav-mini-icon"> R </span>
										<span class="sidenav-normal"> Reports <b class="caret"></b></span>
										<span id="new-reports-count" class="badge badge-primary ms-1"></span>
									</a>
									<div class="collapse" id="reports">
										<ul class="nav nav-sm flex-column">
											<li class="nav-item">
												<a class="nav-link " href="/reports/videos">
													<span class="sidenav-mini-icon text-xs"> V </span>
													<span class="sidenav-normal"> Videos </span>
													<span id="new-video-reports-count" class="badge badge-primary ms-1"></span>
												</a>
											</li>
											<li class="nav-item">
												<a class="nav-link " href="/reports/comments">
													<span class="sidenav-mini-icon text-xs"> C </span>
													<span class="sidenav-normal"> Comments </span>
													<span id="new-comment-reports-count" class="badge badge-primary ms-1"></span>
												</a>
											</li>
										</ul>
									</div>
								</li>
								<li class="nav-item ">
									<a class="nav-link " href="/monetization">
										<span class="sidenav-mini-icon"> M </span>
										<span class="sidenav-normal"> Monetization </span>
										<span id="new-comments-count" class="badge badge-primary ms-1"></span>
									</a>
								</li>
								<li class="nav-item ">
									<a class="nav-link " href="/links">
										<span class="sidenav-mini-icon"> L </span>
										<span class="sidenav-normal"> Links </span>
										<span id="new-comments-count" class="badge badge-primary ms-1"></span>
									</a>
								</li>
								<li class="nav-item ">
									<a class="nav-link active " href="/settings">
										<span class="sidenav-mini-icon"> S </span>
										<span class="sidenav-normal"> Settings </span>
									</a>
								</li>
							</ul>
						</div>
					</li>
					<li class="nav-item">
						<hr class="horizontal dark">
					</li>
					<li class="nav-item">
						<a class="nav-link" href="http://www.moartube.com" target="_blank">
							<div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center  me-2 d-flex align-items-center justify-content-center">
								<svg class="text-dark" width="12px" height="20px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
									<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
									<g transform="translate(-1720.000000, -592.000000)" fill="#FFFFFF" fill-rule="nonzero">
									<g transform="translate(1716.000000, 291.000000)">
									<g transform="translate(4.000000, 301.000000)">
									<path class="color-background" d="M39.3,0.706666667 C38.9660984,0.370464027 38.5048767,0.192278529 38.0316667,0.216666667 C14.6516667,1.43666667 6.015,22.2633333 5.93166667,22.4733333 C5.68236407,23.0926189 5.82664679,23.8009159 6.29833333,24.2733333 L15.7266667,33.7016667 C16.2013871,34.1756798 16.9140329,34.3188658 17.535,34.065 C17.7433333,33.98 38.4583333,25.2466667 39.7816667,1.97666667 C39.8087196,1.50414529 39.6335979,1.04240574 39.3,0.706666667 Z M25.69,19.0233333 C24.7367525,19.9768687 23.3029475,20.2622391 22.0572426,19.7463614 C20.8115377,19.2304837 19.9992882,18.0149658 19.9992882,16.6666667 C19.9992882,15.3183676 20.8115377,14.1028496 22.0572426,13.5869719 C23.3029475,13.0710943 24.7367525,13.3564646 25.69,14.31 C26.9912731,15.6116662 26.9912731,17.7216672 25.69,19.0233333 L25.69,19.0233333 Z"></path>
									<path class="color-background" d="M1.855,31.4066667 C3.05106558,30.2024182 4.79973884,29.7296005 6.43969145,30.1670277 C8.07964407,30.6044549 9.36054508,31.8853559 9.7979723,33.5253085 C10.2353995,35.1652612 9.76258177,36.9139344 8.55833333,38.11 C6.70666667,39.9616667 0,40 0,40 C0,40 0,33.2566667 1.855,31.4066667 Z"></path>
									<path class="color-background" d="M17.2616667,3.90166667 C12.4943643,3.07192755 7.62174065,4.61673894 4.20333333,8.04166667 C3.31200265,8.94126033 2.53706177,9.94913142 1.89666667,11.0416667 C1.5109569,11.6966059 1.61721591,12.5295394 2.155,13.0666667 L5.47,16.3833333 C8.55036617,11.4946947 12.5559074,7.25476565 17.2616667,3.90166667 L17.2616667,3.90166667 Z" opacity="0.598539807"></path>
									<path class="color-background" d="M36.0983333,22.7383333 C36.9280725,27.5056357 35.3832611,32.3782594 31.9583333,35.7966667 C31.0587397,36.6879974 30.0508686,37.4629382 28.9583333,38.1033333 C28.3033941,38.4890431 27.4704606,38.3827841 26.9333333,37.845 L23.6166667,34.53 C28.5053053,31.4496338 32.7452344,27.4440926 36.0983333,22.7383333 L36.0983333,22.7383333 Z" opacity="0.598539807"></path>
									</g>
									</g>
									</g>
									</g>
								</svg>
							</div>
							<span class="nav-link-text ms-1">MoarTube</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="https://discord.gg/rrKF7a86rY" target="_blank">
							<div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center  me-2 d-flex align-items-center justify-content-center">
								<svg class="text-dark" width="16px" height="16px" viewBox="0 0 46 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
									<g id="Basic-Elements" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="Rounded-Icons" transform="translate(-1717.000000, -291.000000)" fill="#FFFFFF" fill-rule="nonzero">
									<g id="Icons-with-opacity" transform="translate(1716.000000, 291.000000)"> <g id="customer-support" transform="translate(1.000000, 0.000000)">
									<path class="color-background" d="M45,0 L26,0 C25.447,0 25,0.447 25,1 L25,20 C25,20.379 25.214,20.725 25.553,20.895 C25.694,20.965 25.848,21 26,21 C26.212,21 26.424,20.933 26.6,20.8 L34.333,15 L45,15 C45.553,15 46,14.553 46,14 L46,1 C46,0.447 45.553,0 45,0 Z" id="Path" opacity="0.59858631"></path>
									<path class="color-foreground" d="M22.883,32.86 C20.761,32.012 17.324,31 13,31 C8.676,31 5.239,32.012 3.116,32.86 C1.224,33.619 0,35.438 0,37.494 L0,41 C0,41.553 0.447,42 1,42 L25,42 C25.553,42 26,41.553 26,41 L26,37.494 C26,35.438 24.776,33.619 22.883,32.86 Z" id="Path"></path> 
									<path class="color-foreground" d="M13,28 C17.432,28 21,22.529 21,18 C21,13.589 17.411,10 13,10 C8.589,10 5,13.589 5,18 C5,22.529 8.568,28 13,28 Z" id="Path"></path>
									</g>
									</g>
									</g>
									</g>
								</svg>
							</div>
							<span class="nav-link-text ms-1">Discord</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="https://github.com/MoarTube" target="_blank">
							<div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center  me-2 d-flex align-items-center justify-content-center">
								<svg class="text-dark" width="16px" height="16px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
									<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
									<g transform="translate(-2020.000000, -442.000000)" fill="#FFFFFF" fill-rule="nonzero">
									<g transform="translate(1716.000000, 291.000000)">
									<g transform="translate(304.000000, 151.000000)">
									<polygon class="color-background" opacity="0.596981957" points="18.0883333 15.7316667 11.1783333 8.82166667 13.3333333 6.66666667 6.66666667 0 0 6.66666667 6.66666667 13.3333333 8.82166667 11.1783333 15.315 17.6716667"></polygon>
									<path class="color-background" d="M31.5666667,23.2333333 C31.0516667,23.2933333 30.53,23.3333333 30,23.3333333 C29.4916667,23.3333333 28.9866667,23.3033333 28.48,23.245 L22.4116667,30.7433333 L29.9416667,38.2733333 C32.2433333,40.575 35.9733333,40.575 38.275,38.2733333 L38.275,38.2733333 C40.5766667,35.9716667 40.5766667,32.2416667 38.275,29.94 L31.5666667,23.2333333 Z" id="Path" opacity="0.596981957"></path>
									<path class="color-background" d="M33.785,11.285 L28.715,6.215 L34.0616667,0.868333333 C32.82,0.315 31.4483333,0 30,0 C24.4766667,0 20,4.47666667 20,10 C20,10.99 20.1483333,11.9433333 20.4166667,12.8466667 L2.435,27.3966667 C0.95,28.7083333 0.0633333333,30.595 0.00333333333,32.5733333 C-0.0583333333,34.5533333 0.71,36.4916667 2.11,37.89 C3.47,39.2516667 5.27833333,40 7.20166667,40 C9.26666667,40 11.2366667,39.1133333 12.6033333,37.565 L27.1533333,19.5833333 C28.0566667,19.8516667 29.01,20 30,20 C35.5233333,20 40,15.5233333 40,10 C40,8.55166667 39.685,7.18 39.1316667,5.93666667 L33.785,11.285 Z" id="Path"></path>
									</g>
									</g>
									</g>
									</g>
								</svg>
							</div>
							<span class="nav-link-text ms-1">GitHub</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="http://www.moartube.com/terms-of-service" target="_blank">
							<div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center  me-2 d-flex align-items-center justify-content-center">
								<svg class="text-dark" width="16px" height="16px" viewBox="0 0 40 44" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
									<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> 
									<g transform="translate(-1870.000000, -591.000000)" fill="#FFFFFF" fill-rule="nonzero"> 
									<g transform="translate(1716.000000, 291.000000)"> 
									<g transform="translate(154.000000, 300.000000)"> 
									<path class="color-background" d="M40,40 L36.3636364,40 L36.3636364,3.63636364 L5.45454545,3.63636364 L5.45454545,0 L38.1818182,0 C39.1854545,0 40,0.814545455 40,1.81818182 L40,40 Z" id="Path" opacity="0.603585379"></path> 
									<path class="color-background" d="M30.9090909,7.27272727 L1.81818182,7.27272727 C0.814545455,7.27272727 0,8.08727273 0,9.09090909 L0,41.8181818 C0,42.8218182 0.814545455,43.6363636 1.81818182,43.6363636 L30.9090909,43.6363636 C31.9127273,43.6363636 32.7272727,42.8218182 32.7272727,41.8181818 L32.7272727,9.09090909 C32.7272727,8.08727273 31.9127273,7.27272727 30.9090909,7.27272727 Z M18.1818182,34.5454545 L7.27272727,34.5454545 L7.27272727,30.9090909 L18.1818182,30.9090909 L18.1818182,34.5454545 Z M25.4545455,27.2727273 L7.27272727,27.2727273 L7.27272727,23.6363636 L25.4545455,23.6363636 L25.4545455,27.2727273 Z M25.4545455,20 L7.27272727,20 L7.27272727,16.3636364 L25.4545455,16.3636364 L25.4545455,20 Z" id="Shape"></path> 
									</g> 
									</g> 
									</g> 
									</g> 
								</svg>
							</div>
							<span class="nav-link-text ms-1">Terms of Service</span>
						</a>
					</li>
				</ul>
			</div>
		</aside>
		<main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg">
			<nav class="navbar navbar-main navbar-expand-lg position-sticky mt-4 top-1 px-0 mx-4 shadow-none border-radius-xl z-index-sticky" id="navbarBlur" data-scroll="true">
				<div class="container-fluid py-1 px-3">
					<nav aria-label="breadcrumb">
						<h6 class="font-weight-bolder mb-0">Settings</h6>
					</nav>
					<div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
						<div class="ms-md-auto pe-md-3 d-flex align-items-center">
						</div>
						<ul class="navbar-nav  justify-content-end">
							<li class="nav-item d-flex align-items-center">
								<a href="/account/signout" class="nav-link text-body font-weight-bold px-0">
									<i class="fa fa-user me-sm-1" aria-hidden="true"></i>
									<span class="d-sm-inline d-none">Sign Out</span>
								</a>
							</li>
							<li class="nav-item d-xl-none ps-3 d-flex align-items-center">
								<a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
									<div class="sidenav-toggler-inner">
										<i class="sidenav-toggler-line"></i>
										<i class="sidenav-toggler-line"></i>
										<i class="sidenav-toggler-line"></i>
									</div>
								</a>
							</li>
							<li class="nav-item px-3 d-flex align-items-center hidden-elem">
								<a href="javascript:;" class="nav-link text-body p-0">
									<i class="fa fa-cog fixed-plugin-button-nav cursor-pointer" aria-hidden="true"></i>
								</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
			<div class="container-fluid py-4">
				<div class="row my-4">
					<div class="col-12">
						<div id="client-settings-container" class="card mt-4">
							<div class="card-header">
								<h5>Client Settings (<i>version <span id="client-version"></span></i> )</h5>
							</div>
							<div class="card-body pt-0">
								<div class="card-body pt-0 d-flex">
									<div class="my-auto ">
										<div class="h-100">
											<a href="https://www.moartube.com/guides/how-to-enable-gpu-acceleration" target="_blank"><p class="mb-0 d-flex">GPU Acceleration<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
												<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
												<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
											  </svg></p></a>
										</div>
									</div>
									<p id="client-setting-gpu-acceleration-label" class="text-sm text-secondary ms-auto me-3 my-auto"></p>
									<div class="form-check form-switch my-auto">
										<input id="client-setting-gpu-acceleration-checkbox" class="form-check-input" type="checkbox" onclick="toggleClientSettingGpuAccelerationCheckbox(this)">
									</div>
								</div>
								<div class="card-body pt-0 d-flex">
									<div class="my-auto ">
										<div class="h-100">
											<a href="https://www.moartube.com/guides/how-to-configure-video-encoding" target="_blank"><p class="mb-0 d-flex">Video Encoding<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
												<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"></path>
												<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"></path>
											  </svg></p></a>
										</div>
									</div>
									<div class="ms-auto">
										<button class="btn btn-primary" type="button" onclick="showEncodingSettings('Video');">Settings</button>
									</div>
								</div>
								<div class="card-body pt-0 d-flex">
									<div class="my-auto ">
										<div class="h-100">
											<a href="https://www.moartube.com/guides/how-to-configure-live-encoding" target="_blank"><p class="mb-0 d-flex">Live Encoding<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
												<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"></path>
												<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"></path>
											  </svg></p></a>
										</div>
									</div>
									<div class="ms-auto">
										<button class="btn btn-primary" type="button" onclick="showEncodingSettings('Live');">Settings</button>
									</div>
								</div>
							</div>
						</div>
						<div id="node-settings-container" class="card mt-4">
							<div class="card-header">
								<h5>Node Settings (<i>version <span id="node-version"></span></i> )</h5>
							</div>
							<div class="card-body pt-0">
								<div class="card-body pt-0 pb-0">
									<div class="">
										<a href="https://www.moartube.com/guides/how-to-personalize-your-node" target="_blank"><p class="mb-0 d-flex">Personalize<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
											<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
											<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
										  </svg></p></a>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-2">
												<label class="form-label">Node Avatar (128x128)</label>
												<div class="input-group">
													<img src="/settings/node/avatar" class="node-avatar cursor-pointer w-100" onclick="document.getElementById('avatar_file_input').click();">
												</div>
											</div>
											<div class="col-6">
												<label class="form-label">Node Banner (2560x424)</label>
												<div class="input-group">
													<img id="node-banner" src="/settings/node/banner" class="cursor-pointer w-100" onclick="document.getElementById('banner_file_input').click();">
												</div>
											</div>
										</div>
									</div>
								</div>

								<form id="personalize_settings_node_name_form" role="form" method="POST" action="/settings/node/personalize/nodeName">
									<div class="card-body pt-0 pb-0">
										<div class="card-body pt-0">
											<div class="row mt-3">
												<div class="col-12">
													<label class="form-label">Node Name</label>
													<div class="input-group">
														<input id="node-name-input" class="form-control" name="nodeNameJustCuz" type="text" placeholder="node name" onfocus="focused(this)" onfocusout="defocused(this)">
													</div>
												</div>
											</div>
										</div>
										<div class="card-body d-sm-flex pt-0">
											<div class="d-flex align-items-center mb-sm-0 mb-4 ms-auto">
												<button class="btn btn-primary mb-0" type="submit" name="button">Save</button>
											</div>
										</div>
									</div>
								</form>

								<form id="personalize_settings_node_about_form" role="form" method="POST" action="/settings/node/personalize/nodeAbout">
									<div class="card-body pt-0 pb-0">
										<div class="card-body pt-0">
											<div class="row mt-3">
												<div class="col-12">
													<label class="form-label">Node About</label>
													<div class="input-group">
														<textarea id="node-about-textarea" class="form-control" name="nodeAbout" type="text" placeholder="about this node" rows="5" maxlength="100" onfocus="focused(this)" onfocusout="defocused(this)"></textarea>
													</div>
												</div>
											</div>
										</div>
										<div class="card-body d-sm-flex pt-0">
											<div class="d-flex align-items-center mb-sm-0 mb-4 ms-auto">
												<button class="btn btn-primary mb-0" type="submit" name="button">Save</button>
											</div>
										</div>
									</div>
								</form>

								<form id="personalize_settings_node_id_form" role="form" method="POST" action="/settings/node/personalize/nodeId">
									<div class="card-body pt-0 pb-0">
										<div class="card-body pt-0">
											<div class="row mt-3">
												<div class="col-12">
													<label class="form-label">Node ID</label>
													<div class="input-group">
														<input id="node-id-input" class="form-control" name="nodeId" type="text" placeholder="node id" onfocus="focused(this)" onfocusout="defocused(this)">
													</div>
												</div>
											</div>
										</div>
										<div class="card-body d-sm-flex pt-0">
											<div class="d-flex align-items-center mb-sm-0 mb-4 ms-auto">
												<button class="btn btn-primary mb-0" type="submit" name="button">Save</button>
											</div>
										</div>
									</div>
								</form>

								<div class="card-body pt-0 pb-0">
									<div class="">
										<a href="https://www.moartube.com/guides/how-to-secure-your-node-with-https" target="_blank"><p class="mb-0 d-flex">Secure Mode (HTTPS)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
											<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
											<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
										  </svg></p></a>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="node-setting-secure-mode-checkbox" class="form-check-input" type="checkbox" onclick="toggleNodeSettingSecureModeCheckbox(this)"/>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="card-body pt-0 pb-0">
									<div class="">
										<a href="https://www.moartube.com/guides/how-to-enable-cloudflare-integration" target="_blank"><p class="mb-0 d-flex">Cloudflare One-Click Integration<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
											<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
											<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
										  </svg></p></a>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="cloudflare-one-click-integration-checkbox" class="form-check-input" type="checkbox" onclick="toggleCloudflareIntegrationCheckbox(this)">
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="card-body pt-0 pb-0">
									<div class="">
										<a href="https://www.moartube.com/guides/how-to-enable-cloudflare-turnstile" target="_blank"><p class="mb-0 d-flex">Cloudflare Turnstile (human verification)<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
											<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
											<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
										  </svg></p></a>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="cloudflare-turnstile-checkbox" class="form-check-input" type="checkbox" onclick="toggleCloudflareTurnstileCheckbox(this)">
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="card-body pt-0 pb-0">
									<div class="">
										<a href="https://www.moartube.com/guides/how-to-database-storage-mode" target="_blank"><p class="mb-0 d-flex">Database Storage Mode<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
											<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
											<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
										  </svg></p></a>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="radio-group">
													<label class="form-check-label me-3" for="database-storage-mode-sqlite-radio">
													  <input id="database-storage-mode-sqlite-radio" class="form-check-input database-storage-mode-radio" type="radio" name="database-storage-mode" data-databasedialect="sqlite" onclick="toggleDatabaseConfig(this, event)">
													  SQLite (local)
													</label>
													<label class="form-check-label" for="database-storage-mode-postgres-radio">
													  <input id="database-storage-mode-postgres-radio" class="form-check-input database-storage-mode-radio" type="radio" name="database-storage-mode" data-databasedialect="postgres" onclick="toggleDatabaseConfig(this, event)">
													  PostgreSQL (remote)
													</label>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="card-body pt-0 pb-0">
									<div class="">
										<p class="mb-0 d-flex">Comments</p>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="comments-checkbox" class="form-check-input" type="checkbox" onclick="toggleCommentsCheckbox(this)">
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="card-body pt-0 pb-0">
									<div class="">
										<p class="mb-0 d-flex">Likes</p>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="likes-checkbox" class="form-check-input" type="checkbox" onclick="toggleLikesCheckbox(this)">
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="card-body pt-0 pb-0">
									<div class="">
										<p class="mb-0 d-flex">Dislikes</p>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="dislikes-checkbox" class="form-check-input" type="checkbox" onclick="toggleDislikesCheckbox(this)">
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="card-body pt-0 pb-0">
									<div class="">
										<p class="mb-0 d-flex">Reports</p>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="reports-checkbox" class="form-check-input" type="checkbox" onclick="toggleReportsCheckbox(this)">
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="card-body pt-0 pb-0">
									<div class="">
										<p class="mb-0 d-flex">Live Chat</p>
									</div>
									<div class="card-body pt-0">
										<div class="row">
											<div class="col-6">
												<div class="form-check form-switch my-auto">
													<input id="live-chat-checkbox" class="form-check-input" type="checkbox" onclick="toggleLiveChatCheckbox(this)">
												</div>
											</div>
										</div>
									</div>
								</div>
								<form id="internal_network_settings_form" role="form" method="POST" action="/settings/node/network/internal">
									<div class="card-body pt-0 pb-0">
										<div class="">
											<a href="https://www.moartube.com/guides/how-to-change-your-nodes-listening-port" target="_blank"><p class="mb-0 d-flex">What port is your node listening on?<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
												<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
												<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
											  </svg></p></a>
										</div>
										<div class="card-body pt-0">
											<div class="row">
												<div class="col-12">
													<label class="form-label">node listening port</label>
													<div class="input-group">
														<input id="node-listening-port-input" name="nodeListeningPort" class="form-control" type="text" placeholder="0 - 65535" onfocus="focused(this)" onfocusout="defocused(this)">
													</div>
												</div>
											</div>
										</div>
										<div class="card-body d-sm-flex pt-0"><div class="d-flex align-items-center mb-sm-0 mb-4 ms-auto"><button class="btn btn-primary mb-0" type="submit" name="button">Save</button></div></div>
									</div>
								</form>
								<form id="external_network_settings_form" role="form" method="POST" action="/settings/node/network/external">
									<div class="card-body pt-0 pb-0">
										<div class="">
											<a href="https://www.moartube.com/guides/how-can-moartube-find-your-node" target="_blank"><p class="mb-0 d-flex">How Can MoarTube And Cloudflare Find Your Node?<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
												<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
												<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
											  </svg></p></a>
										</div>
										<div class="card-body pt-0">
											<div class="row">
												<div class="col-4">
													<label class="form-label">public node protocol</label>
													<div class="input-group">
														<select id="public-node-protocol-select" name="publicNodeProtocol" class="multisteps-form__select form-control">
															<option value="" disabled selected>...</option>
															<option value="http">HTTP</option>
															<option value="https">HTTPS</option>
														</select>
													</div>
												</div>
												<div class="col-4">
													<label class="form-label">public ip address / domain</label>
													<div class="input-group">
														<input id="public-node-address-input" name="publicNodeAddress" class="form-control" type="text" placeholder="example.com / xxx.xxx.xxx.xxx" onfocus="focused(this)" onfocusout="defocused(this)">
													</div>
												</div>
												<div class="col-4">
													<label class="form-label">public node port</label>
													<div class="input-group">
														<input id="public-node-port-input" name="publicNodePort" class="form-control" type="text" placeholder="0 - 65535" onfocus="focused(this)" onfocusout="defocused(this)">
													</div>
												</div>
											</div>
										</div>
										<div class="card-body d-sm-flex pt-0"><div class="d-flex align-items-center mb-sm-0 mb-4 ms-auto"><button class="btn btn-primary mb-0" type="submit" name="button">Save</button></div></div>
									</div>
								</form>
								<form id="account_credentials_settings_form" role="form" method="POST" action="/settings/node/account">
									<div class="card-body pt-0 pb-0">
										<div class="">
											<a href="https://www.moartube.com/guides/how-to-change-node-account-credentials" target="_blank"><p class="mb-0 d-flex">Account Credentials<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-right ps-1" viewBox="0 0 16 16">
												<path fill-rule="evenodd" d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5"/>
												<path fill-rule="evenodd" d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0z"/>
											  </svg></p></a>
										</div>
										<div class="card-body pt-0">
											<div class="row">
												<div class="col-6">
													<label class="form-label">Username</label>
													<div class="input-group">
														<input name="username" class="form-control" type="text" placeholder="username" onfocus="focused(this)" onfocusout="defocused(this)" autocomplete="off">
													</div>
												</div>
												<div class="col-6">
													<label class="form-label">Password</label>
													<div class="input-group">
														<input name="password" class="form-control" type="text" placeholder="password" onfocus="focused(this)" onfocusout="defocused(this)" autocomplete="off">
													</div>
												</div>
											</div>
										</div>
										<div class="card-body d-sm-flex pt-0"><div class="d-flex align-items-center mb-sm-0 mb-4 ms-auto"><button class="btn btn-primary mb-0" type="submit" name="button">Save</button></div></div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>

		<input id="avatar_file_input" class="hidden-elem" type="file" accept=".jpg,.png"/>
		<input id="banner_file_input" class="hidden-elem" type="file" accept=".jpg,.png"/>

		<script src="/javascript/popper-2.11.6.min.js"></script>
		<script src="/javascript/bootstrap-5.2.2.min.js"></script>
		<script src="/javascript/perfect-scrollbar-1.5.1.min.js"></script>
		<script src="/javascript/sweetalert-11.0.11.min.js"></script>
		<script src="/javascript/soft-ui-dashboard-1.1.0.min.js"></script>

		<script>
			let CLIENT_SETTINGS;
			
			$(document).ready(async function() {
				await getNodeInformation();
				await getNewContentCounts();
				await getClientSettings();
				await getNodeSettings();
			});
			
			function getNodeInformation() {
				return new Promise(function(resolve, reject) {
					$.ajax({type: 'GET', url: '/settings/node'})
					.done(function (data, textStatus, xhr) {
						if(data.isError) {
							reject();
						}
						else {
							const nodeSettings = data.nodeSettings;
						
							const nodeProtocol = nodeSettings.publicNodeProtocol;
							const nodeAddress = nodeSettings.publicNodeAddress;
							const nodePort = nodeSettings.publicNodePort;
							
							const nodeBaseUrl = nodeProtocol + '://' + nodeAddress + ':' + nodePort;
							
							$('#node-link').attr('href', nodeBaseUrl);
							
							resolve();
						}
					})
					.fail(function()
					{
						console.log('unable to communicate with node');
						
						reject();
					});
				});
			}
			
			function getNewContentCounts() {
				return new Promise(function(resolve, reject) {
					$.ajax({type: 'GET', url: '/node/newContentCounts'})
					.done(function (data, textStatus, xhr)
					{
						if(data.isError) {
							reject();
						}
						else {
							const newContentCounts = data.newContentCounts;

							const newCommentsCount = newContentCounts.newCommentsCount;
							const newVideoReportsCount = newContentCounts.newVideoReportsCount;
							const newCommentReportsCount = newContentCounts.newCommentReportsCount;

							const newReportsCount = newVideoReportsCount + newCommentReportsCount;

							if(newCommentsCount > 0) {
								$('#new-comments-count').text(newCommentsCount);
							}

							if(newReportsCount > 0) {
								$('#new-reports-count').text(newReportsCount);
							}
							
							if(newVideoReportsCount > 0) {
								$('#new-video-reports-count').text(newVideoReportsCount);
							}
							
							if(newCommentReportsCount > 0) {
								$('#new-comment-reports-count').text(newCommentReportsCount);
							}
							
							resolve();
						}
					})
					.fail(function()
					{
						console.log('unable to communicate with node');
						
						reject();
					});
				});
			}
			
			function getClientSettings() {
				$.ajax({type: 'GET', url: '/settings/client'})
				.always(function() {
					$('#client-setting-gpu-acceleration-checkbox').prop('disabled', false);
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						showAlert(true, data.message);
					}
					else {
						CLIENT_SETTINGS = data.clientSettings;
						
						$('#client-version').text(CLIENT_SETTINGS.version);
						
						if(CLIENT_SETTINGS.isGpuAccelerationEnabled) {
							const gpuVendorAndModel = CLIENT_SETTINGS.gpuVendor + ' ' + CLIENT_SETTINGS.gpuModel;
						
							$('#client-setting-gpu-acceleration-checkbox').prop('checked', true);
							$('#client-setting-gpu-acceleration-label').text(gpuVendorAndModel);
						}
						else {
							$('#client-setting-gpu-acceleration-label').text('disabled');
						}
					}
				})
				.fail(function() {
					showAlert(true, 'failed to retrieve client settings');
				});
			}
			
			function getNodeSettings() {
				$.ajax({type: 'GET', url: '/settings/node'})
				.always(function() {
					
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						showAlert(true, data.message);
					}
					else {
						const nodeSettings = data.nodeSettings;

						$('#node-version').text(nodeSettings.version);
						
						$('#node-name-input').val(nodeSettings.nodeName);
						$('#node-about-textarea').val(nodeSettings.nodeAbout);
						$('#node-id-input').val(nodeSettings.nodeId);

						$('#node-setting-secure-mode-checkbox').prop('checked', nodeSettings.isSecure);
						$('#cloudflare-one-click-integration-checkbox').prop('checked', nodeSettings.isCloudflareIntegrationEnabled);
						$('#cloudflare-turnstile-checkbox').prop('checked', nodeSettings.isCloudflareTurnstileEnabled);

						if(nodeSettings.databaseConfig.databaseDialect === 'sqlite') {
							$('#database-storage-mode-sqlite-radio').prop('checked', true);
						}
						else if(nodeSettings.databaseConfig.databaseDialect === 'postgres') {
							$('#database-storage-mode-postgres-radio').prop('checked', true);
						}

						$('#comments-checkbox').prop('checked', nodeSettings.isCommentsEnabled);
						$('#likes-checkbox').prop('checked', nodeSettings.isLikesEnabled);
						$('#dislikes-checkbox').prop('checked', nodeSettings.isDislikesEnabled);
						$('#reports-checkbox').prop('checked', nodeSettings.isReportsEnabled);
						$('#live-chat-checkbox').prop('checked', nodeSettings.isLiveChatEnabled);
						
						$('#node-listening-port-input').val(nodeSettings.nodeListeningPort);
						
						$('#public-node-protocol-select').val(nodeSettings.publicNodeProtocol);
						$('#public-node-address-input').val(nodeSettings.publicNodeAddress);
						$('#public-node-port-input').val(nodeSettings.publicNodePort);
					}
				})
				.fail(function() {
					showAlert(true, 'failed to retrieve node settings');
				});
			}
			
			$(document).on('change', '#avatar_file_input', function(event) {
				const file = this.files[0];

				if (file.size > 0 && (file.type.match("image/jpeg") || file.type.match("image/png"))) {
					let formData = new FormData();
					
					formData.append('avatar_file', file);

					this.value = null;
					
					$.ajax({type: 'POST', url: '/settings/node/avatar', data: formData, processData: false, contentType: false})
					.done(function (data, textStatus, xhr) {
						if(data.isError) {
							showAlert(true, data.message);
						}
						else {
							fetch('/settings/node/avatar')
							.then(response => {
								if (response.ok) {
									return response.blob();
								}
								throw new Error('...something went wrong...');
							})
							.then(blob => {
								const objectURL = URL.createObjectURL(blob);
								
								$('.node-avatar').attr('src', objectURL);
							})
							.catch(error => {
								showAlert(true, 'an error occurred, please try again');
							});
						}
					})
					.fail(function() {
						showAlert(true, 'an error occurred, please try again');
					});
				}
			});
			
			$(document).on('change', '#banner_file_input', function(event) {
				const file = this.files[0];
				
				let formData = new FormData();
				
				formData.append('banner_file', file);

				this.value = null;
				
				$.ajax({type: 'POST', url: '/settings/node/banner', data: formData, processData: false, contentType: false})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						showAlert(true, data.message);
					}
					else {
						fetch('/settings/node/banner')
						.then(response => {
							if (response.ok) {
								return response.blob();
							}
							throw new Error('...something went wrong...');
						})
						.then(blob => {
							const objectURL = URL.createObjectURL(blob);
							
							$('#node-banner').attr('src', objectURL);
						})
						.catch(error => {
							showAlert(true, 'an error occurred, please try again');
						});
					}
				})
				.fail(function() {
					showAlert(true, 'an error occurred, please try again');
				});
			});
			
			$("#personalize_settings_node_name_form").submit(function(event) {
				event.preventDefault();

				let form = $(this);

				let url = form.attr('action');
				let nodeName = form.find('input[name="nodeNameJustCuz"]').val();

				$.post(url, {nodeName: nodeName})
				.done(function(data) {
					if(data.isError) {
						showAlert(true, data.message);
					}
					else {
						showAlert(false);
					}
				})
				.fail(function() {
					showAlert(true, 'an error occurred, please try again');
				});
			});

			$("#personalize_settings_node_about_form").submit(function(event) {
				event.preventDefault();

				let form = $(this);

				let url = form.attr('action');
				let nodeAbout = form.find('textarea[name="nodeAbout"]').val();

				$.post(url, {nodeAbout: nodeAbout})
				.done(function(data) {
					if(data.isError) {
						showAlert(true, data.message);
					}
					else {
						showAlert(false);
					}
				})
				.fail(function() {
					showAlert(true, 'an error occurred, please try again');
				});
			});

			$("#personalize_settings_node_id_form").submit(function(event) {
				event.preventDefault();

				let form = $(this);

				let url = form.attr('action');
				let nodeId = form.find('input[name="nodeId"]').val();

				$.post(url, {nodeId: nodeId})
				.done(function(data) {
					if(data.isError) {
						showAlert(true, data.message);
					}
					else {
						showAlert(false);
					}
				})
				.fail(function() {
					showAlert(true, 'an error occurred, please try again');
				});
			});
			
			$("#internal_network_settings_form").submit(function(event) {
				event.preventDefault();

				let form = $(this);

				let url = form.attr('action');
				let nodeListeningPort = form.find('input[name="nodeListeningPort"]').val();
				
				Swal.fire({
					title: 'please wait',
					html: '...changing node listening port...',
					timer: 5000,
					timerProgressBar: true,
					allowOutsideClick: false,
					didOpen: () => {
						Swal.showLoading()
						
						$.post(url, {nodeListeningPort: nodeListeningPort})
						.done(function(data) {
							if(data.isError) {
								showAlert(true, data.message);
							}
							else {
								
							}
						})
						.fail(function() {
							showAlert(true, 'an error occurred, please try again');
						});
					}
				}).then((result) => {
					if (result.dismiss === Swal.DismissReason.timer) {
						showAlert(false);
					}
				});
			});
			
			$("#external_network_settings_form").submit(function(event) {
				event.preventDefault();

				let form = $(this);

				let url = form.attr('action');
				
				let publicNodeProtocol = form.find('select[name="publicNodeProtocol"]').val();
				let publicNodeAddress = form.find('input[name="publicNodeAddress"]').val();
				let publicNodePort = form.find('input[name="publicNodePort"]').val();
				
				if(publicNodeProtocol != null && publicNodeAddress !== '' && publicNodePort !== '') {
					$.post(url, {publicNodeProtocol: publicNodeProtocol, publicNodeAddress: publicNodeAddress, publicNodePort: publicNodePort})
					.done(function(data) {
						if(data.isError) {
							showAlert(true, data.message);
						}
						else {
							showAlert(false);
						}
					})
					.fail(function() {
						showAlert(true, 'an error occurred, please try again');
					});
				}
			});

			$("#account_credentials_settings_form").submit(function(event) {
				event.preventDefault();

				let form = $(this);

				let url = form.attr('action');
				let username = form.find('input[name="username"]').val();
				let password = form.find('input[name="password"]').val();
				
				if(username !== '' && password !== '') {
					$.post(url, {username: username, password: password})
					.done(function(data) {
						if(data.isError) {
							showAlert(true, data.message);
						}
						else {
							form.find('input[name="username"]').val('');
							form.find('input[name="password"]').val('');
							
							showAlert(false);
						}
					})
					.fail(function() {
						showAlert(true, 'an error occurred, please try again');
					});
				}
			});
			
			function toggleClientSettingGpuAccelerationCheckbox(checkbox) {
				const isGpuAccelerationEnabled = $(checkbox).is(':checked');
				
				$(checkbox).prop('disabled', true);
				
				if(isGpuAccelerationEnabled) {
					$('#client-setting-gpu-acceleration-label').text('...enabling...');
				}
				else {
					$('#client-setting-gpu-acceleration-label').text('...disabling...');
				}
				
				$.ajax({type: 'POST', url: '/settings/client/gpuAcceleration', data: JSON.stringify({isGpuAccelerationEnabled: isGpuAccelerationEnabled}), contentType: 'application/json; charset=utf-8'})
				.always(function() {
					$(checkbox).prop('disabled', false);
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						$(checkbox).prop('checked', !isGpuAccelerationEnabled);
						
						showAlert(true, data.message);
					}
					else {
						if(data.result.isGpuAccelerationEnabled) {
							const gpuVendorAndModel = data.result.gpuVendor + ' ' + data.result.gpuModel;
							$('#client-setting-gpu-acceleration-label').text(gpuVendorAndModel);
						}
						else {
							$('#client-setting-gpu-acceleration-label').text('disabled');
						}
					}
				})
				.fail(function() {
					$(checkbox).prop('checked', !isGpuAccelerationEnabled);

					showAlert(true, 'an error occurred, please try again');
				});
			}

			function showEncodingSettings(encodingType) {
				let html = '';

				if(encodingType === 'Video') {
					html = html = '\
					<div>\
						<button class="btn btn-primary encoding-settings" type="button" data-format="hls">HLS</button>\
						<button class="btn btn-primary encoding-settings" type="button" data-format="mp4">MP4</button>\
						<button class="btn btn-primary encoding-settings" type="button" data-format="webm">WEBM</button>\
						<button class="btn btn-primary encoding-settings" type="button" data-format="ogv">OGV</button>\
					</div>';
				}
				else if(encodingType === 'Live') {
					html = html = '\
					<div>\
						<button class="btn btn-primary encoding-settings" type="button" data-format="hls">HLS</button>\
					</div>';
				}

				Swal.fire({
					title: `${encodingType} Encoding Settings`,
					html: html,
					showCloseButton: true,
					showConfirmButton: false,
					didOpen: () => {
						$('.encoding-settings').click(function() {
							const format = $(this).data('format');

							let html = '\
							<div class="">\
								<input id="2160p-bitrate-range-' + format + '" class="encoding-setting-slider bitrate-slider w-100" data-resolution="2160p" type="range" min="0" max="100000" value="0" step="1000" disabled>\
								<p>2160p bitrate: <span id="2160p-bitrate-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<input id="1440p-bitrate-range-' + format + '" class="encoding-setting-slider bitrate-slider w-100" data-resolution="1440p" type="range" min="0" max="100000" value="0" step="1000" disabled>\
								<p>1440p bitrate: <span id="1440p-bitrate-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<input id="1080p-bitrate-range-' + format + '" class="encoding-setting-slider bitrate-slider w-100" data-resolution="1080p" type="range" min="0" max="100000" value="0" step="1000" disabled>\
								<p>1080p bitrate: <span id="1080p-bitrate-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<input id="720p-bitrate-range-' + format + '" class="encoding-setting-slider bitrate-slider w-100" data-resolution="720p" type="range" min="0" max="100000" value="0" step="1000" disabled>\
								<p>720p bitrate: <span id="720p-bitrate-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<input id="480p-bitrate-range-' + format + '" class="encoding-setting-slider bitrate-slider w-100" data-resolution="480p" type="range" min="0" max="100000" value="0" step="1000" disabled>\
								<p>480p bitrate: <span id="480p-bitrate-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<input id="360p-bitrate-range-' + format + '" class="encoding-setting-slider bitrate-slider w-100" data-resolution="360p" type="range" min="0" max="100000" value="0" step="1000" disabled>\
								<p>360p bitrate: <span id="360p-bitrate-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<input id="240p-bitrate-range-' + format + '" class="encoding-setting-slider bitrate-slider w-100" data-resolution="240p" type="range" min="0" max="100000" value="0" step="1000" disabled>\
								<p>240p bitrate: <span id="240p-bitrate-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<input id="framerate-range-' + format + '" class="encoding-setting-slider framerate-slider w-100" type="range" min="1" max="300" value="1" step="1" disabled>\
								<p>framerate: <span id="framerate-span-' + format + '"></span></p>\
							</div>\
							';

							if(format === 'hls') {
								html += '\
								<div class="">\
									<input id="segment-length-range-' + format + '" class="encoding-setting-slider segment-length-slider w-100" type="range" min="1" max="10" value="1" step="1" disabled>\
									<p>segment length: <span id="segment-length-span-' + format + '"></span></p>\
								</div>\
								';
							}

							html += '\
							<div class="">\
								<input id="gop-range-' + format + '" class="encoding-setting-slider gop-slider w-100" type="range" min="1" max="3000" value="1" step="1" disabled>\
								<p>GoP (group of pictures): <span id="gop-span-' + format + '"></span></p>\
							</div>\
							<div class="">\
								<button type="button" class="swal2-cancel swal2-styled encoding-default-button" aria-label="" style="display: inline-block;">Default</button>\
							</div>\
							';
							
							Swal.fire({
								title: `${encodingType} Encoding Settings<br>(${format.toUpperCase()})`,
								html: html,
								showCloseButton: true,
								showConfirmButton: true,
								confirmButtonText: 'Save',
								didOpen: () => {
									let encoderSettings;

									if(encodingType === 'Video') {
										encoderSettings = CLIENT_SETTINGS.videoEncoderSettings;
									}
									else if(encodingType === 'Live') {
										encoderSettings = CLIENT_SETTINGS.liveEncoderSettings;
									}

									$('.bitrate-slider').on('input', function () {
										const resolution = $(this).data('resolution');
										const bitrate = Number($(this).val());

										$('#' + resolution + '-bitrate-span-' + format).text(bitrate + 'K');

										encoderSettings[format][resolution + '-bitrate'] = bitrate;

										if(encodingType === 'Video') {
											CLIENT_SETTINGS.videoEncoderSettings = encoderSettings;
										}
										else if(encodingType === 'Live') {
											CLIENT_SETTINGS.liveEncoderSettings = encoderSettings;
										}
									});

									$('.framerate-slider').on('input', function () {
										const framerate = Number($(this).val());
										const segmentLength = Number($('#segment-length-range-' + format).val());

										$('#framerate-span-' + format).text(framerate);

										let gop = framerate * segmentLength;

										$('#gop-range-' + format).val(gop);
										$('#gop-span-' + format).text(gop);

										encoderSettings[format]['framerate'] = framerate;
										encoderSettings[format]['gop'] = gop;

										if(encodingType === 'Video') {
											CLIENT_SETTINGS.videoEncoderSettings = encoderSettings;
										}
										else if(encodingType === 'Live') {
											CLIENT_SETTINGS.liveEncoderSettings = encoderSettings;
										}
									});

									$('.segment-length-slider').on('input', function () {
										const segmentLength = Number($(this).val());
										const framerate = Number($('#framerate-range-' + format).val());

										$('#segment-length-span-' + format).text(segmentLength);

										let gop = framerate * segmentLength;

										$('#gop-range-' + format).val(gop);
										$('#gop-span-' + format).text(gop);

										encoderSettings[format]['segmentLength'] = segmentLength;
										encoderSettings[format]['gop'] = gop;

										if(encodingType === 'Video') {
											CLIENT_SETTINGS.videoEncoderSettings = encoderSettings;
										}
										else if(encodingType === 'Live') {
											CLIENT_SETTINGS.liveEncoderSettings = encoderSettings;
										}
									});

									$('.gop-slider').on('input', function () {
										const gop = Number($(this).val());

										$('#gop-span-' + format).text(gop);

										encoderSettings[format]['gop'] = gop;

										if(encodingType === 'Video') {
											CLIENT_SETTINGS.videoEncoderSettings = encoderSettings;
										}
										else if(encodingType === 'Live') {
											CLIENT_SETTINGS.liveEncoderSettings = encoderSettings;
										}
									});

									$('.encoding-default-button').on('click', function () {
										$.ajax({type: 'GET', url: '/settings/client/encoding/default'})
										.done(function (data, textStatus, xhr) {
											if(data.isError) {
												showAlert(true, data.message);
											}
											else {
												const videoEncoderSettings = data.videoEncoderSettings;
												const liveEncoderSettings = data.liveEncoderSettings;
												
												CLIENT_SETTINGS.videoEncoderSettings = videoEncoderSettings;
												CLIENT_SETTINGS.liveEncoderSettings = liveEncoderSettings;

												if(encodingType === 'Video') {
													encoderSettings = videoEncoderSettings;
												}
												else if(encodingType === 'Live') {
													encoderSettings = liveEncoderSettings;
												}
												
												loadEncoderSettings();
											}
										})
										.fail(function()
										{
											showAlert(true, 'unable to communicate with node');
										});
									});

									function loadEncoderSettings() {
										$('#2160p-bitrate-range-' + format).val(encoderSettings[format]['2160p-bitrate']);
										$('#2160p-bitrate-span-' + format).text(encoderSettings[format]['2160p-bitrate'] + 'K');

										$('#1440p-bitrate-range-' + format).val(encoderSettings[format]['1440p-bitrate']);
										$('#1440p-bitrate-span-' + format).text(encoderSettings[format]['1440p-bitrate'] + 'K');

										$('#1080p-bitrate-range-' + format).val(encoderSettings[format]['1080p-bitrate']);
										$('#1080p-bitrate-span-' + format).text(encoderSettings[format]['1080p-bitrate'] + 'K');

										$('#720p-bitrate-range-' + format).val(encoderSettings[format]['720p-bitrate']);
										$('#720p-bitrate-span-' + format).text(encoderSettings[format]['720p-bitrate'] + 'K');

										$('#480p-bitrate-range-' + format).val(encoderSettings[format]['480p-bitrate']);
										$('#480p-bitrate-span-' + format).text(encoderSettings[format]['480p-bitrate'] + 'K');

										$('#360p-bitrate-range-' + format).val(encoderSettings[format]['360p-bitrate']);
										$('#360p-bitrate-span-' + format).text(encoderSettings[format]['360p-bitrate'] + 'K');

										$('#240p-bitrate-range-' + format).val(encoderSettings[format]['240p-bitrate']);
										$('#240p-bitrate-span-' + format).text(encoderSettings[format]['240p-bitrate'] + 'K');

										$('#gop-range-' + format).val(encoderSettings[format]['gop']);
										$('#gop-span-' + format).text(encoderSettings[format]['gop']);

										$('#framerate-range-' + format).val(encoderSettings[format]['framerate']);
										$('#framerate-span-' + format).text(encoderSettings[format]['framerate']);

										$('#segment-length-range-' + format).val(encoderSettings[format]['segmentLength']);
										$('#segment-length-span-' + format).text(encoderSettings[format]['segmentLength']);
									}

									loadEncoderSettings();

									$('.encoding-setting-slider').prop('disabled', false);
								}
							}).then((result) => {
								if (result.isConfirmed) {
									const data = {
										videoEncoderSettings: CLIENT_SETTINGS.videoEncoderSettings,
										liveEncoderSettings: CLIENT_SETTINGS.liveEncoderSettings
									};

									$.ajax({type: 'POST', url: '/settings/client/encoding', data: JSON.stringify(data), contentType: 'application/json; charset=utf-8'})
									.done(function (data, textStatus, xhr) {
										if(data.isError) {
											showAlert(false, data.message);
										}
									})
									.fail(function() {
										showAlert(true, 'an error occurred, please try again');
									});
								}
							});
						});
					}
				});
			}
			
			function toggleNodeSettingSecureModeCheckbox(checkbox) {
				const isCheckboxChecked = $(checkbox).prop('checked');
				
				if(isCheckboxChecked) {
					const html = '\
					<div id="secure-connection-modal" class="container-fluid py-4">\
						<div class="input-group mb-3"><label class="input-group-text" for="key-file-input"><b>key file</b></label><input type="file" class="form-control" id="key-file-input"></div>\
						<div class="input-group mb-3"><label class="input-group-text" for="cert-file-input"><b>cert file</b></label><input type="file" class="form-control" id="cert-file-input"></div>\
						<div class="input-group mb-3"><label class="input-group-text" for="ca-files-input"><b>ca files</b></label><input type="file" multiple class="form-control" id="ca-files-input"></div>\
					</div>';
					
					Swal.fire({
						title: 'upload SSL files',
						html: html,
						showCloseButton: true,
						willOpen: () => {
							
						},
						didOpen: () => {
							
						},
						preConfirm: () => {
							Swal.showLoading();
						
							const keyFile = $('#key-file-input').get(0).files[0];
							const certFile = $('#cert-file-input').get(0).files[0];
							const caFiles = $('#ca-files-input').get(0).files;
							
							let formData = new FormData();
							
							formData.append('keyFile', keyFile);
							formData.append('certFile', certFile);
							
							for (let i = 0; i < caFiles.length; i++) {
								formData.append('caFiles', caFiles[i]);
							}

							Swal.fire({
								title: 'please wait',
								html: '...enabling secure HTTPS mode...',
								timer: 5000,
								timerProgressBar: true,
								allowOutsideClick: false,
								didOpen: () => {
									Swal.showLoading();

									$.ajax({type: 'POST', url: '/settings/node/secure?isSecure=' + isCheckboxChecked, data: formData, processData: false, contentType: false})
									.done(function (data, textStatus, xhr) {
										if(data.isError) {
											$(checkbox).prop('checked', !isCheckboxChecked);
											
											showAlert(true, data.message);
										}
									})
									.fail(function() {
										$(checkbox).prop('checked', !isCheckboxChecked);
										
										showAlert(true, 'an error occurred, please try again');
									});
								}
							}).then((result) => {
								if (result.dismiss === Swal.DismissReason.timer) {
									showAlert(false);
								}
							});

							return false;
						}
					})
					.then((result) => {
						$(checkbox).prop('checked', !isCheckboxChecked);
					});
				}
				else {
					Swal.fire({
						title: 'please wait',
						html: '...enabling non-secure HTTP mode...',
						timer: 5000,
						timerProgressBar: true,
						allowOutsideClick: false,
						didOpen: () => {
							Swal.showLoading();

							let formData = new FormData();
							
							$.ajax({type: 'POST', url: '/settings/node/secure?isSecure=' + isCheckboxChecked, data: formData, processData: false, contentType: false})
							.done(function (data, textStatus, xhr) {
								if(data.isError) {
									$(checkbox).prop('checked', !isCheckboxChecked);
									
									showAlert(true, data.message);
								}
							})
							.fail(function() {
								$(checkbox).prop('checked', !isCheckboxChecked);

								showAlert(true, 'an error occurred, please try again');
							});
						}
					}).then((result) => {
						if (result.dismiss === Swal.DismissReason.timer) {
							showAlert(false);
						}
					});
				}
			}

			function toggleCloudflareIntegrationCheckbox(checkbox) {
				const isCheckboxChecked = $(checkbox).prop('checked');
				
				if(isCheckboxChecked) {
					const title = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 84.953" width="256" height="85"><path d="M253.827 69.103a2.16 2.16 0 0 1-2.173-2.173c0-1.175.962-2.173 2.173-2.173 1.175 0 2.173.962 2.173 2.173a2.21 2.21 0 0 1-2.173 2.173m0-3.918a1.75 1.75 0 0 0-1.745 1.745 1.75 1.75 0 0 0 1.745 1.745 1.75 1.75 0 0 0 1.745-1.745 1.75 1.75 0 0 0-1.745-1.745m1.104 2.885h-.5l-.427-.82h-.57v.82h-.463v-2.387h1.14c.5 0 .82.32.82.784a.74.74 0 0 1-.499.712l.5.9zm-.855-1.247c.178 0 .356-.107.356-.356 0-.285-.142-.356-.356-.356h-.712v.712h.712zM42.673 84.526h-15.2V64.543h5.557v15.138h9.653zm5.735-9.938v-.07c0-5.735 4.63-10.4 10.793-10.4s10.722 4.595 10.722 10.33v.07c0 5.735-4.63 10.4-10.793 10.4s-10.722-4.595-10.722-10.33m15.886 0v-.07c0-2.885-2.066-5.38-5.13-5.38-3.028 0-5.058 2.458-5.058 5.343v.07c0 2.885 2.066 5.38 5.094 5.38 3.063 0 5.094-2.458 5.094-5.343m12.43 1.175v-11.22h5.628v11.113c0 2.885 1.46 4.24 3.67 4.24s3.67-1.318 3.67-4.096V64.543h5.628V75.62c0 6.447-3.67 9.26-9.368 9.26-5.664 0-9.226-2.85-9.226-9.12m27.07-11.22h7.694c7.124 0 11.292 4.096 11.292 9.867v.07c0 5.77-4.203 10.045-11.398 10.045h-7.587V64.543zm7.8 15.067c3.313 0 5.52-1.817 5.52-5.058v-.07c0-3.206-2.208-5.058-5.52-5.058h-2.244v10.152h2.244zm24.756-6.803h9.475v4.595h-9.475v7.124h-5.52V64.543h15.993v4.844h-10.472zm33.376 11.72h-15.2V64.543h5.52v15.138h9.69zM184.19 64.4h5.343l8.513 20.125h-5.95l-1.46-3.562h-7.694l-1.425 3.562h-5.806L184.19 64.4zm4.88 12.253L186.862 71l-2.244 5.664h4.452zm16.1-12.11h9.44c3.063 0 5.165.784 6.518 2.173 1.175 1.14 1.78 2.67 1.78 4.666v.07c0 3.063-1.64 5.094-4.096 6.127l4.773 6.982h-6.412l-4.025-6.055h-2.422v6.055h-5.557V64.543zm9.2 9.582c1.888 0 2.956-.926 2.956-2.35v-.07c0-1.567-1.14-2.35-2.992-2.35h-3.633v4.773h3.67zm22.013-1.852h9.582v4.38h-9.582v3.17h10.722v4.702h-16.207V64.543h16.065v4.702h-10.58zM15.352 76.94c-.784 1.745-2.422 2.992-4.56 2.992-3.028 0-5.094-2.53-5.094-5.38v-.07c0-2.885 2.03-5.343 5.058-5.343 2.28 0 4.025 1.39 4.737 3.313h5.842c-.926-4.773-5.13-8.3-10.543-8.3C4.63 64.15 0 68.818 0 74.552v.07c0 5.735 4.56 10.33 10.722 10.33 5.272 0 9.404-3.42 10.472-7.98l-5.842-.036z" fill="#404041"/><path d="M159.97 54.926h80.43V32.663l-15.28-8.762-2.636-1.14-62.513.427z" fill="#fff"/><path d="M212.58 52.005c.748-2.565.463-4.916-.784-6.66-1.14-1.603-3.063-2.53-5.38-2.636l-43.848-.57a.81.81 0 0 1-.677-.356c-.142-.214-.178-.5-.107-.784.142-.427.57-.748 1.033-.784l44.24-.57c5.236-.25 10.935-4.488 12.93-9.69l2.53-6.6c.107-.285.142-.57.07-.855C219.74 9.617 208.234 0 194.485 0c-12.68 0-23.438 8.193-27.285 19.555-2.493-1.852-5.664-2.85-9.083-2.53-6.09.606-10.97 5.485-11.576 11.576-.142 1.567-.036 3.1.32 4.524-9.938.285-17.88 8.406-17.88 18.415 0 .9.07 1.78.178 2.67.07.427.427.748.855.748h80.928c.463 0 .9-.32 1.033-.784l.606-2.173z" fill="#f38020"/><path d="M226.543 23.83l-1.21.036c-.285 0-.534.214-.64.5l-1.7 5.95c-.748 2.565-.463 4.916.784 6.66 1.14 1.603 3.063 2.53 5.38 2.636l9.332.57a.81.81 0 0 1 .677.356c.142.214.178.534.107.784-.142.427-.57.748-1.033.784l-9.724.57c-5.272.25-10.935 4.488-12.93 9.69l-.712 1.817c-.142.356.107.712.5.712h33.41c.392 0 .748-.25.855-.64.57-2.066.9-4.24.9-6.483 0-13.18-10.757-23.937-23.972-23.937" fill="#faae40"/></svg>';

					const html = '\
					Your MoarTube Node can be integrated into the <a href="https://www.cloudflare.com/network/" target="_blank">Cloudflare Network</a>,\
					appointing Cloudflare as the main distributor of the majority of your node\'s data.\
					This will empower your node with unlimited bandwidth, unlimited processing capacity, and unlimited audience sizes for both videos and live streams.';

					Swal.fire({
						title: title,
						html: html,
						showCloseButton: true,
						width: "45rem",
						showConfirmButton: true,
						confirmButtonText: 'Continue'
					}).then((result) => {
						if (result.isConfirmed) {
							const html = '\
							<div id="secure-connection-modal" class="container-fluid">\
								<div class="input-group mb-3"><input id="cloudflareEmailAddress" class="form-control" type="text" required="" autocomplete="off" placeholder="Email Address"></div>\
								<div class="input-group mb-3"><input id="cloudflareZoneId" class="form-control" type="text" required="" autocomplete="off" placeholder="Zone ID"></div>\
								<div class="input-group"><input id="cloudflareGlobalApiKey" class="form-control" type="text" required="" autocomplete="off" placeholder="Global API Key"></div>\
							</div>';
							
							Swal.fire({
								title: title,
								html: html,
								showCloseButton: true,
								showConfirmButton: true,
								confirmButtonText: 'Enable',
								willOpen: () => {
									
								},
								didOpen: () => {
									
								},
								preConfirm: () => {
									Swal.showLoading();

									const cloudflareEmailAddress = $('#cloudflareEmailAddress').val();
									const cloudflareZoneId = $('#cloudflareZoneId').val();
									const cloudflareGlobalApiKey = $('#cloudflareGlobalApiKey').val();

									Swal.fire({
										title: 'please wait',
										html: '...enabling Cloudflare integration...',
										showConfirmButton: false,
										willOpen: () => {
											Swal.showLoading();
										},
										didOpen: () => {
											$.post('/settings/node/cloudflare/configure', {cloudflareEmailAddress: cloudflareEmailAddress, cloudflareZoneId: cloudflareZoneId, cloudflareGlobalApiKey: cloudflareGlobalApiKey})
											.done(function (data, textStatus, xhr) {
												if(data.isError) {
													$(checkbox).prop('checked', !isCheckboxChecked);

													showAlert(true, data.message);
												}
												else {
													showAlert(false, 'Cloudflare Integration Enabled');
												}
											})
											.fail(function() {
												showAlert(true, 'an error occurred, please try again');
											});
										}
									});
									
									return false;
								}
							})
							.then((result) => {
								$(checkbox).prop('checked', !isCheckboxChecked);
							});
						}
						else {
							$(checkbox).prop('checked', !isCheckboxChecked);
						}
					});
				}
				else {
					Swal.fire({
						title: 'please wait',
						html: '...disabling Cloudflare integration...',
						showConfirmButton: false,
						didOpen: () => {
							Swal.showLoading();

							$.post('/settings/node/cloudflare/clear', {})
							.done(function(data) {
								if(data.isError) {
									$(checkbox).prop('checked', !isCheckboxChecked);
									
									showAlert(true, data.message);
								}
								else {
									showAlert(false, 'Cloudflare Integration Disabled');
								}
							})
							.fail(function() {
								showAlert(true, 'an error occurred, please try again');
							});
						}
					});
				}
			}

			function toggleCloudflareTurnstileCheckbox(checkbox) {
				const isCheckboxChecked = $(checkbox).prop('checked');
				
				if(isCheckboxChecked) {
					const title = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 84.953" width="256" height="85"><path d="M253.827 69.103a2.16 2.16 0 0 1-2.173-2.173c0-1.175.962-2.173 2.173-2.173 1.175 0 2.173.962 2.173 2.173a2.21 2.21 0 0 1-2.173 2.173m0-3.918a1.75 1.75 0 0 0-1.745 1.745 1.75 1.75 0 0 0 1.745 1.745 1.75 1.75 0 0 0 1.745-1.745 1.75 1.75 0 0 0-1.745-1.745m1.104 2.885h-.5l-.427-.82h-.57v.82h-.463v-2.387h1.14c.5 0 .82.32.82.784a.74.74 0 0 1-.499.712l.5.9zm-.855-1.247c.178 0 .356-.107.356-.356 0-.285-.142-.356-.356-.356h-.712v.712h.712zM42.673 84.526h-15.2V64.543h5.557v15.138h9.653zm5.735-9.938v-.07c0-5.735 4.63-10.4 10.793-10.4s10.722 4.595 10.722 10.33v.07c0 5.735-4.63 10.4-10.793 10.4s-10.722-4.595-10.722-10.33m15.886 0v-.07c0-2.885-2.066-5.38-5.13-5.38-3.028 0-5.058 2.458-5.058 5.343v.07c0 2.885 2.066 5.38 5.094 5.38 3.063 0 5.094-2.458 5.094-5.343m12.43 1.175v-11.22h5.628v11.113c0 2.885 1.46 4.24 3.67 4.24s3.67-1.318 3.67-4.096V64.543h5.628V75.62c0 6.447-3.67 9.26-9.368 9.26-5.664 0-9.226-2.85-9.226-9.12m27.07-11.22h7.694c7.124 0 11.292 4.096 11.292 9.867v.07c0 5.77-4.203 10.045-11.398 10.045h-7.587V64.543zm7.8 15.067c3.313 0 5.52-1.817 5.52-5.058v-.07c0-3.206-2.208-5.058-5.52-5.058h-2.244v10.152h2.244zm24.756-6.803h9.475v4.595h-9.475v7.124h-5.52V64.543h15.993v4.844h-10.472zm33.376 11.72h-15.2V64.543h5.52v15.138h9.69zM184.19 64.4h5.343l8.513 20.125h-5.95l-1.46-3.562h-7.694l-1.425 3.562h-5.806L184.19 64.4zm4.88 12.253L186.862 71l-2.244 5.664h4.452zm16.1-12.11h9.44c3.063 0 5.165.784 6.518 2.173 1.175 1.14 1.78 2.67 1.78 4.666v.07c0 3.063-1.64 5.094-4.096 6.127l4.773 6.982h-6.412l-4.025-6.055h-2.422v6.055h-5.557V64.543zm9.2 9.582c1.888 0 2.956-.926 2.956-2.35v-.07c0-1.567-1.14-2.35-2.992-2.35h-3.633v4.773h3.67zm22.013-1.852h9.582v4.38h-9.582v3.17h10.722v4.702h-16.207V64.543h16.065v4.702h-10.58zM15.352 76.94c-.784 1.745-2.422 2.992-4.56 2.992-3.028 0-5.094-2.53-5.094-5.38v-.07c0-2.885 2.03-5.343 5.058-5.343 2.28 0 4.025 1.39 4.737 3.313h5.842c-.926-4.773-5.13-8.3-10.543-8.3C4.63 64.15 0 68.818 0 74.552v.07c0 5.735 4.56 10.33 10.722 10.33 5.272 0 9.404-3.42 10.472-7.98l-5.842-.036z" fill="#404041"/><path d="M159.97 54.926h80.43V32.663l-15.28-8.762-2.636-1.14-62.513.427z" fill="#fff"/><path d="M212.58 52.005c.748-2.565.463-4.916-.784-6.66-1.14-1.603-3.063-2.53-5.38-2.636l-43.848-.57a.81.81 0 0 1-.677-.356c-.142-.214-.178-.5-.107-.784.142-.427.57-.748 1.033-.784l44.24-.57c5.236-.25 10.935-4.488 12.93-9.69l2.53-6.6c.107-.285.142-.57.07-.855C219.74 9.617 208.234 0 194.485 0c-12.68 0-23.438 8.193-27.285 19.555-2.493-1.852-5.664-2.85-9.083-2.53-6.09.606-10.97 5.485-11.576 11.576-.142 1.567-.036 3.1.32 4.524-9.938.285-17.88 8.406-17.88 18.415 0 .9.07 1.78.178 2.67.07.427.427.748.855.748h80.928c.463 0 .9-.32 1.033-.784l.606-2.173z" fill="#f38020"/><path d="M226.543 23.83l-1.21.036c-.285 0-.534.214-.64.5l-1.7 5.95c-.748 2.565-.463 4.916.784 6.66 1.14 1.603 3.063 2.53 5.38 2.636l9.332.57a.81.81 0 0 1 .677.356c.142.214.178.534.107.784-.142.427-.57.748-1.033.784l-9.724.57c-5.272.25-10.935 4.488-12.93 9.69l-.712 1.817c-.142.356.107.712.5.712h33.41c.392 0 .748-.25.855-.64.57-2.066.9-4.24.9-6.483 0-13.18-10.757-23.937-23.972-23.937" fill="#faae40"/></svg>';

					const html = '\
					Your MoarTube Node can perform human verification through <a href="https://www.cloudflare.com/products/turnstile/" target="_blank">Cloudflare Turnstile</a>,\
					providing anti-bot detection for video comments, live chat, likes, dislikes, and reports. This will empower your node with the protections necessary for public audiences.';

					Swal.fire({
						title: title,
						html: html,
						showCloseButton: true,
						width: "45rem",
						showConfirmButton: true,
						confirmButtonText: 'Continue'
					}).then((result) => {
						if (result.isConfirmed) {
							const html = '\
							<div id="secure-connection-modal" class="container-fluid">\
								<div class="input-group mb-3"><input id="cloudflareTurnstileSiteKey" class="form-control" type="text" required="" autocomplete="off" placeholder="Site Key"></div>\
								<div class="input-group mb-3"><input id="cloudflareTurnstileSecretKey" class="form-control" type="text" required="" autocomplete="off" placeholder="Secret Key"></div>\
							</div>';
							
							Swal.fire({
								title: title,
								html: html,
								showCloseButton: true,
								showConfirmButton: true,
								confirmButtonText: 'Enable',
								willOpen: () => {
									
								},
								didOpen: () => {
									
								},
								preConfirm: () => {
									Swal.showLoading();

									const cloudflareTurnstileSiteKey = $('#cloudflareTurnstileSiteKey').val();
									const cloudflareTurnstileSecretKey = $('#cloudflareTurnstileSecretKey').val();

									Swal.fire({
										title: 'please wait',
										html: '...enabling Cloudflare Turnstile...',
										showConfirmButton: false,
										willOpen: () => {
											Swal.showLoading();
										},
										didOpen: () => {
											$.post('/settings/node/cloudflare/turnstile/configure', {cloudflareTurnstileSiteKey: cloudflareTurnstileSiteKey, cloudflareTurnstileSecretKey: cloudflareTurnstileSecretKey})
											.done(function (data, textStatus, xhr) {
												if(data.isError) {
													$(checkbox).prop('checked', !isCheckboxChecked);

													showAlert(true, data.message);
												}
												else {
													showAlert(false, 'Cloudflare Turnstile Enabled');
												}
											})
											.fail(function() {
												showAlert(true, 'an error occurred, please try again');
											});
										}
									});
									
									return false;
								}
							})
							.then((result) => {
								$(checkbox).prop('checked', !isCheckboxChecked);
							});
						}
						else {
							$(checkbox).prop('checked', !isCheckboxChecked);
						}
					});
				}
				else {
					Swal.fire({
						title: 'please wait',
						html: '...disabling Cloudflare Turnstile...',
						showConfirmButton: false,
						didOpen: () => {
							Swal.showLoading();

							$.post('/settings/node/cloudflare/turnstile/clear', {})
							.done(function(data) {
								if(data.isError) {
									$(checkbox).prop('checked', !isCheckboxChecked);
									
									showAlert(true, data.message);
								}
								else {
									showAlert(false, 'Cloudflare Turnstile Disabled');
								}
							})
							.fail(function() {
								showAlert(true, 'an error occurred, please try again');
							});
						}
					});
				}
			}

			function toggleDatabaseConfig(radio, event) {
				event.preventDefault();

				$('#database-storage-mode-sqlite-radio').prop('disabled', true);
				$('#database-storage-mode-postgres-radio').prop('disabled', true);

				const databaseDialect = $(radio).data('databasedialect');

				const databaseConfig = {
					databaseDialect:databaseDialect
				}
				
				if(databaseDialect === 'sqlite') {
					submitDatabaseConfig(databaseConfig, radio);
				}
				else if(databaseDialect === 'postgres') {
					const html = '\
					<div id="secure-connection-modal" class="container-fluid">\
						<div class="input-group mb-3"><input id="postgresConfigName" class="form-control" type="text" required="" autocomplete="off" placeholder="Database Name"></div>\
						<div class="input-group mb-3"><input id="postgresConfigUsername" class="form-control" type="text" required="" autocomplete="off" placeholder="Username"></div>\
						<div class="input-group mb-3"><input id="postgresConfigPassword" class="form-control" type="text" required="" autocomplete="off" placeholder="Password"></div>\
						<div class="input-group mb-3"><input id="postgresConfigHost" class="form-control" type="text" required="" autocomplete="off" placeholder="Host"></div>\
						<div class="input-group mb-3"><input id="postgresConfigPort" class="form-control" type="text" required="" autocomplete="off" placeholder="Port"></div>\
					</div>';
					
					Swal.fire({
						title: 'Postgres Configuration',
						html: html,
						showCloseButton: true,
						showConfirmButton: true,
						confirmButtonText: 'Save',
						willOpen: () => {
							
						},
						didOpen: () => {
							
						},
						preConfirm: () => {
							Swal.showLoading();

							const postgresConfigName = $('#postgresConfigName').val();
							const postgresConfigUsername = $('#postgresConfigUsername').val();
							const postgresConfigPassword = $('#postgresConfigPassword').val();
							const postgresConfigHost = $('#postgresConfigHost').val();
							const postgresConfigPort = $('#postgresConfigPort').val();

							return { 
								postgresConfigName: postgresConfigName, 
								postgresConfigUsername: postgresConfigUsername, 
								postgresConfigPassword: postgresConfigPassword,
								postgresConfigHost: postgresConfigHost,
								postgresConfigPort: postgresConfigPort
							}
						}
					})
					.then((result) => {
						if (result.isConfirmed) {
							const postgresConfigName = result.value.postgresConfigName;
							const postgresConfigUsername = result.value.postgresConfigUsername;
							const postgresConfigPassword = result.value.postgresConfigPassword;
							const postgresConfigHost = result.value.postgresConfigHost;
							const postgresConfigPort = result.value.postgresConfigPort;

							databaseConfig.postgresConfig = {
								databaseName:postgresConfigName,
								username:postgresConfigUsername,
								password:postgresConfigPassword,
								host:postgresConfigHost,
								port:Number(postgresConfigPort)
							};

							submitDatabaseConfig(databaseConfig, radio);
						}
						else {
							$('#database-storage-mode-sqlite-radio').prop('disabled', false);
							$('#database-storage-mode-postgres-radio').prop('disabled', false);
						}
					});
				}

				function submitDatabaseConfig(databaseConfig, radio) {
					$.ajax({type: 'POST', url: '/settings/node/databaseConfig/toggle', data: JSON.stringify({databaseConfig: databaseConfig}), contentType: 'application/json; charset=utf-8'})
					.always(function() {
						$('#database-storage-mode-sqlite-radio').prop('disabled', false);
						$('#database-storage-mode-postgres-radio').prop('disabled', false);
					})
					.done(function (data, textStatus, xhr) {
						if(data.isError) {
							showAlert(true, data.message);
						}
						else {
							$(radio).prop('checked', true);
						}
					})
					.fail(function() {
						showAlert(true, 'an error occurred, please try again');
					});
				}
			}

			function toggleCommentsCheckbox(checkbox) {
				const isCommentsEnabled = $(checkbox).is(':checked');
				
				$(checkbox).prop('disabled', true);
				
				$.ajax({type: 'POST', url: '/settings/node/comments/toggle', data: JSON.stringify({isCommentsEnabled: isCommentsEnabled}), contentType: 'application/json; charset=utf-8'})
				.always(function() {
					$(checkbox).prop('disabled', false);
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						$(checkbox).prop('checked', !isCommentsEnabled);
						
						showAlert(true, data.message);
					}
					else {

					}
				})
				.fail(function() {
					$(checkbox).prop('checked', !isCommentsEnabled);

					showAlert(true, 'an error occurred, please try again');
				});
			}

			function toggleLikesCheckbox(checkbox) {
				const isLikesEnabled = $(checkbox).is(':checked');
				
				$(checkbox).prop('disabled', true);
				
				$.ajax({type: 'POST', url: '/settings/node/likes/toggle', data: JSON.stringify({isLikesEnabled: isLikesEnabled}), contentType: 'application/json; charset=utf-8'})
				.always(function() {
					$(checkbox).prop('disabled', false);
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						$(checkbox).prop('checked', !isLikesEnabled);
						
						showAlert(true, data.message);
					}
					else {

					}
				})
				.fail(function() {
					$(checkbox).prop('checked', !isLikesEnabled);

					showAlert(true, 'an error occurred, please try again');
				});
			}

			function toggleDislikesCheckbox(checkbox) {
				const isDislikesEnabled = $(checkbox).is(':checked');
				
				$(checkbox).prop('disabled', true);
				
				$.ajax({type: 'POST', url: '/settings/node/dislikes/toggle', data: JSON.stringify({isDislikesEnabled: isDislikesEnabled}), contentType: 'application/json; charset=utf-8'})
				.always(function() {
					$(checkbox).prop('disabled', false);
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						$(checkbox).prop('checked', !isDislikesEnabled);
						
						showAlert(true, data.message);
					}
					else {

					}
				})
				.fail(function() {
					$(checkbox).prop('checked', !isDislikesEnabled);

					showAlert(true, 'an error occurred, please try again');
				});
			}

			function toggleReportsCheckbox(checkbox) {
				const isReportsEnabled = $(checkbox).is(':checked');
				
				$(checkbox).prop('disabled', true);
				
				$.ajax({type: 'POST', url: '/settings/node/reports/toggle', data: JSON.stringify({isReportsEnabled: isReportsEnabled}), contentType: 'application/json; charset=utf-8'})
				.always(function() {
					$(checkbox).prop('disabled', false);
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						$(checkbox).prop('checked', !isReportsEnabled);
						
						showAlert(true, data.message);
					}
					else {

					}
				})
				.fail(function() {
					$(checkbox).prop('checked', !isDislikesEnabled);

					showAlert(true, 'an error occurred, please try again');
				});
			}

			function toggleLiveChatCheckbox(checkbox) {
				const isLiveChatEnabled = $(checkbox).is(':checked');
				
				$(checkbox).prop('disabled', true);
				
				$.ajax({type: 'POST', url: '/settings/node/liveChat/toggle', data: JSON.stringify({isLiveChatEnabled: isLiveChatEnabled}), contentType: 'application/json; charset=utf-8'})
				.always(function() {
					$(checkbox).prop('disabled', false);
				})
				.done(function (data, textStatus, xhr) {
					if(data.isError) {
						$(checkbox).prop('checked', !isLiveChatEnabled);
						
						showAlert(true, data.message);
					}
					else {

					}
				})
				.fail(function() {
					$(checkbox).prop('checked', !isDislikesEnabled);

					showAlert(true, 'an error occurred, please try again');
				});
			}
			
			function showAlert(isError, text) {
				if(isError) {
					Swal.fire({
						html: text,
						icon: 'warning',
						confirmButtonColor: '#3085d6',
						confirmButtonText: 'Ok'
					});
				}
				else {
					const swalObject = {
						icon: 'success',
						showConfirmButton: false,
						timer: 1500
					};

					if(text) {
						swalObject.text = text;
					}

					Swal.fire(swalObject)
				}
			}
		</script>
	</body>
</html>