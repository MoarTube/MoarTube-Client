<!DOCTYPE html>
<html>
	<head>
		<title>MoarTube - Videos</title>
		<link rel="icon" type="image/x-icon" href="/images/favicon.ico">
		<meta charset="utf-8">
		<script src="/javascript/jquery-3.6.4.min.js"></script>
		<link href="/css/Open+Sans300,400,600,700.css" rel="stylesheet">
		<link href="/css/nucleo-icons.css" rel="stylesheet">
		<link href="/css/nucleo-svg.css" rel="stylesheet">
		<link href="/css/free-5.15.4.min.css" rel="stylesheet">
		<link href="/css/free-v4-font-face-5.15.4.min.css" rel="stylesheet">
		<link href="/css/free-v4-shims-5.15.4.min.css" rel="stylesheet">
		<link href="/css/nucleo-svg.css" rel="stylesheet">
		<link href="/css/pickr-nano-theme-1.9.0.min.css" rel="stylesheet">
		<link id="pagestyle" href="/css/soft-ui-dashboard-1.1.0.min.css" rel="stylesheet">
		<style>
			.circle {
				width: 50px;
				margin: 0px;
				display: inline-block;
				position: relative;
				text-align: center;
				line-height: 1.2;
			}

			.circle canvas {
				vertical-align: top;
				width: 50px !important;
			}

			.circle strong {
				position: absolute;
				top: 4px;
				left: 0px;
				width: 100%;
				text-align: center;
				line-height: 40px;
				font-size: 15px;
				color: #67748e;
			}

			.circle strong i {
				font-style: normal;
				font-size: 0.6em;
				font-weight: normal;
			}

			.circle span {
				display: block;
				color: #aaa;
				margin-top: 12px;
			}

			.captcha-container {
				height: 50px;
			}
			
			.share-icon-container {
				display: inline-block;
				margin-right: 8px;
			}
			
			.share-icon-button {
				margin: 1px 0;
				border: none;
				border-radius: 3px;
				padding: 5px 1px 2px;
				outline: none;
				text-align: inherit;
				font-family: inherit;
				background-color: transparent;
				cursor: pointer;
			}

			.share-icon-svg {
				height: 60px;
				width: 60px;
				margin-left: 4px;
				margin-right: 4px;
				margin-bottom: 8px;
			}
			
			.share-icon-title {
				color: black;
				margin: auto;
				width: 68px;
				max-height: 42px;
				text-align: center;
				white-space: normal;
				overflow: hidden;
				font-family: "Roboto","Arial",sans-serif;
				font-size: 14px;
				line-height: 1.8rem;
				font-weight: 400;
			}
			
			.upload-images-button-container {
				background-color: #cb0c9f;
				color: white;
			}
			
			.pcr-button {
				border: 1px solid grey;
			}
		</style>
	</head>
	<body class="g-sidenav-show bg-gray-100">
		<aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3" id="sidenav-main">
			<div class="sidenav-header">
				<i class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
				<a id="node-link" class="navbar-brand m-0" target="_blank">
					<img src="/settings/node/avatar" class="navbar-brand-img h-100" alt="main_logo">
					<span class="ms-1 font-weight-bold">MoarTube Client</span>
				</a>
			</div>
			<hr class="horizontal dark mt-0">
			<div class="collapse navbar-collapse w-auto h-auto" id="sidenav-collapse-main">
				<ul class="navbar-nav">
					<li class="nav-item">
						<div class="collapse  show " id="pagesExamples">
							<ul class="nav ms-4 ps-3">
								<li class="nav-item ">
									<a class="nav-link active " href="/videos">
										<span class="sidenav-mini-icon"> V </span>
										<span class="sidenav-normal"> Videos </span>
									</a>
								</li>
								<li class="nav-item ">
									<a class="nav-link " href="/comments">
										<span class="sidenav-mini-icon"> C </span>
										<span class="sidenav-normal"> Comments </span>
									</a>
								</li>
								<li class="nav-item ">
									<a class="nav-link collapsed" data-bs-toggle="collapse" aria-expanded="false" href="#reports">
										<span class="sidenav-mini-icon"> R </span>
										<span class="sidenav-normal"> Reports <b class="caret"></b></span>
										<span id="total-report-count" class="badge badge-primary ms-1"></span>
									</a>
									<div class="collapse" id="reports">
										<ul class="nav nav-sm flex-column">
											<li class="nav-item">
												<a class="nav-link " href="/reports/videos">
													<span class="sidenav-mini-icon text-xs"> V </span>
													<span class="sidenav-normal"> Videos </span>
													<span id="video-report-count" class="badge badge-primary ms-1"></span>
												</a>
											</li>
											<li class="nav-item">
												<a class="nav-link " href="/reports/comments">
													<span class="sidenav-mini-icon text-xs"> C </span>
													<span class="sidenav-normal"> Comments </span>
													<span id="comment-report-count" class="badge badge-primary ms-1"></span>
												</a>
											</li>
										</ul>
									</div>
								</li>
								<li class="nav-item ">
									<a class="nav-link " href="/settings">
										<span class="sidenav-mini-icon"> S </span>
										<span class="sidenav-normal"> Settings </span>
									</a>
								</li>
							</ul>
						</div>
					</li>
					<li class="nav-item">
						<hr class="horizontal dark">
					</li>
					<li class="nav-item">
						<a class="nav-link" href="http://www.moartube.com/terms-of-service" target="_blank">
							<div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center  me-2 d-flex align-items-center justify-content-center">
								<svg class="text-dark" width="16px" height="16px" viewBox="0 0 40 44" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
									<g id="Basic-Elements" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> 
									<g id="Rounded-Icons" transform="translate(-1870.000000, -591.000000)" fill="#FFFFFF" fill-rule="nonzero"> 
									<g id="Icons-with-opacity" transform="translate(1716.000000, 291.000000)"> 
									<g id="document" transform="translate(154.000000, 300.000000)"> 
									<path class="color-background" d="M40,40 L36.3636364,40 L36.3636364,3.63636364 L5.45454545,3.63636364 L5.45454545,0 L38.1818182,0 C39.1854545,0 40,0.814545455 40,1.81818182 L40,40 Z" id="Path" opacity="0.603585379"></path> 
									<path class="color-background" d="M30.9090909,7.27272727 L1.81818182,7.27272727 C0.814545455,7.27272727 0,8.08727273 0,9.09090909 L0,41.8181818 C0,42.8218182 0.814545455,43.6363636 1.81818182,43.6363636 L30.9090909,43.6363636 C31.9127273,43.6363636 32.7272727,42.8218182 32.7272727,41.8181818 L32.7272727,9.09090909 C32.7272727,8.08727273 31.9127273,7.27272727 30.9090909,7.27272727 Z M18.1818182,34.5454545 L7.27272727,34.5454545 L7.27272727,30.9090909 L18.1818182,30.9090909 L18.1818182,34.5454545 Z M25.4545455,27.2727273 L7.27272727,27.2727273 L7.27272727,23.6363636 L25.4545455,23.6363636 L25.4545455,27.2727273 Z M25.4545455,20 L7.27272727,20 L7.27272727,16.3636364 L25.4545455,16.3636364 L25.4545455,20 Z" id="Shape"></path> 
									</g> 
									</g> 
									</g> 
									</g> 
								</svg>
							</div>
							<span class="nav-link-text ms-1">Terms of Service</span>
						</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="http://www.moartube.com/contact-us" target="_blank">
							<div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center  me-2 d-flex align-items-center justify-content-center">
								<svg width="12px" height="12px" viewBox="0 0 46 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
									<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
									<g transform="translate(-1717.000000, -291.000000)" fill="#FFFFFF" fill-rule="nonzero">
									<g transform="translate(1716.000000, 291.000000)">
									<g transform="translate(1.000000, 0.000000)">
									<path class="color-background opacity-6" d="M45,0 L26,0 C25.447,0 25,0.447 25,1 L25,20 C25,20.379 25.214,20.725 25.553,20.895 C25.694,20.965 25.848,21 26,21 C26.212,21 26.424,20.933 26.6,20.8 L34.333,15 L45,15 C45.553,15 46,14.553 46,14 L46,1 C46,0.447 45.553,0 45,0 Z"></path>
									<path class="color-background" d="M22.883,32.86 C20.761,32.012 17.324,31 13,31 C8.676,31 5.239,32.012 3.116,32.86 C1.224,33.619 0,35.438 0,37.494 L0,41 C0,41.553 0.447,42 1,42 L25,42 C25.553,42 26,41.553 26,41 L26,37.494 C26,35.438 24.776,33.619 22.883,32.86 Z"></path>
									<path class="color-background" d="M13,28 C17.432,28 21,22.529 21,18 C21,13.589 17.411,10 13,10 C8.589,10 5,13.589 5,18 C5,22.529 8.568,28 13,28 Z"></path>
									</g>
									</g>
									</g>
									</g>
								</svg>
							</div>
							<span class="nav-link-text ms-1">Contact Us</span>
						</a>
					</li>
				</ul>
			</div>
		</aside>
		<main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg height-vh-100">
			<nav class="navbar navbar-main navbar-expand-lg position-sticky mt-4 top-1 px-0 mx-4 shadow-none border-radius-xl z-index-sticky" id="navbarBlur" data-scroll="true">
				<div class="container-fluid py-1 px-3">
					<nav aria-label="breadcrumb">
						<h6 class="font-weight-bolder mb-0">Videos</h6>
					</nav>
					<div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
						<div class="ms-md-auto pe-md-3 d-flex align-items-center">
							<div class="dropdown">
								<a class="ms-md-auto d-flex" data-bs-toggle="dropdown" aria-expanded="false" role="button" onclick="populateTagsDropdown(this)"><i class="fa fa-hashtag me-sm-1" aria-hidden="true"></i></a>
								<ul id="tags-dropdown" class="dropdown-menu" aria-labelledby="dropdownMenuButton">
								
								</ul>
							</div>
							<div class="input-group">
								<span class="input-group-text text-body">
									<i id="search_input_icon" class="fas fa-search" aria-hidden="true"></i>
									<div id="search_input_spinner" class="spinner-grow text-primary spinner-grow-sm hidden-elem" role="status">
										<span class="sr-only">Loading...</span>
									</div>
								</span>
								<input type="text" id="search-input" class="form-control" placeholder="Search here..." onfocus="focused(this)" onfocusout="defocused(this)" oninput="searchInputEntered(this)">
							</div>
						</div>
						<ul class="navbar-nav justify-content-end">
							<li class="nav-item d-flex align-items-center">
								<a href="/account/signout" class="nav-link text-body font-weight-bold px-0">
									<i class="fa fa-user me-sm-1" aria-hidden="true"></i>
									<span class="d-sm-inline d-none">Sign Out</span>
								</a>
							</li>
							<li class="nav-item d-xl-none ps-3 d-flex align-items-center">
								<a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
									<div class="sidenav-toggler-inner">
										<i class="sidenav-toggler-line"></i>
										<i class="sidenav-toggler-line"></i>
										<i class="sidenav-toggler-line"></i>
									</div>
								</a>
							</li>
							<li class="nav-item px-3 d-flex align-items-center hidden-elem">
								<a href="javascript:;" class="nav-link text-body p-0">
									<i class="fa fa-cog fixed-plugin-button-nav cursor-pointer" aria-hidden="true"></i>
								</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
			<div class="container-fluid py-4">
				<div class="row my-4">
					<div class="col-12">
						<div class="mb-2">
							<button class="btn bg-gradient-primary mb-0 btn-outline-primary" onclick="showImportModal()">import</button>
							<button class="btn bg-gradient-primary mb-0 btn-outline-primary" onclick="showLiveModal()">live</button>
							<button id="delete-selected-videos-button" class="selected-videos-button btn btn-outline-primary mb-0 hidden-elem" data-bs-toggle="tooltip" data-bs-placement="top" title="delete" data-container="body" data-animation="true" onclick="performDeleteSelectedVideos()">
								<span class="btn-inner--icon">
									<i id="delete-selected-videos-garbage-icon" class="fas fa-trash hidden-elem"></i>
									<div id="delete-selected-videos-spinner" class="spinner-border text-primary avatar-sm spinner-sm hidden-elem" role="status"></div>
								</span>
							</button>
							<button id="finalize-selected-videos-button" class="selected-videos-button btn btn-outline-primary mb-0 hidden-elem" data-bs-toggle="tooltip" data-bs-placement="top" title="finalize" data-container="body" data-animation="true" onclick="performFinalizeSelectedVideos()">
								<span class="btn-inner--icon">
									<i id="finalize-selected-videos-garbage-icon" class="fas fa-check hidden-elem"></i>
									<div id="finalize-selected-videos-spinner" class="spinner-border text-primary avatar-sm spinner-sm hidden-elem" role="status"></div>
								</span>
							</button>
						</div>
						<div class="card">
							<div class="table-responsive">
								<table id="videos_table" class="table align-items-center">
									<thead>
										<tr>
											<th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
												<div class="form-check">
													<input class="form-check-input" type="checkbox" onclick="doSelectAllVideos(this)" id="videos-table-select-all">
												</div>
											</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Length</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Views</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Comments</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Likes / Dislikes</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Bandwidth</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Activity</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Index <a class="cursor-pointer" onclick="showIndexHelp();">(?)</a)</th>
											<th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"></th>
										</tr>
									</thead>
									<tbody>
									
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
				<div class="row align-items-center justify-content-center">
					<div class="col-auto">
						<div id="videos-scroller-loading-spinner" class="spinner-border text-primary spinner-md" role="status"></div>
					</div>
				</div>
			</div>
		</main>
		<div id="notifications-container"></div>
		<div id="notifications-container"></div>

		<script src="/javascript/popper-2.11.6.min.js"></script>
		<script src="/javascript/bootstrap-5.2.2.min.js"></script>
		<script src="/javascript/perfect-scrollbar-1.5.1.min.js"></script>
		<script src="/javascript/sweetalert-11.0.11.min.js"></script>
		<script src="/javascript/choices-9.0.1.min.js"></script>
		<script src="/javascript/soft-ui-dashboard-1.1.0.min.js"></script>
		<script src="/javascript/circle-progress-1.2.2.min.js"></script>
		<script src="/javascript/pickr-nano-theme-1.9.0.min.js"></script>
		<script>
			let NODE_PROTOCOL;
			let NODE_ADDRESS;
			let NODE_PORT;
			
			let NODE_BASE_URL;
			
			let lastUsedTag = '';
			
			let OLDEST_VISIBLE_TIMESTAMP;
			
			let VIDEOS_LOADER_INTERVAL;
			
			$(document).ready(async function() {
				const params = new URL(window.location.href).searchParams;
				const searchTerm = params.get('s');
				const tagTerm = params.get('t');
				
				if(searchTerm != null) {
					$('#search-input').val(searchTerm);
				}
				
				if(tagTerm != null) {
					$('#search-input').attr('placeholder', 'Searching ' + tagTerm + '...');
				}
				
				await getNodeInformation();
				await getReportCounts();
				
				startVideosLoaderInterval(searchTerm, 'latest', tagTerm, 10, Date.now());
				
				connectWebsocket();
			});
			
			function getNodeInformation() {
				return new Promise(function(resolve, reject) {
					$.ajax({type: 'GET', url: '/node'})
					.done(function (data, textStatus, xhr)
					{
						if(data.isError) {
							reject();
						}
						else {
							const nodeInformation = data.nodeInformation;
						
							NODE_PROTOCOL = nodeInformation.publicNodeProtocol;
							NODE_ADDRESS = nodeInformation.publicNodeAddress;
							NODE_PORT = nodeInformation.publicNodePort;
							
							NODE_BASE_URL = NODE_PROTOCOL + '://' + NODE_ADDRESS + ':' + NODE_PORT;
							
							$('#node-link').attr('href', NODE_BASE_URL);
							
							resolve();
						}
					})
					.fail(function()
					{
						console.log('unable to communicate with node');
						
						reject();
					});
				});
			}
			
			function getReportCounts() {
				return new Promise(function(resolve, reject) {
					$.ajax({type: 'GET', url: '/reports/count'})
					.done(function (data, textStatus, xhr)
					{
						if(data.isError) {
							reject();
						}
						else {
							const videoReportCount = data.videoReportCount;
							const commentReportCount = data.commentReportCount;
							const totalReportCount = data.totalReportCount;
							
							if(videoReportCount > 0) {
								$('#video-report-count').text(videoReportCount);
							}
							
							if(commentReportCount > 0) {
								$('#comment-report-count').text(commentReportCount);
							}
							
							if(totalReportCount > 0) {
								$('#total-report-count').text(totalReportCount);
							}
							
							resolve();
						}
					})
					.fail(function()
					{
						console.log('unable to communicate with node');
						
						reject();
					});
				});
			}
			
			function getVideos(searchTerm, sortTerm, tagTerm, tagLimit, timestamp) {
				return new Promise(function(resolve, reject) {
					if(searchTerm == null) {
						searchTerm = '';
					}
					
					if(tagTerm == null) {
						tagTerm = '';
					}
					
					lastUsedTag = tagTerm;
					
					let stateString = '?';
					
					if(searchTerm !== '') {
						stateString += 's=' + searchTerm;
					}
					
					if(tagTerm !== '') {
						if(stateString !== '?') {
							stateString += '&';
						}
						
						stateString += 't=' + tagTerm;
					}
					
					if(stateString !== '?') {
						window.history.replaceState({}, '', stateString);
					}
					else {
						window.history.replaceState({}, '', '/videos');
					}
					
					$.ajax({type: 'GET', url: '/videos/search', data: { searchTerm: searchTerm, sortTerm: sortTerm, tagTerm: tagTerm, tagLimit: 10, timestamp: timestamp }})
					.done(function (data, textStatus, xhr)
					{
						if(data.isError) {
							reject();
						}
						else {
							const searchResults = data.searchResults;
							
							if(searchResults.length > 0) {
								searchResults.forEach(function(row) {
									const videoId = row.video_id;
									const thumbnail = '/videos/' + videoId + '/thumbnail';
									const title = row.title;
									const tags = row.tags;
									const lengthTimestamp = row.length_timestamp;
									const views = row.views;
									const comments = row.comments;
									const likes = row.likes;
									const dislikes = row.dislikes;
									const bandwidth = row.bandwidth;
									const isIndexed = row.is_indexed;
									OLDEST_VISIBLE_TIMESTAMP = row.creation_timestamp;
									
									let status = '';
									
									if(row.is_finalized) {
										status = 'finalized';
									}
									else if(row.is_publishing) {
										status = 'publishing';
									}
									else if(row.is_published) {
										status = 'published';
									}
									else if(row.is_live) {
										if(row.is_streaming) {
											status = 'live';
										}
										else if(row.is_streamed) {
											status = 'streamed';
										}
									}
									else if(row.is_importing) {
										status = 'importing'
									}
									else if(row.is_imported) {
										status = 'imported'
									}
									else {
										status = 'error';
									}
									
									$('#videos_table tbody').append(generateVideoTableRow(videoId, thumbnail, title, tags, lengthTimestamp, views, comments, likes, dislikes, bandwidth, status, isIndexed));
								});
								
								refreshHoverTooltips();
							}
							else {
								clearInterval(VIDEOS_LOADER_INTERVAL);
								$('#videos-scroller-loading-spinner').addClass('hidden-elem');
							}
							
							resolve();
						}
					})
					.fail(function()
					{
						console.log('unable to communicate with node');
						
						reject();
					});
				});
			}
			
			async function startVideosLoaderInterval(searchTerm, sortTerm, tagTerm, tagLimit, timestamp) {
				clearInterval(VIDEOS_LOADER_INTERVAL);
				
				OLDEST_VISIBLE_TIMESTAMP = timestamp;
				
				try {
					const videosTableLoadingSpinner = $('#videos-scroller-loading-spinner');
					
					$(videosTableLoadingSpinner).removeClass('hidden-elem');
					
					await getVideos(searchTerm, sortTerm, tagTerm, tagLimit, OLDEST_VISIBLE_TIMESTAMP);
					
					let blocked = false;
					
					VIDEOS_LOADER_INTERVAL = setInterval(async function() {
						const videosTableLoadingSpinnerRect = $(videosTableLoadingSpinner)[0].getBoundingClientRect();
					
						if(videosTableLoadingSpinnerRect.top >= 0 && videosTableLoadingSpinnerRect.bottom <= (window.innerHeight || document.documentElement.clientHeight)) {
							if(!blocked) {
								blocked = true;
								await getVideos(searchTerm, sortTerm, tagTerm, tagLimit, OLDEST_VISIBLE_TIMESTAMP);
								blocked = false;
							}
						}
					}, 500);
				}
				catch(error) {
					console.log(error);
				}
			}
			
			function connectWebsocket() {
				let connectWebsocketClient = function() {
					try {
						const ws = new WebSocket('ws://localhost:8080');
						
						ws.onopen = () => {
							console.log('Connected to WebSocket server');
						};

						ws.onmessage = (message) => {
							const data = JSON.parse(message.data);
							
							if(data.eventName === 'video_status') {
								const type = data.payload.type;
								
								if(type === 'importing') {
									const videoId = data.payload.videoId;
									const progress = data.payload.progress;
									
									if($('#videos_table_row_' + videoId).length) {
										$('#videos_table_row_' + videoId).find('td').eq(6).find('span').text('importing ' + progress + '%');
									}
								}
								else if(type === 'imported') {
									const videoId = data.payload.videoId;
									const lengthTimestamp = data.payload.lengthTimestamp;
									
									if($('#videos_table_row_' + videoId).length) {
										$('#video-thumbnail-loading-spinner-' + videoId).replaceWith('<img id="video-thumbnail-' + videoId + '" src="/videos/' + videoId + '/thumbnail" class="avatar avatar-sm me-3 cursor-pointer" alt="avatar image" onclick="showThumbnailModal(\''+videoId+'\')" data-bs-toggle="tooltip" data-bs-placement="top" title="upload images" data-container="body" data-animation="true">');
										$('#videos_table_row_' + videoId).find('td').eq(1).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">' + lengthTimestamp + '</span>');
										$('#videos_table_row_' + videoId).find('td').eq(6).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">imported</span>');
										
										refreshHoverTooltips();
									}
								}
								else if(type === 'importing_stopped') {
									const videoId = data.payload.videoId;
									
									if($('#videos_table_row_' + videoId).length) {
										$('#video-thumbnail-loading-spinner-' + videoId).replaceWith('<img id="video-thumbnail-' + videoId + '" src="/videos/' + videoId + '/thumbnail" class="avatar avatar-sm me-3 cursor-pointer" alt="avatar image" />');
										$('#videos_table_row_' + videoId).find('td').eq(6).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">stopped</span>');
										
										refreshHoverTooltips();
									}
								}
								else if(type === 'publishing') {
									const videoId = data.payload.videoId;
									const format = data.payload.format;
									const resolution = data.payload.resolution;
									const progress = data.payload.progress;
									
									// updates table of imports
									if($('#videos_table_row_' + videoId).length) {
										$('#videos_table_row_' + videoId).find('td').eq(6).find('span').text('publishing');
										
										if($('#videos_table_row_' + videoId).find('td').eq(6).find('a').length === 0) {
											$('#videos_table_row_' + videoId).find('td').eq(6).append('<a class="text-danger cursor-pointer" onclick="doStopJob(this)" data-jobtype="publishing" data-videoid="' + videoId + '"><i class="fas fa-stop"></i></a>');
										}
									}
									
									// updates manage published modal
									if($('#manage-modal-published-tab-pane ' + '#' + videoId + '_' + format + '_' + resolution).length) {
										if(progress > 0) {
											$('#' + videoId + '_' + format + '_' + resolution).css('width', progress + '%');
											$('#' + videoId + '_' + format + '_' + resolution + '_manage_published_buttons').find('input').prop('checked', true);
											$('#' + videoId + '_' + format + '_' + resolution + '_manage_published_buttons').find('input').prop('disabled', true);
										}
										
										if(progress === 100) {
											setTimeout(function() {
												$('#' + videoId + '_' + format + '_' + resolution).css('width', '0%');
												$('#' + videoId + '_' + format + '_' + resolution + '_manage_published_buttons').find('input').prop('checked', true);
												$('#' + videoId + '_' + format + '_' + resolution + '_manage_published_buttons').find('input').prop('disabled', false);
											}, 1500);
										}
									}
									
									// updates publish modal
									if($('#publish-modal-table ' + '#' + videoId + '_' + format + '_' + resolution + '_publish_checkbox').length) {
										$('#' + videoId + '_' + format + '_' + resolution + '_publish_checkbox').parent().replaceWith('<div id="' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle" class="second circle" data-percent=""><strong>0%</strong></div>');
										
										$('#' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle').circleProgress({
											startAngle: -Math.PI / 2,
											value: 0 / 100,
											animation: false,
											size : 50,
											thickness: 5,
											fill: {
												color: '#cb0c9ff2'
											}
										});
									}
									else if($('#publish-modal-table ' + '#' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle').length) {
										$('#' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle').find('strong').text((progress).toFixed(0) + "%");
										
										if(progress > 0) {
											$('#' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle').circleProgress('value', progress / 100);
										}
										
										if(progress === 100) {
											$('#' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle').circleProgress('value', 1);
											
											setTimeout(function() {
												
												let recommendedSetting = '';
												
												if(format === 'm3u8' || format === 'mp4'){
													if(resolution === '1080p' || resolution === '720p' || resolution === '480p') {
														recommendedSetting = 'recommended-publish-checkbox';
													}
												}
												
												$('#' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle').replaceWith('<div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input data-format="' + format + '" data-resolution="' + resolution + '" id="' + videoId + '_' + format + '_' + resolution + '_publish_checkbox" class="form-check-input ' + recommendedSetting + ' form-check-input-is-published" type="checkbox"> </div>');
											}, 2000);
										}
									}
								}
								else if(type === 'publishing_stopped') {
									const videoId = data.payload.videoId;
									
									if($('#videos_table_row_' + videoId).length) {
										$('#videos_table_row_' + videoId).find('td').eq(6).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">stopped</span>');
									}
								}
								else if(type === 'published') {
									const videoId = data.payload.videoId;
									const lengthTimestamp = data.payload.lengthTimestamp;
									const lengthSeconds = data.payload.lengthSeconds;
									
									$('#videos_table_row_' + videoId).find('td').eq(1).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">' + lengthTimestamp + '</span>');
									$('#videos_table_row_' + videoId).find('td').eq(6).find('span').text('published');
									$('#videos_table_row_' + videoId).find('td').eq(6).find('a').remove();
								}
								else if(type === 'streaming') {
									const videoId = data.payload.videoId;
									const lengthTimestamp = data.payload.lengthTimestamp;
									const bandwidth = data.payload.bandwidth;
									
									if($('#videos_table_row_' + videoId).length) {
										$('#videos_table_row_' + videoId).find('td').eq(1).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">' + lengthTimestamp + '</span>');
										$('#videos_table_row_' + videoId).find('td').eq(5).html('<p class="text-secondary mb-0 text-sm">' + calculateBandwidthUsage_MB(bandwidth) + '</p>');
										$('#videos_table_row_' + videoId).find('td').eq(6).find('span').text('live');
									}
									
									fetch('/videos/' + videoId + '/thumbnail')
									.then(async response => {
										if (response.ok) {
											return response.blob();
										}
										else {
											throw new Error('could not retrieve stream thumbnail for video id: ' + videoId);
										}
									})
									.then(blob => {
										const objectURL = URL.createObjectURL(blob);
										
										if($('#video-thumbnail-loading-spinner-' + videoId).length) {
											$('#video-thumbnail-loading-spinner-' + videoId).replaceWith('<img id="video-thumbnail-' + videoId + '" src="' + objectURL + '" class="avatar avatar-sm me-3 cursor-pointer" alt="avatar image">');
										}
										else if($('#video-thumbnail-' + videoId).length) {
											$('#video-thumbnail-' + videoId).attr('src', objectURL);
										}
									})
									.catch(error => {
										console.log(error);
									});
								}
								else if(type === 'streaming_stopped') {
									const videoId = data.payload.videoId;
									
									if($('#videos_table_row_' + videoId).length) {
										$('#videos_table_row_' + videoId).find('td').eq(6).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">stopped</span>');
									}
									
									if($('#video-thumbnail-loading-spinner-' + videoId).length) {
										$('#video-thumbnail-loading-spinner-' + videoId).replaceWith('<img id="video-thumbnail-' + videoId + '" src="/videos/' + videoId + '/thumbnail" class="avatar avatar-sm me-3 cursor-pointer" alt="avatar image">');
									}
								}
								else if(type === 'finalized') {
									const videoId = data.payload.videoId;
									
									if($('#videos_table_row_' + videoId).length) {
										$('#videos_table_row_' + videoId).find('td').eq(6).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">finalized</span>');
									}
								}
							}
							else if(data.eventName === 'video_indexed') {
								//const videoId = data.payload.videoId;
								//const synced = data.payload.synced;
								
								
							}
							else if(data.eventName === 'video_data') {
								const videoId = data.payload.videoId;
								const thumbnail = data.payload.thumbnail;
								const title = data.payload.title;
								const tags = data.payload.tags;
								const lengthTimestamp = data.payload.lengthTimestamp;
								const views = data.payload.views;
								const comments = data.payload.comments;
								const likes = data.payload.likes;
								const dislikes = data.payload.dislikes;
								const bandwidth = data.payload.bandwidth;
								const isIndexed = data.payload.isIndexed;
								
								let status = '';
								
								if(data.payload.isFinalized) {
									status = 'finalized';
								}
								else if(data.payload.isPublishing) {
									status = 'publishing';
								}
								else if(data.payload.isPublished) {
									status = 'published';
								}
								else if(data.payload.isLive) {
									if(data.payload.isStreaming) {
										status = 'live';
									}
									else if(data.payload.isStreamed) {
										status = 'streamed';
									}
								}
								else if(data.payload.isImporting) {
									status = 'importing'
								}
								else if(data.payload.isImported) {
									status = 'imported'
								}
								else {
									status = 'error';
								}
								
								if($('#videos_table_row_' + videoId).length === 0) {
									$('#videos_table tbody').prepend(generateVideoTableRow(videoId, thumbnail, title, tags, lengthTimestamp, views, comments, likes, dislikes, bandwidth, status, isIndexed));
								}
								else {
									$('#videos_table_row_' + videoId).replaceWith(generateVideoTableRow(videoId, thumbnail, title, tags, lengthTimestamp, views, comments, likes, dislikes, bandwidth, status, isIndexed));
								}
								
								refreshHoverTooltips();
							}
						};
						
						ws.onerror = () => {
							console.log('Error connecting to WebSocket server');
						};

						ws.onclose = () => {
							console.log('Disconnected from WebSocket server');
							
							setTimeout(connectWebsocketClient, 1000);
						};
					}
					catch(error) {
						console.log(error);
					}
				};
				
				connectWebsocketClient();
			}
			
			function showImportModal() {
				let choices;
				
				const i = Swal.mixin({
					customClass: {
						confirmButton: "btn bg-gradient-success",
						cancelButton: "btn bg-gradient-danger"
					},
					buttonsStyling: !1
				});
				
				i.fire({
					title: "<strong>Import Video</strong>",
					html: '\
					<div class="input-group mb-3"><input id="importTitleInput" class="form-control" type="text" required autocomplete="off" placeholder="Title" maxlength="100"/></div> \
					<div class="input-group mb-3"><textarea id="importDescriptionInput" class="form-control" rows="5" required placeholder="Description" maxlength="5000"></textarea></div> \
					<div class="input-group mb-3"><input id="importVideoFileInput" class="form-control" type="file" required autocomplete="off" name="media_video" accept=".mp4, .webm"/></div> \
					<div class="input-group mb-3"><input id="importTagsInput" class="form-control choices__input choices__input--tags" type="text" required autocomplete="off" placeholder="Tags (press enter)" /></div><br><br>',
					showCloseButton: true,
					showCancelButton: false,
					confirmButtonText: '<i class="fa fa-thumbs-up"></i> Import!',
					confirmButtonAriaLabel: "Thumbs up",
					cancelButtonText: '<i class="fa fa-thumbs-down"></i> Cancel',
					cancelButtonAriaLabel: "Thumbs down",
					didOpen: () => {
						$('#importTitleInput').focus();
					},
					preConfirm: () => {
						const title = Swal.getPopup().querySelector('#importTitleInput').value;
						const description = Swal.getPopup().querySelector('#importDescriptionInput').value;
						const tags = choices.getValue(true);
						const videoFile = Swal.getPopup().querySelector('#importVideoFileInput').files[0];
						
						if (title.length === 0) {
							Swal.showValidationMessage('enter a title');
							return false;
						}
						else if (description.length === 0) {
							Swal.showValidationMessage('enter a description');
							return false;
						}
						else if (tags.length === 0) {
							Swal.showValidationMessage('enter at least one tag');
							return false;
						}
						else if (videoFile == null) {
							Swal.showValidationMessage('select a video file');
							return false;
						}
						
						return { title: title, description: description, videoFile: videoFile, tags: tags }
					}
				})
				.then((result) => {
					if (result.isConfirmed) {
						const title = result.value.title;
						const description = result.value.description;
						const tags = result.value.tags.join(',');
						const videoFile = result.value.videoFile;
						
						let formData = new FormData();
						
						formData.append('video_file', videoFile);

						$.ajax({type: 'POST', url: '/videos/import?title=' + title + '&description=' + description + '&tags=' + tags, data: formData, processData: false, contentType: false})
						.always(function() {
							
						})
						.done(function (data, textStatus, xhr)
						{
							if(data.isError) {
								Swal.fire({
									icon: 'error',
									title: 'hmmm',
									text: data.message
								});
							}
							else {
								showNotification('your video was successfully imported', 'alert-primary');
							}
						})
						.fail(function()
						{
							Swal.fire({
								icon: 'error',
								title: 'hmmm',
								text: '...something went wrong...'
							});
						});
					}
				});
				
				const importTagsInput = document.getElementById('importTagsInput');

				choices = new Choices(importTagsInput, {
					removeItemButton: true,
					placeholder: true,
					placeholderValue: 'Tags (press enter)',
					delimiter: ',',
					paste: true,
					duplicateItemsAllowed: false,
					shouldSort: false,
					renderChoiceLimit: -1,
					uniqueItemText: '',
					maxItemCount: 5,
					maxItemText: 'only 5 tags can be added',
					addItemFilter: (value) => {
						let result = false;
						
						let regex = /^[a-zA-Z0-9\s]*$/;
						
						if(value.length <= 30 && regex.test(value)) {
							result = true;
						}
						
						return result;
					},
					customAddItemText: 'tag length must be 30 characters or less and can contain letters, numbers, and spaces',
					classNames: {
					  containerOuter: 'choices w-100'
					}
				});
				
				importTagsInput.addEventListener('addItem', (event) => {
					console.log('Item added:', event.detail.value);
				});

				importTagsInput.addEventListener('removeItem', (event) => {
					console.log('Item removed:', event.detail.value);
				});
			}
			
			function showLiveModal() {
				let choices;
				
				const i = Swal.mixin({
					customClass: {
						confirmButton: "btn bg-gradient-success",
						cancelButton: "btn bg-gradient-danger"
					},
					buttonsStyling: !1
				});

				i.fire({
					title: "<strong>Stream Video</strong>",
					html: '\
					<div class="input-group mb-3"><input id="importTitleInput" class="form-control" type="text" required autocomplete="off" placeholder="Title"/></div> \
					<div class="input-group mb-3"><textarea id="importDescriptionInput" class="form-control" rows="5" required placeholder="Description"></textarea></div> \
					<div class="input-group mb-3"><input id="importTagsInput" class="form-control choices__input choices__input--tags" type="text" required autocomplete="off" placeholder="Tags (press enter)" /></div> \
					<div class="input-group mb-3"><input id="rtmpPortInput" class="form-control" type="text" required autocomplete="off" placeholder="RTMP port"/></div> \
					<div class="input-group mb-3"> \
						<label class="custom-control-label float-start">bind to network address</label>\
						<div class="input-group"> \
						  <select id="liveNetworkAddressSelect" name="networkAddress" class="form-control"></select> \
						</div> \
					</div> \
					<div class="input-group mb-3"> \
						<label class="custom-control-label float-start">output resolution</label>\
						<div class="input-group justify-content-center">\
							<div class="form-check mb-3"> \
							  <label class="custom-control-label" for="streamResolution2160p">2160p(4K)&nbsp&nbsp&nbsp</label>\
							  <input id="streamResolution2160p" class="form-check-input" type="radio" name="streamResolutionRadioButton" value="2160p">\
							</div>\
							<div class="form-check mb-3">\
							  <label class="custom-control-label" for="streamResolution1440p">1440p(QHD)&nbsp&nbsp&nbsp</label>\
							  <input id="streamResolution1440p" class="form-check-input" type="radio" name="streamResolutionRadioButton" value="1440p">\
							</div>\
							<div class="form-check mb-3">\
							  <label class="custom-control-label" for="streamResolution1080p">1080p(FHD)&nbsp&nbsp&nbsp</label>\
							  <input id="streamResolution1080p" class="form-check-input" type="radio" name="streamResolutionRadioButton" value="1080p">\
							</div>\
							<div class="form-check">\
							  <label class="custom-control-label" for="streamResolution720p">720p(HD)&nbsp&nbsp&nbsp</label>\
							  <input id="streamResolution720p" class="form-check-input" type="radio" name="streamResolutionRadioButton" value="720p">\
							</div>\
							<div class="form-check">\
							  <label class="custom-control-label" for="streamResolution480p">480p(SD)&nbsp&nbsp&nbsp</label>\
							  <input id="streamResolution480p" class="form-check-input" type="radio" name="streamResolutionRadioButton" value="480p">\
							</div>\
							<div class="form-check">\
							  <label class="custom-control-label" for="streamResolution360p">360p&nbsp&nbsp&nbsp</label>\
							  <input id="streamResolution360p" class="form-check-input" type="radio" name="streamResolutionRadioButton" value="360p">\
							</div>\
							<div class="form-check">\
							  <label class="custom-control-label" for="streamResolution240p">240p&nbsp&nbsp&nbsp</label>\
							  <input id="streamResolution240p" class="form-check-input" type="radio" name="streamResolutionRadioButton" value="240p">\
							</div>\
						</div>\
					</div>\
					<div class="input-group mb-3">\
						<label class="custom-control-label">record stream remotely</label>\
						<div class="input-group form-switch">\
							<input id="recordStreamRemotelyCheckbox" class="form-check-input" type="checkbox" style="height: 1.10em;"/>\
						</div>\
					</div>\
					<div class="input-group mb-3">\
						<label class="custom-control-label">record stream locally</label>\
						<div class="input-group form-switch">\
							<input id="recordStreamLocallyCheckbox" class="form-check-input" type="checkbox" style="height: 1.10em;"/>\
						</div>\
					</div>',
					showCloseButton: true,
					showCancelButton: false,
					confirmButtonText: '<i class="fa fa-thumbs-up"></i> Stream!',
					confirmButtonAriaLabel: "Thumbs up",
					cancelButtonText: '<i class="fa fa-thumbs-down"></i> Cancel',
					cancelButtonAriaLabel: "Thumbs down",
					willOpen: () => {
						const importTagsInput = document.getElementById('importTagsInput');
						
						choices = new Choices(importTagsInput, {
							removeItemButton: true,
							placeholder: true,
							placeholderValue: 'Tags (press enter)',
							delimiter: ',',
							paste: true,
							duplicateItemsAllowed: false,
							shouldSort: false,
							renderChoiceLimit: -1,
							uniqueItemText: '',
							maxItemCount: 5,
							maxItemText: 'only 5 tags can be added',
							addItemFilter: (value) => {
								let result = false;
								
								let regex = /^[a-zA-Z0-9\s]*$/;
								
								if(value.length <= 30 && regex.test(value)) {
									result = true;
								}
								
								return result;
							},
							customAddItemText: 'tag length must be 30 characters or less and can contain letters, numbers, and spaces',
							classNames: {
							  containerOuter: 'choices w-100'
							}
						});
						
						importTagsInput.addEventListener('addItem', (event) => {
							console.log('Item added:', event.detail.value);
						});

						importTagsInput.addEventListener('removeItem', (event) => {
							console.log('Item removed:', event.detail.value);
						});
						
						$.ajax({type: 'GET', url: '/network'})
						.done(function (data, textStatus, xhr)
						{
							if(data.isError) {
								alert(data.messages);
							}
							else {
								const networkAddresses = data.networkAddresses;
								
								for(const networkAddress of networkAddresses) {
									$('#liveNetworkAddressSelect').append('<option value="' + networkAddress + '">' + networkAddress + '</option>');
								}
							}
						})
						.fail(function()
						{
							console.log('unable to communicate with node');
						});
					},
					didOpen: () => {
						$('#importTitleInput').focus();
					},
					preConfirm: () => {
						const title = Swal.getPopup().querySelector('#importTitleInput').value;
						const description = Swal.getPopup().querySelector('#importDescriptionInput').value;
						const tags = choices.getValue(true);
						const rtmpPort = Swal.getPopup().querySelector('#rtmpPortInput').value;
						const isRecordingStreamRemotely = Swal.getPopup().querySelector('#recordStreamRemotelyCheckbox').checked;
						const isRecordingStreamLocally = Swal.getPopup().querySelector('#recordStreamLocallyCheckbox').checked;
						const networkAddress = Swal.getPopup().querySelector('#liveNetworkAddressSelect').value;
						
						let resolution = '';
						
						const radioButtons = Swal.getPopup().querySelectorAll('input[name="streamResolutionRadioButton"]');
						radioButtons.forEach(streamResolutionRadioButton => {
							if (streamResolutionRadioButton.checked) {
								resolution = streamResolutionRadioButton.value;
							}
						});
						
						if (title === '') {
							Swal.showValidationMessage('enter a title');
							return false;
						}
						else if (description === '') {
							Swal.showValidationMessage('enter a description');
							return false;
						}
						else if (tags.length === 0) {
							Swal.showValidationMessage('enter at least one tag');
							return false;
						}
						else if (rtmpPort === '') {
							Swal.showValidationMessage('enter an rtmp port');
							return false;
						}
						else if (resolution === '') {
							Swal.showValidationMessage('select a stream resolution');
							return false;
						}
						
						return { title: title, description: description, tags: tags, rtmpPort: rtmpPort, resolution: resolution, isRecordingStreamRemotely: isRecordingStreamRemotely, isRecordingStreamLocally: isRecordingStreamLocally, networkAddress: networkAddress }
					}
				})
				.then((result) => {
					if (result.isConfirmed) {
						const title = result.value.title;
						const description = result.value.description;
						const tags = result.value.tags.join(',');
						const rtmpPort = result.value.rtmpPort;
						const resolution = result.value.resolution;
						const isRecordingStreamRemotely = result.value.isRecordingStreamRemotely;
						const isRecordingStreamLocally = result.value.isRecordingStreamLocally;
						const networkAddress = result.value.networkAddress;
						
						$.ajax({type: 'POST', url: '/streams/start', data: JSON.stringify({ title: title, description: description, tags: tags, rtmpPort: rtmpPort, resolution: resolution, isRecordingStreamRemotely: isRecordingStreamRemotely, isRecordingStreamLocally: isRecordingStreamLocally, networkAddress: networkAddress }), contentType: 'application/json; charset=utf-8'})
						.always(function() {
							
						})
						.done(function (data, textStatus, xhr)
						{
							if(data.isError) {
								alert(data.message);
							}
							else {
								
							}
						})
						.fail(function()
						{
							alert('video file import error occurred');
						});
					}
				});
			}
			
			function showPublishWizardModal(videoId) {
				const i = Swal.mixin({
					customClass: {
						confirmButton: "btn bg-gradient-success",
						cancelButton: "btn bg-gradient-danger"
					},
					buttonsStyling: !1
				});
				
				i.fire({
					title: "<strong>Publish</strong>",
					html: '<div class="mt-4" id="notifications"> <div class="card-body pt-0"> <div class="table-responsive"> \
					<table id="publish-modal-table" class="table mb-0"> \
					<thead> \
					<tr> <th class="ps-1" colspan="4">  </th> <th class="text-center"> <p class="mb-0">2160p</p> </th> <th class="text-center"> <p class="mb-0">1440p</p> </th> <th class="text-center"> <p class="mb-0">1080p</p> </th> <th class="text-center"> <p class="mb-0">720p</p> </th> <th class="text-center"> <p class="mb-0">480p</p> </th><th class="text-center"> <p class="mb-0">360p</p> </th><th class="text-center"> <p class="mb-0">240p</p> </th> \
					</tr> \
					</thead> \
					<tbody> \
					<tr class="publish-modal-table-row"> <td class="ps-1 align-middle" colspan="4"> <div class="my-auto"> \
					<span class="text-dark d-block text-sm">HLS</span>  </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_2160p_publish_checkbox" data-format="m3u8" data-resolution="2160p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_1440p_publish_checkbox" data-format="m3u8" data-resolution="1440p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_1080p_publish_checkbox" data-format="m3u8" data-resolution="1080p" class="form-check-input recommended-publish-checkbox" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_720p_publish_checkbox" data-format="m3u8" data-resolution="720p" class="form-check-input recommended-publish-checkbox" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_480p_publish_checkbox" data-format="m3u8" data-resolution="480p" class="form-check-input recommended-publish-checkbox" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_360p_publish_checkbox" data-format="m3u8" data-resolution="360p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_240p_publish_checkbox" data-format="m3u8" data-resolution="240p" class="form-check-input" type="checkbox"> </div> </td> \
					</tr> \
					<tr class="publish-modal-table-row"> \
					<td class="ps-1 align-middle" colspan="4"> <div class="my-auto"> <span class="text-dark d-block text-sm">MP4</span> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_2160p_publish_checkbox" data-format="mp4" data-resolution="2160p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_1440p_publish_checkbox" data-format="mp4" data-resolution="1440p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_1080p_publish_checkbox" data-format="mp4" data-resolution="1080p" class="form-check-input recommended-publish-checkbox" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_720p_publish_checkbox" data-format="mp4" data-resolution="720p" class="form-check-input recommended-publish-checkbox" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_480p_publish_checkbox" data-format="mp4" data-resolution="480p" class="form-check-input recommended-publish-checkbox" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_360p_publish_checkbox" data-format="mp4" data-resolution="360p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_240p_publish_checkbox" data-format="mp4" data-resolution="240p" class="form-check-input" type="checkbox"> </div> </td> \
					</tr> \
					<tr class="publish-modal-table-row"> \
					<td class="ps-1 align-middle" colspan="4"> <div class="my-auto"> <span class="text-dark d-block text-sm">WEBM</span>  </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_2160p_publish_checkbox" data-format="webm" data-resolution="2160p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_1440p_publish_checkbox" data-format="webm" data-resolution="1440p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_1080p_publish_checkbox" data-format="webm" data-resolution="1080p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_720p_publish_checkbox" data-format="webm" data-resolution="720p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_480p_publish_checkbox" data-format="webm" data-resolution="480p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_360p_publish_checkbox" data-format="webm" data-resolution="360p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_240p_publish_checkbox" data-format="webm" data-resolution="240p" class="form-check-input" type="checkbox"> </div> </td> \
					</tr> \
					<tr class="publish-modal-table-row"> \
					<td class="ps-1 align-middle" colspan="4"> <div class="my-auto"> <span class="text-dark d-block text-sm">OGV</span></div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_2160p_publish_checkbox" data-format="ogv" data-resolution="2160p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_1440p_publish_checkbox" data-format="ogv" data-resolution="1440p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_1080p_publish_checkbox" data-format="ogv" data-resolution="1080p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_720p_publish_checkbox" data-format="ogv" data-resolution="720p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_480p_publish_checkbox" data-format="ogv" data-resolution="480p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_360p_publish_checkbox" data-format="ogv" data-resolution="360p" class="form-check-input" type="checkbox"> </div> </td> \
					<td class="align-middle"> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_240p_publish_checkbox" data-format="ogv" data-resolution="240p" class="form-check-input" type="checkbox"> </div> </td> \
					</tr> \
					</tbody> \
					</table> </div> </div> </div>',
					footer: '<a id="publish-modal-recommended-settings" class="cursor-pointer">click here for recommended settings</a>',
					willOpen: () => {
						$.ajax({type: 'GET', url: '/videos/' + videoId + '/publishes'})
						.done(function (data, textStatus, xhr)
						{
							if(data.isError) {
								alert(data.messages);
							}
							else {
								const publishes = data.publishes;
								
								for(publish of publishes) {
									const format = publish.format;
									const resolution = publish.resolution;
									const isPublished = publish.isPublished;
									
									if(isPublished) {
										$('#publish-modal-table tbody tr td #' + videoId + '_' + format + '_' + resolution + '_publish_checkbox').addClass('form-check-input-is-published');
									}
								}
							}
						})
						.fail(function()
						{
							console.log('unable to communicate with node');
						});
						
						$('#publish-modal-recommended-settings').click(function() {
							let isChecked = false;
							
							$('#publish-modal-table input:checkbox').each(function () {
								if($(this).prop('checked')) {
									isChecked = true;
								}
							});
							
							$('#publish-modal-table input:checkbox:not(.recommended-publish-checkbox)').prop('checked', false);
							$('.recommended-publish-checkbox').prop('checked', true);
						});
					},
					showCloseButton: true,
					showCancelButton: false,
					confirmButtonText: '<i class="fa fa-cloud-upload"></i> Publish!',
					confirmButtonAriaLabel: "Thumbs up",
					preConfirm: () => {
						const publishings = [];
						
						$('#publish-modal-table input:checkbox:checked').each(function () {
							const format = $(this).data('format');
							const resolution = $(this).data('resolution');
							
							publishings.push({format: format, resolution: resolution, checkboxParentContainer: $(this).parent()});
						});
						
						for(publishing of publishings) {
							const format = publishing.format;
							const resolution = publishing.resolution;
							const checkboxParentContainer = publishing.checkboxParentContainer;
							
							const progressCircle = $('<div id="' + videoId + '_' + format + '_' + resolution + '_publish_progress_circle" class="second circle publish-progress-circle" data-percent="0"><strong>0%</strong></div>');
							
							$(checkboxParentContainer).replaceWith(progressCircle);
						}
						
						$('#publish-modal-table .publish-modal-table-row').find('.circle').circleProgress({
							startAngle: -Math.PI / 2,
							value: 0 / 100,
							animation: false,
							size : 50,
							thickness: 5,
							fill: {
								color: '#cb0c9ff2'
							}
						});
						
						$.ajax({type: 'POST', url: '/videos/' + videoId + '/publish', data: {publishings: JSON.stringify(publishings)}})
						.always(function() {
							Swal.enableButtons();
						})
						.done(function (data, textStatus, xhr) {
							if(data.isError) {
								Swal.fire({
									icon: 'info',
									title: 'hmmm',
									text: data.message
								});
							}
							else {
								
							}
						})
						.fail(function() {
							alert('video publish error occurred');
						});
						
						return false;
					}
				})
				.then((result) => {
					if (result.isConfirmed) {
						
					}
				});
			}
			
			
			
			




			
			function showShareModal(videoId) {
				Swal.fire({
					title: '...preparing to share video...',
					html: '',
					showConfirmButton: false,
					showCloseButton: true,
					showCancelButton: false,
					willOpen: () => {
						const nodeVideoUrl = NODE_BASE_URL + '/watch?v=' + videoId
						
						$.ajax({type: 'GET', url: '/videos/' + videoId + '/information'})
						.done(function (data, textStatus, xhr) {
							const information = data.information;
							
							const title = information.title;
							
							$.ajax({type: 'GET', url: '/videos/' + videoId + '/alias'})
							.done(function (data, textStatus, xhr) {
								let videoAliasUrl = 'MoarTube Aliaser link unavailable';

								if(data.isError) {
									showShareLinks(videoId, nodeVideoUrl, data.message);
								}
								else {
									videoAliasUrl = data.videoAliasUrl;
									
									if(videoAliasUrl === '') {
										getCaptcha('/alias/captcha')
										.then((objectURL) => {
											const html = '<div id="alias-captcha-container"><div id="alias-captcha-img-container"><img src="' + objectURL + '"></div>\
											<div class="input-group mt-2"><input id="alias-captcha-input" class="form-control" type="text" placeholder="enter the captcha"></div>\
											<div><button id="alias-captcha-submit" class="btn btn-primary mt-2">create share links</button></div></div>';
											
											Swal.update({
												title: 'Share',
												html: html
											});
											
											$('#alias-captcha-input').focus();
											
											$('#alias-captcha-submit').click(function(event) {
												const captchaResponse = $('#alias-captcha-input').val();
												
												$('#alias-captcha-input').attr('disabled', true);
												$('#alias-captcha-submit').attr('disabled', true);
												
												$.ajax({type: 'POST', url: '/videos/' + videoId + '/alias', data: { captchaResponse: captchaResponse }})
												.always(function() {
													$('#alias-captcha-input').attr('disabled', false);
													$('#alias-captcha-submit').attr('disabled', false);
												})
												.done(function (data, textStatus, xhr) {
													if(data.isError) {
														if(data.message === 'the captcha was not correct') {
															getCaptcha('/alias/captcha')
															.then((objectURL) => {
																$('#alias-captcha-img-container').html('<img src="' + objectURL + '">');
																$('#alias-captcha-input').val('');
															})
															.catch(error => {
																$('#report-error-message').text(error);
															});
														}
													}
													else {
														const videoAliasUrl = data.videoAliasUrl;
														
														showShareLinks(videoId, nodeVideoUrl, videoAliasUrl);
													}
												})
												.fail(function() {
													showShareLinks(videoId, nodeVideoUrl, videoAliasUrl);
												});
											});
										})
										.catch(error => {
											showShareLinks(videoId, nodeVideoUrl, videoAliasUrl);
										});
									}
									else {
										showShareLinks(videoId, nodeVideoUrl, videoAliasUrl);
									}
								}
								
								function showShareLinks(videoId, nodeVideoUrl, videoAliasUrl) {
									const embedUrl = NODE_BASE_URL + '/embed/video/' + videoId + '?autostart=1';
									const embedHtml = '<iframe width="560" height="315" src="' + embedUrl + '" title="MoarTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>';
									
									const embedSVG = '<svg viewBox="0 0 36 36" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;"><circle cx="18" cy="18" r="17.5" stroke="#E7E7E7" fill="#F4F4F4" stroke-width=".5"></circle><path d="m21.41,23.29l-0.71,-0.71l4.59,-4.58l-4.59,-4.59l0.71,-0.71l5.3,5.3l-5.3,5.29zm-6.12,-0.7l-4.58,-4.59l4.59,-4.59l-0.71,-0.7l-5.3,5.29l5.29,5.29l0.71,-0.7z" fill="#606060"></path></svg>';
									const twitterSVG = '<svg viewBox="0 0 60 60" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g fill="none" fill-rule="evenodd"><path d="M28.486325 59.969298c-6.636404-.569063-11.56302-2.326956-16.321973-5.823932C4.443764 48.472116 0 39.646792 0 29.986934 0 15.11156 10.506778 2.798388 25.274412.36718c6.028107-.992411 12.703853.049265 18.28794 2.85363 13.576275 6.818095 19.7813 22.541053 14.64267 37.103159-3.527955 9.997705-12.789708 17.617785-23.391072 19.244938-2.085625.320112-5.065149.508645-6.327625.400391z" fill="#1DA1F2" fill-rule="nonzero"></path><path d="M45.089067 17.577067c-.929778.595555-3.064534 1.460977-4.117334 1.460977v.001778C39.7696 17.784 38.077156 17 36.200178 17c-3.645511 0-6.6016 2.956089-6.6016 6.600178 0 .50631.058666 1.000178.16711 1.473778h-.001066c-4.945066-.129778-10.353422-2.608356-13.609244-6.85049-2.001778 3.46489-.269511 7.3184 2.002133 8.72249-.7776.058666-2.209067-.0896-2.882844-.747023-.045156 2.299734 1.060622 5.346845 5.092622 6.452267-.776533.417778-2.151111.297956-2.7488.209067.209778 1.941333 2.928355 4.479289 5.901155 4.479289C22.46009 38.565156 18.4736 40.788089 14 40.080889 17.038222 41.929422 20.5792 43 24.327111 43c10.650667 0 18.921956-8.631822 18.4768-19.280356-.001778-.011733-.001778-.023466-.002844-.036266.001066-.027378.002844-.054756.002844-.0832 0-.033067-.002844-.064356-.003911-.096356.9696-.66311 2.270578-1.836089 3.2-3.37991-.539022.296888-2.156089.891377-3.6608 1.038932.965689-.521244 2.396444-2.228266 2.749867-3.585777" fill="#FFF"></path></g></svg>';
									const redditSVG = '<svg viewBox="0 0 60 60" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g fill-rule="nonzero" fill="none"><path d="M28.4863253 59.9692983c-6.6364044-.569063-11.5630204-2.3269561-16.3219736-5.8239327C4.44376366 48.4721168 3e-7 39.6467924 3e-7 29.9869344c0-14.8753747 10.506778-27.18854591 25.2744118-29.61975392 6.0281072-.9924119 12.7038532.04926445 18.2879399 2.85362966C57.1386273 10.0389054 63.3436516 25.7618627 58.2050229 40.3239688 54.677067 50.3216743 45.4153135 57.9417536 34.81395 59.5689067c-2.0856252.3201125-5.0651487.5086456-6.3276247.4003916z" fill="#FF4500"></path><path d="M34.1335847 43.9991814c1.6336774-.3831682 2.81654-.7939438 3.9781753-1.3815065 3.6153903-1.8286959 5.8788354-4.8645264 5.8788354-7.8849481 0-.9131088.0196207-.9556355.780668-1.6923265.6040409-.5847092.8404012-.962515 1.044679-1.6698428.2433185-.8425206.2441028-.9826228.0100139-1.7878614-.6566532-2.2588075-3.0054252-3.2764371-5.1075029-2.212882l-.8124519.4110627-.837264-.5151716c-1.6101652-.9907471-4.473974-1.96108051-6.3205111-2.14155924-.5059537-.04945042-1.143803-.1235464-1.4174535-.16465815l-.4975382-.07474783.2136595-1.06953332c.1175125-.5882423.3623778-1.7491883.5441475-2.57987956.181767-.83069153.4095191-1.95749071.5061138-2.50399817.1396137-.78991765.2348596-.99365031.4645331-.99365031.1589005 0 1.2955101.21462853 2.5257988.4769522 1.2302915.26232367 2.2622022.47695193 2.293134.47695193.0309345 0 .1003234.23497925.154203.52217616.1363137.72661143.4902897 1.17780487 1.2134714 1.54674469 1.7356128.8854428 3.6891485-.29431302 3.6891485-2.22790474 0-2.3956262-2.9538443-3.44186625-4.4550019-1.57794377-.2901205.36022881-.4356746.42625561-.7154284.32453216-.1931649-.07023833-1.5202546-.3669593-2.9490951-.65938053-1.8923676-.38728585-2.6686067-.48706487-2.8582979-.36740978-.2896185.1826864-.2522224.047706-1.0501419 3.79055007-.9490696 4.45187338-1.0064011 4.70400786-1.0882029 4.78580828-.0432388.04324046-.729551.14596475-1.5251367.22827402-2.413687.24971784-5.06621906 1.10194849-6.8544721 2.20227189l-.8268564.5087695-.81204644-.4046587c-2.11972653-1.0563058-4.47243958-.0382468-5.1287215 2.2192841-.23408885.8052386-.23330375.9453408.0100166 1.7878614.20427624.7073278.44063816 1.0851336 1.04467744 1.6698428.76105187.736691.78066878.7792177.78066878 1.6923265 0 4.172347 4.28816886 8.1540991 10.01599352 9.3002929 1.8975637.3797217 2.0263168.3894072 4.4515526.3349143 1.5849893-.0356103 2.7274992-.1508298 3.6566327-.3687526zm-6.6864685-3.0300366c-1.3154638-.2961613-2.8032079-.9569232-3.2391341-1.4386156-.34760429-.384099-.198986-.9659493.246724-.9659493.1736296 0 .5801788.1805458.9034441.4012095 2.1828306 1.4900284 7.1085991 1.484628 9.2987021-.0101767.7054363-.4814861 1.2827246-.468194 1.3538857.0311679.0334854.234998-.1164569.4687666-.4771278.7438635-1.7511846 1.3356924-5.2646974 1.8738181-8.086494 1.2385197v-.000019zm-4.01196195-5.9075609c-.81902983-.4443886-1.22403999-1.1532958-1.22477787-2.143771-.000787-1.135302.52653614-1.8699603 1.59778946-2.2257735.76240766-.253232.85344696-.2532238 1.51689516.0001492 1.785415.6818561 2.1507834 2.909296.6724678 4.0996229-.7705198.6204159-1.7299516.7214286-2.56237455.2697724zm11.09588945.0732995c-.7590038-.3947507-1.1832989-.8746601-1.3628596-1.5414995-.3321829-1.2336253.2931784-2.4377233 1.5067529-2.9011953.6634485-.253373.754488-.2533812 1.5168976-.0001492 1.0712525.3558132 1.5986343 1.0904715 1.5977903 2.2257735-.0008141 1.0085002-.4138259 1.7116813-1.2587076 2.1427072-.7599699.3877084-1.3548626.4098285-1.9998736.0743633z" fill="#FDFDFD"></path></g></svg>';
									const facebookSVG = '<svg viewBox="0 0 60 60" focusable="false" style="pointer-events: none; display: block; width: 100%; height: 100%;"><g fill="none" fill-rule="evenodd"><path d="M28.4863253 59.9692983c-6.6364044-.569063-11.5630204-2.3269561-16.3219736-5.8239327C4.44376366 48.4721168 3e-7 39.6467924 3e-7 29.9869344c0-14.8753747 10.506778-27.18854591 25.2744118-29.61975392 6.0281072-.9924119 12.7038532.04926445 18.2879399 2.85362966C57.1386273 10.0389054 63.3436516 25.7618627 58.2050229 40.3239688 54.677067 50.3216743 45.4153135 57.9417536 34.81395 59.5689067c-2.0856252.3201125-5.0651487.5086456-6.3276247.4003916z" fill="#3B5998" fill-rule="nonzero"></path><path d="M25.7305108 45h5.4583577V30.0073333h4.0947673l.8098295-4.6846666h-4.9045968V21.928c0-1.0943333.7076019-2.2433333 1.7188899-2.2433333h2.7874519V15h-3.4161354v.021c-5.3451414.194-6.4433395 3.2896667-6.5385744 6.5413333h-.0099897v3.7603334H23v4.6846666h2.7305108V45z" fill="#FFF"></path></g></svg>';

									let twitterLink;
									let redditLink;
									let facebookLink;
									
									if(videoAliasUrl === 'MoarTube Aliaser link unavailable') {
										twitterLink = 'https://twitter.com/intent/tweet?url=' + nodeVideoUrl + '&text=' + title + '&via=MoarTubes&related=MoarTubes';
										redditLink = 'https://www.reddit.com/submit?url=' + nodeVideoUrl + '&title=' + title;
										facebookLink = 'https://www.facebook.com/dialog/share?app_id=246871938290679&href=' + nodeVideoUrl + '&display=popup';
									}
									else {
										twitterLink = 'https://twitter.com/intent/tweet?url=' + videoAliasUrl + '&text=' + title + '&via=MoarTubes&related=MoarTubes';
										redditLink = 'https://www.reddit.com/submit?url=' + videoAliasUrl + '&title=' + title;
										facebookLink = 'https://www.facebook.com/dialog/share?app_id=246871938290679&href=' + videoAliasUrl + '&display=popup';
									}
									
									const html = $('<div class="share-icon-container"><a href="' + twitterLink + '" target="_blank"><button class="share-icon-button"><div class="share-icon-svg">' + twitterSVG + '</div><div class="share-icon-title">Twitter</div></button></a></div>\
											<div class="share-icon-container"><a href="' + redditLink + '" target="_blank"><button class="share-icon-button"><div class="share-icon-svg">' + redditSVG + '</div><div class="share-icon-title">Reddit</div></button></a></div>\
											<div class="share-icon-container"><a href="' + facebookLink + '" target="_blank"><button class="share-icon-button"><div class="share-icon-svg">' + facebookSVG + '</div><div class="share-icon-title">Facebook</div></button></a></div>\
											<div>' + embedHtml + '</div>\
											<div class="input-group"><input id="node-video-url-input" class="form-control me-1" type="text" value="' + nodeVideoUrl + '" disabled><span class="input-group-btn"><button id="node-video-url-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="copied!" data-bs-container="body" data-bs-animation="false">copy</button></span></div>\
											<div class="input-group mt-1"><input id="moartube-video-alias-url-input" class="form-control me-1" type="text" value="' + videoAliasUrl + '" disabled><span class="input-group-btn"><button id="moartube-video-alias-url-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="copied!" data-bs-container="body" data-bs-animation="false">copy</button></span></div>\
											<div class="input-group mt-1"><input id="video-alias-embed-url-input" class="form-control me-1" type="text" value="" disabled><span class="input-group-btn"><button id="video-alias-embed-url-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="copied!" data-bs-container="body" data-bs-animation="false">copy</button></span></div>\
											<div class="input-group mt-1"><input id="video-alias-embed-code-input" class="form-control me-1" type="text" value="" disabled><span class="input-group-btn"><button id="video-alias-embed-code-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="copied!" data-bs-container="body" data-bs-animation="false">copy</button></span></div>');
									
									$(html).find('#video-alias-embed-url-input').val(embedUrl);
									$(html).find('#video-alias-embed-code-input').val(embedHtml);
									
									Swal.update({
										title: 'Share',
										html: html
									});
									
									$('#video-alias-embed-url-copy-button').click(function(event) {
										const value = $('#video-alias-embed-url-input').val();
										
										setClipboard(value);
									});
									
									$('#video-alias-embed-code-copy-button').click(function(event) {
										const value = $('#video-alias-embed-code-input').val();
										
										setClipboard(value);
									});
									
									$('#moartube-video-alias-url-copy-button').click(function(event) {
										const value = $('#moartube-video-alias-url-input').val();
										
										setClipboard(value);
									});
									
									$('#node-video-url-copy-button').click(function(event) {
										const value = $('#node-video-url-input').val();
										
										setClipboard(value);
									});
									
									if(videoAliasUrl === 'MoarTube Aliaser link unavailable') {
										$(html).find('#moartube-video-alias-url-copy-button').addClass('hidden-elem');
									}
									
									refreshClickTooltips();
								}
							})
							.fail(function()
							{
								console.log('unable to communicate with node');
							});
						})
						.fail(function()
						{
							console.log('unable to communicate with node');
						});
					},
					didOpen: () => {
						Swal.showLoading();
					}
				});
			}
			
			function showManageImportModal(videoId) {
				let choices;
			
				const i = Swal.mixin({
					customClass: {
						confirmButton: "btn bg-gradient-success mt-4",
						cancelButton: "btn bg-gradient-danger mt-4"
					},
					buttonsStyling: !1
				});
				
				i.fire({
					title: "<strong>Manage</strong>",
					html: '<div class="col-xl-12" style="max-width:454px;"> <div class=""> <div class="card-header d-flex pb-0 p-3">\
					<div class="nav-wrapper position-relative w-100"> \
					<ul class="nav nav-pills nav-fill p-1" role="tablist"> \
					<li class="nav-item moving-tab-selector-1" role="presentation" data-type="information"> <a class="nav-link mb-0 px-0 py-1 active" data-bs-toggle="tab" href="#cam1" role="tab" aria-controls="cam1" aria-selected="false"> Information </a> </li> \
					<li class="nav-item moving-tab-selector-1" role="presentation" data-type="published"> <a class="nav-link mb-0 px-0 py-1" data-bs-toggle="tab" href="#manage-modal-published-tab-pane" role="tab" aria-controls="manage-modal-published-tab-pane" aria-selected="false" tabindex="-1"> published </a> </li> \
					<div class="moving-tab moving-tab-1 position-absolute nav-link" style="padding: 0px;width: 50%;ransform: translate3d(0px, 0px, 0px);transition: all 0.5s ease 0s;" aria-selected="false" tabindex="-1" role="tab">\
					<a class="nav-link mb-0 px-0 py-1 active" data-bs-toggle="tab" href="#cam1" role="tab" aria-controls="cam1" aria-selected="true">-</a></div>\
					</ul> \
					</div> </div> <div class="card-body p-3 mt-2"> <div class="tab-content"> \
					<div class="tab-pane fade position-relative border-radius-lg active show text-start" id="cam1" role="tabpanel" aria-labelledby="cam1"> \
						<label class="form-label">Title</label>\
						<div class="input-group mb-3"><input id="importTitleInput" class="form-control" type="text" required autocomplete="off" placeholder="Title" value=""/></div> \
						<label class="form-label">Description</label>\
						<div class="input-group mb-3"><textarea id="importDescriptionInput" class="form-control" rows="11" required placeholder="Description"></textarea></div> \
						<label class="form-label">Tags</label>\
						<div class="input-group mb-3"><input id="importTagsInput" class="form-control choices__input choices__input--tags w-100" type="text" value="" required autocomplete="off" placeholder="Tags (press enter)" /></div> \
					</div>\
					<div id="manage-modal-published-tab-pane" class="tab-pane fade position-relative border-radius-lg" role="tabpanel" aria-labelledby="manage-modal-published-tab-pane"> <div class="card-header d-flex pb-0 p-3"><div class="nav-wrapper position-relative w-100"> \
						<ul class="nav nav-pills nav-fill p-1" role="tablist"> \
						<li class="nav-item moving-tab-selector-2" role="presentation" data-format="m3u8"> <a class="nav-link mb-0 px-0 py-1 active" data-bs-toggle="tab" href="#cam3" role="tab" aria-controls="cam3" aria-selected="false" tabindex="-1"> HLS </a> </li> \
						<li class="nav-item moving-tab-selector-2" role="presentation" data-format="mp4"> <a class="nav-link mb-0 px-0 py-1" data-bs-toggle="tab" href="#cam4" role="tab" aria-controls="cam4" aria-selected="false"> MP4 </a> </li> \
						<li class="nav-item moving-tab-selector-2" role="presentation" data-format="webm"> <a class="nav-link mb-0 px-0 py-1" data-bs-toggle="tab" href="#cam5" role="tab" aria-controls="cam5" aria-selected="false"> WEBM </a> </li> \
						<li class="nav-item moving-tab-selector-2" role="presentation" data-format="ogv"> <a class="nav-link mb-0 px-0 py-1" data-bs-toggle="tab" href="#cam6" role="tab" aria-controls="cam6" aria-selected="false"> OGV </a> </li> \
						<div class="moving-tab moving-tab-2 position-absolute nav-link" style="padding: 0px; width: 22%; transition: all 0.5s ease 0s; transform: translate3d(0px, 0px, 0px);" aria-selected="false" tabindex="-1" role="tab">\
						<a class="nav-link mb-0 px-0 py-1 active" data-bs-toggle="tab" href="#cam1" role="tab" aria-controls="cam1" aria-selected="false">-</a>\
						</div>\
					</ul></div> </div> <div class="card-body p-3 mt-2"> <div class="tab-content">\
					<div class="tab-pane fade position-relative height-700 border-radius-lg active show" id="cam3" role="tabpanel" aria-labelledby="cam3">\
					<ul class="list-group">\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">2160p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_m3u8_2160p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div id="' + videoId + '_m3u8_2160p_manage_published_buttons"><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_2160p_publish_checkbox" data-format="m3u8" data-resolution="2160p" class="form-check-input form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1440p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_m3u8_1440p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div id="' + videoId + '_m3u8_1440p_manage_published_buttons"><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_1440p_publish_checkbox" data-format="m3u8" data-resolution="1440p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1080p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_m3u8_1080p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div id="' + videoId + '_m3u8_1080p_manage_published_buttons"><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_1080p_publish_checkbox" data-format="m3u8" data-resolution="1080p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">720p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_m3u8_720p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div id="' + videoId + '_m3u8_720p_manage_published_buttons"><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_720p_publish_checkbox" data-format="m3u8" data-resolution="720p" class="form-check-input" type="checkbox"></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">480p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_m3u8_480p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div id="' + videoId + '_m3u8_480p_manage_published_buttons"><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_480p_publish_checkbox" data-format="m3u8" data-resolution="480p" class="form-check-input" type="checkbox"></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">360p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_m3u8_360p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div id="' + videoId + '_m3u8_360p_manage_published_buttons"><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_360p_publish_checkbox" data-format="m3u8" data-resolution="360p" class="form-check-input" type="checkbox"></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">240p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_m3u8_240p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div id="' + videoId + '_m3u8_240p_manage_published_buttons"><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_m3u8_240p_publish_checkbox" data-format="m3u8" data-resolution="240p" class="form-check-input" type="checkbox"></div> </div> </li>\
					</ul>\
					</div>\
					<div class="tab-pane fade position-relative height-700 border-radius-lg" id="cam4" role="tabpanel" aria-labelledby="cam4">\
					<ul class="list-group">\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">2160p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_mp4_2160p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_2160p_publish_checkbox" data-format="mp4" data-resolution="2160p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1440p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_mp4_1440p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_1440p_publish_checkbox" data-format="mp4" data-resolution="1440p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1080p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_mp4_1080p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_1080p_publish_checkbox" data-format="mp4" data-resolution="1080p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">720p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_mp4_720p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_720p_publish_checkbox" data-format="mp4" data-resolution="720p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">480p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_mp4_480p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_480p_publish_checkbox" data-format="mp4" data-resolution="480p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">360p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_mp4_360p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_360p_publish_checkbox" data-format="mp4" data-resolution="360p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">240p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_mp4_240p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_mp4_240p_publish_checkbox" data-format="mp4" data-resolution="240p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					</ul>\
					</div>\
					<div class="tab-pane fade position-relative height-700 border-radius-lg" id="cam5" role="tabpanel" aria-labelledby="cam5">\
					<ul class="list-group">\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">2160p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_webm_2160p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_2160p_publish_checkbox" data-format="webm" data-resolution="2160p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1440p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_webm_1440p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_1440p_publish_checkbox" data-format="webm" data-resolution="1440p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1080p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_webm_1080p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_1080p_publish_checkbox" data-format="webm" data-resolution="1080p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">720p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_webm_720p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_720p_publish_checkbox" data-format="webm" data-resolution="720p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">480p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_webm_480p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_480p_publish_checkbox" data-format="webm" data-resolution="480p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">360p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_webm_360p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_360p_publish_checkbox" data-format="webm" data-resolution="360p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">240p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_webm_240p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_webm_240p_publish_checkbox" data-format="webm" data-resolution="240p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					</ul>\
					</div>\
					<div class="tab-pane fade position-relative height-700 border-radius-lg" id="cam6" role="tabpanel" aria-labelledby="cam6">\
					<ul class="list-group">\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">2160p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_ogv_2160p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_2160p_publish_checkbox" data-format="ogv" data-resolution="2160p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1440p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_ogv_1440p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_1440p_publish_checkbox" data-format="ogv" data-resolution="1440p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">1080p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_ogv_1080p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_1080p_publish_checkbox" data-format="ogv" data-resolution="1080p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">720p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_ogv_720p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_720p_publish_checkbox" data-format="ogv" data-resolution="720p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">480p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_ogv_480p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_480p_publish_checkbox" data-format="ogv" data-resolution="480p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">360p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_ogv_360p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_360p_publish_checkbox" data-format="ogv" data-resolution="360p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					<li class="list-group-item border-0 d-flex align-items-center px-0 mb-0"> <div class="col-12"> <div class="mb-1"> <div class="d-flex mb-2"> <span class="me-2 text-sm font-weight-bold text-capitalize">240p</span> </div> <div> <div class="progress progress-md"> <div id="' + videoId + '_ogv_240p" class="progress-bar bg-gradient-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div> </div> </div> </div><div><div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="' + videoId + '_ogv_240p_publish_checkbox" data-format="ogv" data-resolution="240p" class="form-check-input" type="checkbox"> </div></div> </div> </li>\
					</ul>\
					</div>\
					</div> </div></div>  </div> </div> </div> </div></div></div></div></div>',
					willOpen: () => {
						$('#importTitleInput').val('......................');
						$('#importDescriptionInput').val('......................');
						$('#importTagsInput').val('');
						
						$.ajax({type: 'GET', url: '/videos/' + videoId + '/information'})
						.done(function (data, textStatus, xhr)
						{
							if(data.isError) {
								alert(data.messages);
							}
							else {
								$('#importTitleInput').val(data.information.title);
								$('#importDescriptionInput').val(data.information.description);
								$('#importTagsInput').val(data.information.tags);
								
								updateTags();
								
								$('.moving-tab-selector-1').click(function() {
									const type = $(this).data('type');
									
									if(type === 'information') {
										$('#importTitleInput').val('......................');
										$('#importDescriptionInput').val('......................');
										choices.removeActiveItems();
									
										$.ajax({type: 'GET', url: '/videos/' + videoId + '/information'})
										.done(function (data, textStatus, xhr)
										{
											if(data.isError) {
												alert(data.messages);
											}
											else {
												$('#importTitleInput').val(data.information.title);
												$('#importDescriptionInput').val(data.information.description);
												
												choices.setValue(data.information.tags.split(','));
											}
										})
										.fail(function()
										{
											console.log('unable to communicate with node');
										});
										
										$('.moving-tab-1').css('padding', '0px');
										$('.moving-tab-1').css('width', '50%');
										$('.moving-tab-1').css('transform', 'translate3d(0px, 0px, 0px)');
										$('.moving-tab-1').css('transition', 'all 0.5s ease 0s');
										
										$('.swal2-confirm').removeClass('hidden-elem');
									}
									else if(type === 'published') {
										$.ajax({type: 'GET', url: '/videos/' + videoId + '/publishes'})
										.done(function (data, textStatus, xhr)
										{
											if(data.isError) {
												alert(data.messages);
											}
											else {
												const publishes = data.publishes;
												
												for(publish of publishes) {
													const format = publish.format;
													const resolution = publish.resolution;
													const isPublished = publish.isPublished;
													
													if(isPublished) {
														$('#manage-modal-published-tab-pane #' + videoId + '_' + format + '_' + resolution + '_publish_checkbox').prop('checked', true);
													}
												}
											}
										})
										.fail(function()
										{
											console.log('unable to communicate with node');
										});
										
										$('.moving-tab-1').css('padding', '0px');
										$('.moving-tab-1').css('width', '50%');
										$('.moving-tab-1').css('transform', 'translate3d(100%, 0px, 0px)');
										$('.moving-tab-1').css('transition', 'all 0.5s ease 0s');
										
										$('.swal2-confirm').addClass('hidden-elem');
									}
								});
								
								$('.moving-tab-selector-2').click(function() {
									const format = $(this).data('format');
									
									if(format === 'm3u8') {
										$('.moving-tab-2').css('padding', '0px');
										$('.moving-tab-2').css('width', '22%');
										$('.moving-tab-2').css('transform', 'translate3d(0px, 0px, 0px)');
										$('.moving-tab-2').css('transition', 'all 0.5s ease 0s');
									}
									else if(format === 'mp4') {
										$('.moving-tab-2').css('padding', '0px');
										$('.moving-tab-2').css('width', '22.6%');
										$('.moving-tab-2').css('transform', 'translate3d(100%, 0px, 0px)');
										$('.moving-tab-2').css('transition', 'all 0.5s ease 0s');
									}
									else if(format === 'webm') {
										$('.moving-tab-2').css('padding', '0px');
										$('.moving-tab-2').css('width', '23.7%');
										$('.moving-tab-2').css('transform', 'translate3d(200%, 0px, 0px)');
										$('.moving-tab-2').css('transition', 'all 0.5s ease 0s');
									}
									else if(format === 'ogv') {
										$('.moving-tab-2').css('padding', '0px');
										$('.moving-tab-2').css('width', '25%');
										$('.moving-tab-2').css('transform', 'translate3d(300%, 0px, 0px)');
										$('.moving-tab-2').css('transition', 'all 0.5s ease 0s');
									}
								});
								
								$('#manage-modal-published-tab-pane .form-check-input').change(function(event) {
									const checkbox = $(this);
									
									const format = $(checkbox).data('format');
									const resolution = $(checkbox).data('resolution');
									
									$(checkbox).attr('disabled', true);
									
									if ($(checkbox).is(':checked')) {
										const publishings = [];
										
										publishings.push({format: format, resolution: resolution});
										
										$.ajax({type: 'POST', url: '/videos/' + videoId + '/publish', data: {publishings: JSON.stringify(publishings)}})
										.done(function (data, textStatus, xhr) {
											if(data.isError) {
												alert(data.message);
												
												$(checkbox).prop('checked', !$(checkbox).is(':checked'));
											}
											else {
												
											}
										})
										.fail(function() {
											alert('video publish error occurred');
											
											$(checkbox).attr('disabled', false);
										})
									}
									else {
										$.ajax({type: 'POST', url: '/videos/' + videoId + '/unpublish', data: {format: format, resolution: resolution }})
										.always(function() {
											$(checkbox).attr('disabled', false);
										})
										.done(function (data, textStatus, xhr) {
											if(data.isError) {
												alert(data.message);
												
												$(checkbox).prop('checked', !$(checkbox).is(':checked'));
											}
											else {
												
											}
										})
										.fail(function() {
											alert('video unpublish error occurred');
										});
									}
								});
								
								function updateTags() {
									const importTagsInput = Swal.getPopup().querySelector('#importTagsInput');

									choices = new Choices(importTagsInput, {
										removeItemButton: true,
										placeholder: true,
										placeholderValue: 'Tags (press enter)',
										delimiter: ',',
										paste: true,
										duplicateItemsAllowed: false,
										shouldSort: false,
										renderChoiceLimit: -1,
										uniqueItemText: '',
										maxItemCount: 5,
										maxItemText: 'only 5 tags can be added',
										addItemFilter: (value) => {
											let result = false;
											
											let regex = /^[a-zA-Z0-9\s]*$/;
											
											if(value.length <= 30 && regex.test(value)) {
												result = true;
											}
											
											return result;
										},
										customAddItemText: 'tag length must be 30 characters or less and can contain letters, numbers, and spaces',
										classNames: {
										  containerOuter: 'choices w-100'
										}
									});
									
									importTagsInput.addEventListener('addItem', (event) => {
										console.log('Item added:', event.detail.value);
									});

									importTagsInput.addEventListener('removeItem', (event) => {
										console.log('Item removed:', event.detail.value);
									});
								}
							}
						})
						.fail(function()
						{
							console.log('unable to communicate with node');
						});
					},
					showCloseButton: true,
					showCancelButton: false,
					confirmButtonText: '<i class="fa fa-thumbs-up"></i> Save!',
					confirmButtonAriaLabel: "Thumbs up",
					preConfirm: () => {
						const title = Swal.getPopup().querySelector('#importTitleInput').value;
						const description = Swal.getPopup().querySelector('#importDescriptionInput').value;
						const tags = choices.getValue(true);
						
						if(title === '') {
							Swal.showValidationMessage('enter a title');
							return false;
						}
						else if(description === '') {
							Swal.showValidationMessage('enter a description');
							return false;
						}
						else if(tags.length === 0) {
							Swal.showValidationMessage('enter at least one tag');
							return false;
						}
						
						return { title: title, description: description, tags: tags }
					}
				})
				.then((result) => {
					if (result.isConfirmed) {
						const title = result.value.title;
						const description = result.value.description;
						const tags = result.value.tags.join(',');
						
						$.ajax({type: 'POST', url: '/videos/' + videoId + '/information', data: {title: title, description: description, tags: tags }})
						.done(function (data, textStatus, xhr) {
							if(data.isError) {
								alert(data.message);
							}
							else {
								const information = data.information;
								
								const title = information.title;
								const tags = information.tags;
								
								$('#videos_table_row_' + videoId).find('.table-row-title-link').text(title);
								$('#videos_table_row_' + videoId).find('.table-row-tags').text(tags);
							}
						})
						.fail(function() {
							alert('error occurred');
						});
					}
				});
			}
			
			function showThumbnailModal(videoId) {
				
				const html = '\
				<div class="row row-cols-3 g-4">\
					<div class="col-auto d-flex align-items-center justify-content-center">\
						<div class="card upload-images-button-container">\
							<img id="thumbnail-image-button" src="/videos/' + videoId + '/thumbnail" class="card-img-top rounded-top" alt="thumbnail" role="button" style="width: 100px; height: 100px;">\
							<span>thumb</span>\
							<span>100 x 100</span>\
							<input id="upload-thumbnail-input" type="file" accept=".jpg" hidden />\
						</div>\
					</div>\
					<div class="col-auto d-flex align-items-center justify-content-center">\
						<div class="card upload-images-button-container">\
							<img id="preview-image-button" src="/videos/' + videoId + '/preview" class="card-img-top rounded-top" alt="preview" role="button" style="width: 256px; height: 144px;">\
							<span>preview</span>\
							<span>512 x 288</span>\
							<input id="upload-preview-input" type="file" accept=".jpg" hidden />\
						</div>\
					</div>\
					<div class="col-auto d-flex align-items-center justify-content-center">\
						<div class="card upload-images-button-container">\
							<img id="poster-image-button" src="/videos/' + videoId + '/poster" class="card-img-top rounded-top" alt="poster" role="button" style="width: 512px; height: 288px;">\
							<span>poster</span>\
							<span>1280 x 720</span>\
							<input id="upload-poster-input" type="file" accept=".jpg" hidden />\
						</div>\
					</div>\
				</div>\
				';
				
				Swal.fire({
					title: 'upload images',
					html: html,
					footer: 'images are center-cropped and resized to the indicated dimensions',
					showCloseButton: true,
					showConfirmButton: false,
					didOpen: () => {
						$('#upload-thumbnail-input').change(function() {
							let file = this.files[0];
							
							if (file.size > 0 && (file.type.match("image/jpeg"))) {
								$('#videos_table_row_' + videoId).find('td').eq(0).find('img').eq(0).replaceWith('<div class="spinner spinner-border text-primary avatar-sm me-3" role="status"><span class="sr-only">Loading...</span></div>');
								
								let formData = new FormData();
								
								formData.append('thumbnail_file', file);

								$.ajax({type: 'POST', url: '/videos/' + videoId + '/thumbnail', data: formData, processData: false, contentType: false})
								.done(function (data, textStatus, xhr) {
									if(data.isError) {
									
									}
									else {
										$('#videos_table_row_' + videoId).find('td').eq(0).find('.spinner').eq(0).replaceWith('<img src="/videos/' + videoId + '/thumbnail" class="avatar avatar-sm me-3" alt="avatar image" onclick="showThumbnailModal(\''+videoId+'\')" data-bs-toggle="tooltip" data-bs-placement="top" title="upload images" data-container="body" data-animation="true" role="button"/>');
										$('#thumbnail-image-button').replaceWith('<img id="thumbnail-image-button" src="/videos/' + videoId + '/thumbnail" class="card-img-top rounded-top" alt="thumbnail" role="button" style="width: 100px; height: 100px;">');
										
										$('#thumbnail-image-button').on('click', function(event) {
											$('#upload-thumbnail-input').trigger('click');
										});
										
										refreshHoverTooltips();
									}
								})
								.fail(function() {
									alert('video file import error occurred');
								});
								
							}
						});
						
						$('#upload-preview-input').change(function() {
							let file = this.files[0];
							
							if (file.size > 0 && (file.type.match("image/jpeg"))) {
								let formData = new FormData();
								
								formData.append('preview_file', file);

								$.ajax({type: 'POST', url: '/videos/' + videoId + '/preview', data: formData, processData: false, contentType: false})
								.done(function (data, textStatus, xhr) {
									if(data.isError) {
									
									}
									else {
										$('#preview-image-button').replaceWith('<img id="preview-image-button" src="/videos/' + videoId + '/preview" class="card-img-top rounded-top" alt="preview" role="button" style="width: 256px; height: 144px;">');
										
										$('#preview-image-button').on('click', function(event) {
											$('#upload-preview-input').trigger('click');
										});
									}
								})
								.fail(function() {
									alert('video file import error occurred');
								});
							}
						});
						
						$('#upload-poster-input').change(function() {
							let file = this.files[0];
							
							if (file.size > 0 && (file.type.match("image/jpeg"))) {
								let formData = new FormData();
								
								formData.append('poster_file', file);

								$.ajax({type: 'POST', url: '/videos/' + videoId + '/poster', data: formData, processData: false, contentType: false})
								.done(function (data, textStatus, xhr) {
									if(data.isError) {
									
									}
									else {
										$('#poster-image-button').replaceWith('<img id="poster-image-button" src="/videos/' + videoId + '/poster" class="card-img-top rounded-top" alt="poster" role="button" style="width: 512px; height: 288px;">');
										
										$('#poster-image-button').on('click', function(event) {
											$('#upload-poster-input').trigger('click');
										});
									}
								})
								.fail(function() {
									alert('video file import error occurred');
								});
							}
						});
						
						$('#thumbnail-image-button').on('click', function(event) {
							$('#upload-thumbnail-input').trigger('click');
						});
						
						$('#preview-image-button').on('click', function(event) {
							$('#upload-preview-input').trigger('click');
						});
						
						$('#poster-image-button').on('click', function(event) {
							$('#upload-poster-input').trigger('click');
						});
					}
				});
			}
			
			function populateTagsDropdown(button) {
				if($(button).hasClass('show')) {
					$('#tags-dropdown').html('<li class="d-flex align-items-center justify-content-center"><div class="spinner-grow text-primary spinner-grow-sm align-items-center" role="status"><span class="sr-only">Loading...</span></div></li>');
					
					$.ajax({type: 'GET', url: '/videos/tags/all'})
					.always(function() {
						
					})
					.done(function (data, textStatus, xhr)
					{
						if(data.isError) {
							
						}
						else {
							$('#tags-dropdown').empty();
							
							$('#tags-dropdown').append('<li><a class="dropdown-item d-flex align-items-center justify-content-center" href="javascript:;" onclick="searchTagSelected(\'\')"><i><b>search all</b></i></a></li>');
							
							data.tags.sort();
							
							data.tags.forEach(function(tag) {
								$('#tags-dropdown').append('<li><a class="dropdown-item d-flex align-items-center justify-content-center" href="javascript:;" onclick="searchTagSelected(\''+tag+'\')">' + tag + '</a></li>');
							});
						}
					})
					.fail(function()
					{
						console.log('unable to communicate with node');
					});
				}
			}
			
			
			
			
			
			
			
			
			let searchInputTimer;
			function searchInputEntered(input) {
				const value = input.value;
				
				clearTimeout(searchInputTimer);
				
				$('#search_input_icon').addClass('hidden-elem');
				$('#search_input_spinner').removeClass('hidden-elem');
				searchInputTimer = setTimeout(async function() {
					$('#videos_table tbody').empty();
					
					startVideosLoaderInterval(value, 'latest', lastUsedTag, 10, Date.now());
					
					$('#search_input_spinner').addClass('hidden-elem');
					$('#search_input_icon').removeClass('hidden-elem');
					
				}, 500);
			}
			
			
			async function searchTagSelected(tag) {
				if(tag === '') {
					$('#search-input').attr('placeholder', 'Search here...');
				}
				else {
					$('#search-input').attr('placeholder', 'Searching ' + tag + '...');
				}
				
				const searchInput = $('#search-input').val();
			
				$('#videos_table tbody').empty();
				
				startVideosLoaderInterval(searchInput, 'latest', tag, 10, Date.now());
			}
			
			
			
			function doSelectAllVideos(checkboxAll) {
				const isChecked = $(checkboxAll).prop('checked');
				
				$('.videos-table-select-video').each(function() {
					if(!$(this).is(':disabled')) {
						$(this).prop('checked', isChecked);
					}
				});
				
				updateSelectedVideosButtons();
			}
			
			function doSelectedVideo(checkbox) {
				if(!$(checkbox).prop('checked')) {
					$('#videos-table-select-all').prop('checked', false);
				}
				
				updateSelectedVideosButtons();
			}
			
			function updateSelectedVideosButtons() {
				let showVideosButtons = false;
				
				$('.videos-table-select-video').each(function() {
					if($(this).prop('checked')) {
						showVideosButtons = true;
						return;
					}
				});
				
				if(showVideosButtons) {
					$('#delete-selected-videos-garbage-icon').removeClass('hidden-elem');
					$('#delete-selected-videos-button').removeClass('hidden-elem');
					
					$('#finalize-selected-videos-garbage-icon').removeClass('hidden-elem');
					$('#finalize-selected-videos-button').removeClass('hidden-elem');
				}
				else {
					$('#delete-selected-videos-button').addClass('hidden-elem');
					$('#delete-selected-videos-garbage-icon').addClass('hidden-elem');
					
					$('#finalize-selected-videos-button').addClass('hidden-elem');
					$('#finalize-selected-videos-garbage-icon').addClass('hidden-elem');
				}
			}
			
			function performDeleteSelectedVideos() {
				const html = '\
				<small>note: videos that are importing, publishing, streaming, or indexed cannot be deleted</small>\
				';
				
				Swal.fire({
					title: 'Delete Videos',
					html: html,
					showCloseButton: true,
					showConfirmButton: true,
					showCancelButton: true,
					confirmButtonText: 'confirm',
				}).then((result) => {
					if (result.isConfirmed) {
						const videoIds = [];
				
						$('#delete-selected-videos-garbage-icon').addClass('hidden-elem');
						$('#delete-selected-videos-spinner').removeClass('hidden-elem');
						
						$('.videos-table-select-video').each(function() {
							if($(this).prop('checked')) {
								const videoId = $(this).data('videoid');
								videoIds.push(videoId);
							}
						});
						
						const videoIdsJson = JSON.stringify(videoIds);
						
						$.ajax({type: 'POST', url: '/videos/delete', data: {videoIdsJson: videoIdsJson}})
						.done(function (data, textStatus, xhr) {
							if(data.isError) {
								
							}
							else {
								const deletedVideoIds = data.deletedVideoIds;
								const nonDeletedVideoIds = data.nonDeletedVideoIds;
								
								for(deletedVideoId of deletedVideoIds) {
									$('#videos_table_row_' + deletedVideoId).remove();
								}
								
								if(nonDeletedVideoIds.length === 0) {
									$('#delete-selected-videos-button').addClass('hidden-elem');
									$('#delete-selected-videos-spinner').addClass('hidden-elem');
									$('#delete-selected-videos-garbage-icon').addClass('hidden-elem');
									
									$('#finalize-selected-videos-button').addClass('hidden-elem');
									$('#finalize-selected-videos-spinner').addClass('hidden-elem');
									$('#finalize-selected-videos-garbage-icon').addClass('hidden-elem');
								}
								else {
									$('#delete-selected-videos-spinner').addClass('hidden-elem');
									$('#delete-selected-videos-garbage-icon').removeClass('hidden-elem');
									
									$('#finalize-selected-videos-spinner').addClass('hidden-elem');
									$('#finalize-selected-videos-garbage-icon').removeClass('hidden-elem');
									
									showNotification('<span class=\"alert-text\">some videos could not be deleted</span>', 'alert-primary');
								}
								
								$('#videos-table-select-all').prop('checked', false);
							}
						})
						.fail(function() {
							
						});
					}
				});
			}
			
			function performFinalizeSelectedVideos() {
				const html = '\
				<div>Finalizing a video means its source file will be deleted</div>\
				<div>No further publishings for this video will be possible, but you free up all that space!</div>\
				<p><small>note: videos that are importing, publishing, or streaming cannot be finalized</small></p>\
				';
				
				Swal.fire({
					title: 'Finalize Videos',
					html: html,
					showCloseButton: true,
					showConfirmButton: true,
					showCancelButton: true,
					confirmButtonText: 'confirm',
				}).then((result) => {
					if (result.isConfirmed) {
						const videoIds = [];
						
						$('#finalize-selected-videos-garbage-icon').addClass('hidden-elem');
						$('#finalize-selected-videos-spinner').removeClass('hidden-elem');
						
						$('.videos-table-select-video').each(function() {
							if($(this).prop('checked')) {
								const videoId = $(this).data('videoid');
								videoIds.push(videoId);
							}
						});
						
						const videoIdsJson = JSON.stringify(videoIds);
						
						$.ajax({type: 'POST', url: '/videos/finalize', data: {videoIdsJson: videoIdsJson}})
						.done(function (data, textStatus, xhr) {
							if(data.isError) {
								alert(data.message);
							}
							else {
								const finalizedVideoIds = data.finalizedVideoIds;
								const nonFinalizedVideoIds = data.nonFinalizedVideoIds;
								
								for(finalizedVideoId of finalizedVideoIds) {
									$('#videos_table_row_' + finalizedVideoId).find('.videos-table-select-video').prop('checked', false);
								}
								
								if(nonFinalizedVideoIds.length === 0) {
									$('#delete-selected-videos-button').addClass('hidden-elem');
									$('#delete-selected-videos-spinner').addClass('hidden-elem');
									$('#delete-selected-videos-garbage-icon').addClass('hidden-elem');
									
									$('#finalize-selected-videos-button').addClass('hidden-elem');
									$('#finalize-selected-videos-spinner').addClass('hidden-elem');
									$('#finalize-selected-videos-garbage-icon').addClass('hidden-elem');
								}
								else {
									$('#delete-selected-videos-spinner').addClass('hidden-elem');
									$('#delete-selected-videos-garbage-icon').removeClass('hidden-elem');
									
									$('#finalize-selected-videos-spinner').addClass('hidden-elem');
									$('#finalize-selected-videos-garbage-icon').removeClass('hidden-elem');
									
									showNotification('<span class=\"alert-text\">some videos could not be finalized</span>', 'alert-primary');
								}
								
								$('#videos-table-select-all').prop('checked', false);
							}
						})
						.fail(function() {
							alert('video finalize error occurred');
						});
					}
				});
			}
			

			function doStopJob(item) {
				const videoId = $(item).data('videoid');
				const jobType = $(item).data('jobtype');
				
				$('#videos_table_row_live_icons_' + videoId).remove();
				
				$(item).remove();
				$('#videos_table_row_' + videoId).find('td').eq(6).html('<span class="text-secondary text-sm d-flex justify-content-center align-items-center">stopping</span>');
				
				if(jobType === 'importing') {
					$.ajax({type: 'POST', url: '/videos/' + videoId + '/importing/stop'})
					.done(function (data, textStatus, xhr) {
						if(data.isError) {
							alert(data.message);
						}
						else {
							// do nothing
						}
					})
					.fail(function() {
						alert('video import stop error occurred');
					});
				}
				else if(jobType === 'publishing') {
					$.ajax({type: 'POST', url: '/videos/' + videoId + '/publishing/stop'})
					.done(function (data, textStatus, xhr) {
						if(data.isError) {
							alert(data.message);
						}
						else {
							// do nothing
						}
					})
					.fail(function() {
						alert('video publish stop error occurred');
					});
				}
				else if(jobType === 'streaming') {
					$.ajax({type: 'POST', url: '/streams/' + videoId + '/stop'})
					.done(function (data, textStatus, xhr) {
						if(data.isError) {
							alert(data.message);
						}
						else {
							// do nothing
						}
					})
					.fail(function() {
						alert('video stream stop error occurred');
					});
				}
			}
			
			function doIndexVideo(checkbox) {
				const videoId = $(checkbox).data('videoid');
				const isIndexing = $(checkbox).prop('checked');
				
				if(isIndexing) {
					let revertAction = true;
					
					Swal.fire({
						title: '...preparing to index...',
						showCloseButton: true,
						confirmButtonText: 'submit',
						customClass: {
							actions: 'm-0',
						},
						didOpen: () => {
							Swal.showLoading();
							
							getCaptcha('/index/captcha')
							.then((objectURL) => {
								Swal.hideLoading();
								
								Swal.disableButtons();
								
								const html = '<div id="index-captcha" class="captcha-container">......</div>\
								<div id="index-captcha-error"></div>\
								<div class="input-group"><input id="index-captcha-input" class="form-control mt-2" disabled placeholder="enter the captcha" type="text"></div>\
								<div class="form-check mt-2 d-flex align-items-center justify-content-center text-center">\
									<div>\
										<label for="contains-adult-content-checkbox">Contains Adult Content</label> \
										<input id="contains-adult-content-checkbox" class="form-check-input" type="checkbox">\
									</div>\
								</div>\
								<div class="form-check mt-2 d-flex align-items-center justify-content-center text-center">\
									<div>\
										<label for="terms-of-service-checkbox">I agree to the <a href="http://www.moartube.com/terms-of-service" target="_blank">Terms of Service</a></label> \
										<input id="terms-of-service-checkbox" class="form-check-input" type="checkbox">\
									</div>\
								</div>';
								
								Swal.update({ 
									title: 'enter the captcha', 
									html: html 
								});
								
								$('#index-captcha-input').on('keypress', function(event) {
									if (event.keyCode === 13) {
										Swal.clickConfirm();
									}
								});
								
								$('#terms-of-service-checkbox').on('click', function(event) {
									if($(this).prop('checked')) {
										Swal.enableButtons();
									}
									else {
										Swal.disableButtons();
									}
								});
								
								$('#index-captcha').html('<img src="' + objectURL + '">');
								
								$('#index-captcha-input').prop('disabled', false);
								$('#index-captcha-input').focus();
							})
							.catch(error => {
								Swal.hideLoading();
								
								$('#index-captcha-input').remove();
								
								Swal.update({ 
									icon: 'info',
									title: 'hmmm',
									html: error,
									showConfirmButton: false
								});
								
								$(checkbox).prop('checked', !isIndexing);
							});
						},
						preConfirm: () => {
							const captchaResponse = $('#index-captcha-input').val();
							const containsAdultContent = $('#contains-adult-content-checkbox').prop('checked');
							const termsOfServiceAgreed = $('#terms-of-service-checkbox').prop('checked');
							
							if(termsOfServiceAgreed && captchaResponse != null && captchaResponse !== '') {
								$('.swal2-confirm').prop('disabled', true);
								
								$.ajax({type: 'POST', url: '/videos/' + videoId + '/index/add', data: JSON.stringify({ captchaResponse: captchaResponse, containsAdultContent: containsAdultContent, termsOfServiceAgreed: termsOfServiceAgreed }), contentType: 'application/json; charset=utf-8'})
								.always(function() {
									$('.swal2-confirm').prop('disabled', false);
								})
								.done(function (data, textStatus, xhr) {
									if(data.isError) {
										if(data.message === 'the captcha was not correct') {
											$('#index-captcha-input').val('');
											$('#index-captcha-error').text(data.message);
											
											getCaptcha('/index/captcha')
											.then((objectURL) => {
												$('#index-captcha').html('<div class="captcha-container"><img src="' + objectURL + '"></div>');
											})
											.catch(error => {
												$('#index-captcha-error').text(error);
											});
										}
										else {
											Swal.fire({
												icon: 'error',
												title: 'hmmm',
												html: data.message
											});
											
											$(checkbox).prop('checked', !isIndexing);
										}
									}
									else {
										showNotification('<span class=\"alert-text\">added your video to the MoarTube index</span>', 'alert-primary');
										
										revertAction = false;
										
										Swal.close();
									}
								})
								.fail(function() {
									Swal.fire({
										icon: 'error',
										title: 'hmmm',
										text: '...something went wrong...'
									});
									
									$(checkbox).prop('checked', !isIndexing);
								});
							}
							
							return false;
						}
					}).then((result) => {
						if (result.isConfirmed) {
							
						}
						else {
							if(revertAction) {
								$(checkbox).prop('checked', !isIndexing);
							}
						}
					});
				}
				else {
					$.ajax({type: 'POST', url: '/videos/' + videoId + '/index/remove'})
					.done(function (data, textStatus, xhr) {
						if(data.isError) {
							Swal.fire({
								icon: 'error',
								title: 'hmmm',
								html: data.message
							});
							
							$(checkbox).prop('checked', !isIndexing);
						}
						else {
							const notificationMessage = "<span class=\"alert-text\">removed your video from the MoarTube index</span>";
							
							showNotification(notificationMessage, 'alert-primary');
						}
					})
					.fail(function() {
						Swal.fire({
							icon: 'error',
							title: 'hmmm',
							text: '...something went wrong...'
						});
						
						$(checkbox).prop('checked', !isIndexing);
					});
				}
			}
			
			function showIndexHelp() {
				Swal.fire({
					icon: 'info',
					title: 'What is Indexing?',
					html: "MoarTube allows you to share your videos publicly on the <a href='http://www.MoarTube.com' target='blank'>MoarTube.com</a> front page.<br> Please familiarize yourself with <a href='http://www.moartube.com/terms-of-service' target='blank'>MoarTube's Terms of Service</a> before using the indexing feature."
				});
			}
			
			function showChatEmbedModal(videoId) {
				const html = '\
				<div class="card" id="notifications"> \
					<div class="card-body pt-0"> \
						<div class="table-responsive"> \
							<table id="embed-chat-table" class="table mb-0"> \
								<tbody> \
									<tr> <td class="ps-1" colspan="4"> <div class="my-auto">  <span class="text-s font-weight-normal">show chat input</span> </div> </td> <td> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="embed-chat-show-chat-checkbox" class="form-check-input" type="checkbox"> </div> </td>   </tr> \
									<tr> <td class="ps-1 align-middle" colspan="4"> <div class="my-auto">  <span class="text-s font-weight-normal">background color</span> </div> </td> <td> <div id="background-color-pickr"></div> </td>   </tr>   \
									<tr> <td class="ps-1 align-middle" colspan="4"> <div class="my-auto">  <span class="text-s font-weight-normal">chat text color</span> </div> </td> <td> <div id="chat-text-color-pickr"></div> </td>   </tr>   \
								</tbody> \
							</table> \
						</div> \
					</div> \
				</div> \
				<div class="input-group mt-2"><input id="embed-chat-input" class="form-control me-1" type="text" value="" disabled=""><span class="input-group-btn"><button id="embed-chat-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-container="body" data-bs-animation="false" data-bs-original-title="copied!">copy</button></span></div> \
				<div class="input-group mt-2"><input id="embed-chat-code-input" class="form-control me-1" type="text" value="" disabled=""><span class="input-group-btn"><button id="embed-chat-code-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-container="body" data-bs-animation="false" data-bs-original-title="copied!">copy</button></span></div>';
				
				Swal.fire({
					title: 'Embed Chat',
					showCloseButton: true,
					showConfirmButton: false,
					html: html,
					didOpen: () => {
						let sci = false;
						let bgc = '000000';
						let ctc = 'F9F9F9';
						
						Pickr.create({
							el: '#background-color-pickr',
							theme: 'nano',
							default: '#' + bgc,
							swatches: [
								'rgba(0, 0, 0, 1)',
								'rgba(249, 249, 249, 1)',
								'rgba(203, 12, 159, 1)',
								'rgba(103, 58, 183, 0.85)',
								'rgba(63, 81, 181, 0.8)',
								'rgba(33, 150, 243, 0.75)',
								'rgba(3, 169, 244, 0.7)',
								'rgba(0, 188, 212, 0.7)',
								'rgba(0, 150, 136, 0.75)',
								'rgba(76, 175, 80, 0.8)',
								'rgba(139, 195, 74, 0.85)',
								'rgba(205, 220, 57, 0.9)',
								'rgba(255, 235, 59, 0.95)',
								'rgba(255, 193, 7, 1)'
							],
							components: {
								preview: true,
								opacity: true,
								hue: true,
								interaction: {
									input: true
								}
							}
						})
						.on('change', (color, source, instance) => {
							instance.applyColor(true, color);
							
							bgc = color.toHEXA().toString().slice(1);
							
							updateChatEmbedInput();
						});
						
						Pickr.create({
							el: '#chat-text-color-pickr',
							theme: 'nano',
							default: '#' + ctc,
							swatches: [
								'rgba(0, 0, 0, 1)',
								'rgba(249, 249, 249, 1)',
								'rgba(203, 12, 159, 1)',
								'rgba(103, 58, 183, 0.85)',
								'rgba(63, 81, 181, 0.8)',
								'rgba(33, 150, 243, 0.75)',
								'rgba(3, 169, 244, 0.7)',
								'rgba(0, 188, 212, 0.7)',
								'rgba(0, 150, 136, 0.75)',
								'rgba(76, 175, 80, 0.8)',
								'rgba(139, 195, 74, 0.85)',
								'rgba(205, 220, 57, 0.9)',
								'rgba(255, 235, 59, 0.95)',
								'rgba(255, 193, 7, 1)'
							],
							components: {
								preview: true,
								opacity: true,
								hue: true,
								interaction: {
									input: true
								}
							}
						})
						.on('change', (color, source, instance) => {
							instance.applyColor(true, color);
							
							ctc = color.toHEXA().toString().slice(1);
							
							updateChatEmbedInput();
						});
						
						$('#embed-chat-show-chat-checkbox').on('click', function(event) {
							sci = $(this).prop('checked');
							
							updateChatEmbedInput();
						});
						
						$('#embed-chat-copy-button').click(function(event) {
							const value = $('#embed-chat-input').val();
							
							setClipboard(value);
						});
						
						$('#embed-chat-code-copy-button').click(function(event) {
							const value = $('#embed-chat-code-input').val();
							
							setClipboard(value);
						});
						
						function updateChatEmbedInput() {
							const url = NODE_BASE_URL + '/embed/chat/' + videoId + '?sci=' + sci + '&' + 'bgc=' + bgc + '&' + 'ctc=' + ctc;
							const code = '<iframe width="560" height="315" src="' + url + '" title="MoarTube video chat" frameborder="0"></iframe>';
							
							$('#embed-chat-input').val(url);
							$('#embed-chat-code-input').val(code);
						}
						
						updateChatEmbedInput();
						
						refreshClickTooltips();
					}
				});
			}
			
			function showRtmpLinksModal(videoId) {
				const html = '\
				<label class="form-label d-flex justify-content-start mt-3 mb-1">RTMP Stream URL</label>\
				<div class="input-group mt-1">\
					<input id="rtmp-url-input" class="form-control me-1" value="....." disabled />\
					<span class="input-group-btn"><button id="rtmp-url-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="copied!" data-bs-container="body" data-bs-animation="false">copy</button></span>\
				</div>\
				<label class="form-label d-flex justify-content-start mt-3 mb-1">RTMP Server URL</label>\
				<div class="input-group mt-1">\
					<input id="rtmp-server-url-input" class="form-control me-1" value="....." disabled />\
					<span class="input-group-btn"><button id="rtmp-server-url-input-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="copied!" data-bs-container="body" data-bs-animation="false">copy</button></span>\
				</div>\
				<label class="form-label d-flex justify-content-start mt-3 mb-1">RTMP Stream Key</label>\
				<div class="input-group">\
					<input id="rtmp-stream-key-input" class="form-control me-1" value="....." disabled />\
					<span class="input-group-btn"><button id="rtmp-stream-key-input-copy-button" class="btn btn-primary click-tooltip" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="copied!" data-bs-container="body" data-bs-animation="false">copy</button></span>\
				</div>';
				
				Swal.fire({
					title: 'Stream Config',
					showCloseButton: true,
					showConfirmButton: false,
					html: html,
					didOpen: () => {
						$.ajax({type: 'GET', url: '/streams/' + videoId + '/rtmp/information'})
						.done(function (data, textStatus, xhr) {
							if(data.isError) {
								Swal.fire({
									icon: 'error',
									title: 'hmmm',
									text: data.message
								});
							}
							else {
								const rtmpStreamUrl = data.rtmpStreamUrl;
								const rtmpServerUrl = data.rtmpServerUrl;
								const rtmpStreamkey = data.rtmpStreamkey;

								$('#rtmp-url-input').val(rtmpStreamUrl);
								$('#rtmp-server-url-input').val(rtmpServerUrl);
								$('#rtmp-stream-key-input').val(rtmpStreamkey);

								$('#rtmp-url-copy-button').click(function(event) {
									const rtmpStreamUrl = $("#rtmp-url-input").val();
									
									setClipboard(rtmpStreamUrl);
								});
								
								$('#rtmp-server-url-input-copy-button').click(function(event) {
									const rtmpServerUrl = $("#rtmp-server-url-input").val();
									
									setClipboard(rtmpServerUrl);
								});
								
								$('#rtmp-stream-key-input-copy-button').click(function(event) {
									const rtmpStreamKey = $("#rtmp-stream-key-input").val();
									
									setClipboard(rtmpStreamKey);
								});
								
								refreshClickTooltips();
							}
						})
						.fail(function() {
							Swal.fire({
								icon: 'error',
								title: 'hmmm',
								text: '...something went wrong...'
							});
						});
					}
				});
			}
			
			function showChatSettingsModal(videoId) {
				const html = '\
				<div class="card" id="notifications"> \
					<div class="card-body pt-0"> \
						<div class="table-responsive"> \
							<table id="chat-settings-table" class="table mb-0"> \
								<tbody> \
									<tr> <td class="ps-1" colspan="4"> <div class="my-auto">  <span class="text-s font-weight-normal">chat history</span> </div> </td> <td> <div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"> <input id="chat-settings-is-chat-history-enabled" class="form-check-input" type="checkbox" disabled> </div> </td>   </tr> \
									<tr> <td class="ps-1 align-middle" colspan="4"> <div class="my-auto">  <span class="text-s font-weight-normal">chat history limit</span> </div> </td> <td> <select id="chat-settings-chat-history-limit" class="form-select dropdown-toggle me-1" disabled><option value=0>no limit</option><option value=10>10 messages</option><option value=20>20 messages</option><option value=30>30 messages</option><option value=40>40 messages</option><option value=50>50 messages</option></select> </td>   </tr>   \
								</tbody> \
							</table> \
						</div> \
					</div> \
				</div>';
				
				Swal.fire({
					title: 'Chat Settings',
					showCloseButton: true,
					showConfirmButton: false,
					html: html,
					didOpen: () => {
						$.ajax({type: 'GET', url: '/streams/' + videoId + '/chat/settings'})
						.done(function (data, textStatus, xhr) {
							if(data.isError) {
								Swal.fire({
									icon: 'error',
									title: 'hmmm',
									text: data.message
								});
							}
							else {
								const isChatHistoryEnabled = data.isChatHistoryEnabled;
								const chatHistoryLimit = data.chatHistoryLimit;
								
								$('#chat-settings-is-chat-history-enabled').prop('disabled', false);
								
								if(isChatHistoryEnabled) {
									$('#chat-settings-chat-history-limit').prop('disabled', false);
								}
								
								$('#chat-settings-is-chat-history-enabled').prop('checked', isChatHistoryEnabled);
								$('#chat-settings-chat-history-limit').val(chatHistoryLimit);
								
								$('#chat-settings-is-chat-history-enabled').on('click', function(event) {
									const isChatHistoryEnabled = $('#chat-settings-is-chat-history-enabled').is(':checked') ? true : false;
									const chatHistoryLimit = Number($('#chat-settings-chat-history-limit').val());
									
									saveChatSettings(isChatHistoryEnabled, chatHistoryLimit);
								});
					
								$('#chat-settings-chat-history-limit').on('change', function() {
									const isChatHistoryEnabled = $('#chat-settings-is-chat-history-enabled').is(':checked') ? true : false;
									const chatHistoryLimit = Number($('#chat-settings-chat-history-limit').val());
									
									saveChatSettings(isChatHistoryEnabled, chatHistoryLimit);
								});
					
								function saveChatSettings(isChatHistoryEnabled, chatHistoryLimit) {
									$.post({url: '/streams/' + videoId + '/chat/settings', data: JSON.stringify({isChatHistoryEnabled: isChatHistoryEnabled, chatHistoryLimit: chatHistoryLimit}), contentType: 'application/json; charset=utf-8'})
									.done(function(data) {
										if(data.isError) {
											showNotification(data.message, 'alert-primary');
										}
										else {
											//showNotification('chat settings saved', 'alert-primary');
											
											$('#chat-settings-chat-history-limit').prop('disabled', !isChatHistoryEnabled);
										}
									})
									.fail(function() {
										showNotification('chat settings save error', 'alert-primary');
									});
								}
							}
						})
						.fail(function() {
							Swal.fire({
								icon: 'error',
								title: 'hmmm',
								text: '...something went wrong...'
							});
						});
					}
				});
			}
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		
		
			function generateVideoTableRow(videoId, thumbnail, title, tags, lengthTimestamp, views, comments, likes, dislikes, bandwidth, status, isIndexed) {
				let html = generate_Avatar_Title_Description_TableCell(videoId, thumbnail, title, tags, status);
				
				html += '<td class="align-middle text-center text-sm"> \
						<p class="text-secondary mb-0 text-sm">' + lengthTimestamp + '</p> \
					</td> \
					<td class="align-middle text-center text-sm"> \
						<p class="text-secondary mb-0 text-sm">' + views + '</p> \
					</td> \
					<td class="align-middle text-center text-sm"> \
						<p class="text-secondary mb-0 text-sm">' + comments + '</p> \
					</td> \
					<td class="align-middle text-center text-sm"> \
						<p class="text-secondary mb-0 text-sm">' + likes + ' / ' + dislikes + '</p> \
					</td> \
					<td class="align-middle text-center text-sm"> \
						<p class="text-secondary mb-0 text-sm">' + calculateBandwidthUsage_MB(bandwidth) + '</p> \
					</td> \
					<td class="align-middle text-center"> \
						<span class="text-secondary text-sm d-flex justify-content-center align-items-center">' + status + '</span>'
					
				if(status === 'importing') {
					html += '<a class="text-danger cursor-pointer" onclick="doStopJob(this)" data-jobtype="importing" data-videoid="' + videoId + '"><i class="fas fa-stop"></i></a>';
				}
				else if(status === 'publishing') {
					html += '<a class="text-danger cursor-pointer" onclick="doStopJob(this)" data-jobtype="publishing" data-videoid="' + videoId + '"><i class="fas fa-stop"></i></a>';
				}
				else if(status === 'live') {
					html += '<a class="text-danger cursor-pointer" onclick="doStopJob(this)" data-jobtype="streaming" data-videoid="' + videoId + '"><i class="fas fa-stop"></i></a>';
				}
				
				let checked = '';
				if(isIndexed) {
					checked = 'checked'
				}
				
				html += '<td class="align-middle text-center text-sm"> \
							<div class="form-check form-switch mb-0 d-flex align-items-center justify-content-center"><input id="' + videoId + '_index_checkbox" class="form-check-input" type="checkbox" data-videoid="' + videoId + '" onclick="doIndexVideo(this)"' + checked + '></div> \
						</td>';
				
				html +=	'</td> \
					<td class="align-middle text-center"> \
						<button type="button" class="btn btn-icon btn-2 btn-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="publish" data-container="body" data-animation="true" onclick="showPublishWizardModal(\''+videoId+'\')"><span class="btn-inner--icon"><i class="ni ni-cloud-upload-96"></i></span></button>\
						<button type="button" class="btn btn-icon btn-2 btn-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="share" data-container="body" data-animation="true" onclick="showShareModal(\''+videoId+'\')"><span class="btn-inner--icon"><i class="ni ni-world-2"></i></span></button>\
						<button type="button" class="btn btn-icon btn-2 btn-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="manage" data-container="body" data-animation="true" onclick="showManageImportModal(\''+videoId+'\')"><span class="btn-inner--icon"><i class="ni ni-settings-gear-65"></i></span></button>\
					</td> \
				</tr>';
				
				return html;
			}
			
			function generate_Avatar_Title_Description_TableCell(videoId, thumbnail, title, tags, status) {
				let html = '<tr id="videos_table_row_' + videoId + '"><td><div class="d-flex px-2 py-1"> \
				<div class="form-check"><input class="form-check-input videos-table-select-video" type="checkbox" onclick="doSelectedVideo(this)" data-videoid="' + videoId + '"></div>';
				
				if(thumbnail === '') {
					html += '<div id="video-thumbnail-loading-spinner-' + videoId + '" class="spinner-border text-primary avatar-sm me-3" role="status"><span class="sr-only">Loading...</span></div>';
				}
				else {
					let showThumbnailModalHtml = '';
					
					if(status !== 'importing' && status !== 'live') {
						showThumbnailModalHtml = 'onclick="showThumbnailModal(\''+videoId+'\')" data-bs-toggle="tooltip" data-bs-placement="top" title="upload images" data-container="body" data-animation="true" role="button"';
					}
					
					html += '<div><img id="video-thumbnail-' + videoId + '" class="avatar avatar-sm me-3" src="' + thumbnail + '" alt="avatar image" ' + showThumbnailModalHtml + '/></div>';
				}
				
				html += '<div class="d-flex flex-column justify-content-center"> \
							<h6 class="mb-0 text-sm table-row-title"><a class="table-row-title-link" href="' + NODE_BASE_URL + '/watch?v=' + videoId + '" target="_blank">' + title + '</a></h6> \
							<p class="mb-0 text-sm fst-italic table-row-tags" style="font-size:13px !important;">' + tags + '</p>';
				
				if(status === 'live') {
					html += '<div id="videos_table_row_live_icons_' + videoId + '"> \
					<i role="button" data-bs-toggle="tooltip" data-bs-placement="top" title="Embed Chat" data-container="body" data-animation="true" onclick="showChatEmbedModal(\''+videoId+'\')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#cb0c9f" class="bi bi-chat me-2" viewBox="0 0 16 16"> <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"></path> </svg></i> \
					<i role="button" data-bs-toggle="tooltip" data-bs-placement="top" title="Stream Config" data-container="body" data-animation="true" onclick="showRtmpLinksModal(\''+videoId+'\')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#cb0c9f" class="bi bi-broadcast me-2" viewBox="0 0 16 16"><path d="M3.05 3.05a7 7 0 0 0 0 9.9.5.5 0 0 1-.707.707 8 8 0 0 1 0-11.314.5.5 0 0 1 .707.707zm2.122 2.122a4 4 0 0 0 0 5.656.5.5 0 1 1-.708.708 5 5 0 0 1 0-7.072.5.5 0 0 1 .708.708zm5.656-.708a.5.5 0 0 1 .708 0 5 5 0 0 1 0 7.072.5.5 0 1 1-.708-.708 4 4 0 0 0 0-5.656.5.5 0 0 1 0-.708zm2.122-2.12a.5.5 0 0 1 .707 0 8 8 0 0 1 0 11.313.5.5 0 0 1-.707-.707 7 7 0 0 0 0-9.9.5.5 0 0 1 0-.707zM10 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"></path></svg></i> \
					<i role="button" data-bs-toggle="tooltip" data-bs-placement="top" title="Chat Settings" data-container="body" data-animation="true" onclick="showChatSettingsModal(\''+videoId+'\')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#cb0c9f" class="bi bi-broadcast" viewBox="0 0 16 16"><path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"/><path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"/></svg></i> \
					</div>';
				}
				
				html += '</div> \
					</div> \
				</td>';
				
				return html;
			}
			
			function setClipboard(value) {
				navigator.clipboard.writeText(value)
				.then(function() {
					// text copied to clipboard success
				},
				function() {
					// text copied to clipboard fail, so using native DOM API fallback
					
					let tempInput = document.createElement("input");
					tempInput.style = "position: absolute; left: -1000px; top: -1000px";
					tempInput.value = value;
					document.body.appendChild(tempInput);
					tempInput.select();
					document.execCommand("copy");
					document.body.removeChild(tempInput);
				});
			}
			
			function refreshHoverTooltips() {
				$(function () {
					$('[data-bs-toggle="tooltip"]').tooltip({
						trigger : 'hover'
					});

					$('[data-bs-toggle="tooltip"]').on('click', function () {
						$(this).tooltip('hide')
					});
				});
			}
			
			function refreshClickTooltips() {
				$(function () {
					$('.click-tooltip[data-bs-toggle="tooltip"]').tooltip({
						trigger: 'click'
					});
					
					$('.click-tooltip[data-bs-toggle="tooltip"]').on('click', function () {
						setTimeout(() => {
							$(this).tooltip('hide');
						}, 500);
					});
				});
			}
			
			function getCaptcha(captchaUrl) {
				return new Promise(function(resolve, reject) {
					fetch(captchaUrl)
					.then(async response => {
						const headers = response.headers;
						if (response.ok) {
							if(headers.get('content-type').includes('application/json')) {
								const data = await response.json();
								
								if(data.isError) {
									throw new Error(data.message);
								}
								else {
									throw new Error('...something went wrong...');
								}
							}
							else {
								return response.blob();
							}
						}
						throw new Error('...something went wrong...');
					})
					.then(blob => {
						const objectURL = URL.createObjectURL(blob);
						
						resolve(objectURL);
					})
					.catch(error => {
						reject(error.message);
					});
				});
			}
			
			function showAlert(isError, message) {
				if(isError) {
					Swal.fire({
						text: message,
						icon: 'warning',
						confirmButtonColor: '#3085d6',
						confirmButtonText: 'Ok'
					});
				}
				else {
					if(message === '') {
						Swal.fire({
							icon: 'success',
							showConfirmButton: false,
							timer: 1500
						});
					}
					else {
						Swal.fire({
							icon: 'success',
							html: message
						});
					}
				}
			}
			
			function showNotification(notificationMessage, type) {
				const element = $('\
					<div class="alert ' + type + ' alert-dismissible fade show" role="alert">\
						' + notificationMessage + '\
						<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">\
							<span aria-hidden="true">&times;</span>\
						</button>\
					</div>');
				
				$('#notifications-container').append(element);
				
				setTimeout(function() {
					$(element).remove();
				}, 4000);
			}
			
			function calculateBandwidthUsage_MB(bandwidth) {
				return ((bandwidth / 1048576).toFixed(2) + 'MB');
			}
			
			// deprecated
			function secondsToTimestamp(seconds) {
				const hours = Math.floor(seconds / 3600);
				const minutes = Math.floor((seconds - (hours * 3600)) / 60);
				const remainingSeconds = (seconds - (hours * 3600) - (minutes * 60)).toFixed(2);
				const parts = [hours.toString().padStart(2, "0"), minutes.toString().padStart(2, "0"), remainingSeconds.padStart(5, "0")];
				
				return parts.join(":");
			}
		</script>
	</body>
</html>